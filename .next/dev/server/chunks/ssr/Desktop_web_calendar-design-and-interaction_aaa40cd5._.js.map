{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/components/day-view.tsx"],"sourcesContent":["\"use client\"\n\nimport type { Task } from \"@/types/task\"\nimport { Check } from \"lucide-react\"\nimport { useMemo } from \"react\"\n\ninterface DayViewProps {\n  tasks: Task[]\n  selectedDate: Date\n  onTaskClick: (task: Task) => void\n}\n\n// 格式化日期为本地日期字符串（避免时区问题）\nfunction formatDateLocal(date: Date): string {\n  const year = date.getFullYear()\n  const month = String(date.getMonth() + 1).padStart(2, \"0\")\n  const day = String(date.getDate()).padStart(2, \"0\")\n  return `${year}-${month}-${day}`\n}\n\nexport function DayView({ tasks, selectedDate, onTaskClick }: DayViewProps) {\n  const hours = Array.from({ length: 24 }, (_, i) => i)\n\n  const selectedDateStr = formatDateLocal(selectedDate)\n  const todayTasks = tasks.filter((t) => t.date === selectedDateStr)\n\n  const stats = useMemo(() => {\n    const total = todayTasks.length\n    const completed = todayTasks.filter((t) => t.completed).length\n    const byCategory = todayTasks.reduce(\n      (acc, task) => {\n        const cat = task.categoryId || \"uncategorized\"\n        if (!acc[cat]) acc[cat] = { total: 0, completed: 0 }\n        acc[cat].total++\n        if (task.completed) acc[cat].completed++\n        return acc\n      },\n      {} as Record<string, { total: number; completed: number }>,\n    )\n\n    return { total, completed, byCategory }\n  }, [todayTasks])\n\n  const getTasksForHour = (hour: number) => {\n    const hourStr = hour.toString().padStart(2, \"0\")\n    return todayTasks.filter((task) => task.time.startsWith(hourStr))\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-950/20 dark:to-purple-950/20 rounded-2xl p-4 border-2 border-foreground/10\">\n        {stats.total > 0 ? (\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm font-bold text-foreground/80\">Today's Progress</span>\n              <span className=\"text-xl font-bold text-foreground\">\n                {stats.completed}/{stats.total}\n              </span>\n            </div>\n            {/* Visual progress bar with hand-drawn style */}\n            <div className=\"h-2 bg-foreground/10 rounded-full overflow-hidden\">\n              <div\n                className=\"h-full bg-gradient-to-r from-green-400 to-blue-500 rounded-full transition-all duration-500\"\n                style={{ width: `${(stats.completed / stats.total) * 100}%` }}\n              />\n            </div>\n            {/* Category breakdown */}\n            {Object.keys(stats.byCategory).length > 0 && (\n              <div className=\"flex gap-2 flex-wrap mt-3\">\n                {Object.entries(stats.byCategory).map(([cat, data]) => (\n                  <div key={cat} className=\"text-[10px] bg-background/60 rounded-full px-2 py-1 font-medium\">\n                    {cat}: {data.completed}/{data.total}\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        ) : (\n          <p className=\"text-center py-8 text-sm font-handwriting text-muted-foreground\">\n            No tasks today - enjoy your free time! ☀️\n          </p>\n        )}\n      </div>\n\n      {/* Timeline */}\n      {stats.total > 0 && (\n        <div className=\"space-y-0 bg-muted/10 rounded-2xl border border-border/40 overflow-hidden\">\n          {hours.map((hour) => {\n            const hourTasks = getTasksForHour(hour)\n            if (hourTasks.length === 0) return null\n\n            return (\n              <div key={hour} className=\"flex border-b border-border/30 last:border-0\">\n                <div className=\"w-16 flex-shrink-0 py-4 px-3 text-xs text-muted-foreground font-semibold\">\n                  {hour.toString().padStart(2, \"0\")}:00\n                </div>\n                <div className=\"flex-1 py-3 pr-3 space-y-2\">\n                  {hourTasks.map((task) => (\n                    <button\n                      key={task.id}\n                      onClick={() => onTaskClick(task)}\n                      className={`w-full text-left px-4 py-3 rounded-xl transition-all active:scale-[0.98] border ${\n                        task.completed\n                          ? \"text-muted-foreground bg-muted/20 border-transparent\"\n                          : \"text-foreground bg-background border-border/40 shadow-sm active:shadow\"\n                      }`}\n                    >\n                      <div className=\"flex items-center justify-between gap-3\">\n                        <span className=\"text-sm font-medium leading-relaxed\">{task.title}</span>\n                        {task.completed && <Check className=\"h-4 w-4 text-muted-foreground flex-shrink-0\" />}\n                      </div>\n                    </button>\n                  ))}\n                </div>\n              </div>\n            )\n          })}\n        </div>\n      )}\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 227, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/components/week-view.tsx"],"sourcesContent":["\"use client\"\n\nimport type { Task } from \"@/types/task\"\nimport { Check } from \"lucide-react\"\nimport { useMemo } from \"react\"\n\ninterface WeekViewProps {\n  tasks: Task[]\n  selectedDate: Date\n  onTaskClick: (task: Task) => void\n}\n\n// 格式化日期为本地日期字符串（避免时区问题）\nfunction formatDateLocal(date: Date): string {\n  const year = date.getFullYear()\n  const month = String(date.getMonth() + 1).padStart(2, \"0\")\n  const day = String(date.getDate()).padStart(2, \"0\")\n  return `${year}-${month}-${day}`\n}\n\nexport function WeekView({ tasks, selectedDate, onTaskClick }: WeekViewProps) {\n  const weekDays = useMemo(() => {\n    const days = []\n    const currentDay = new Date(selectedDate)\n    const dayOfWeek = currentDay.getDay()\n    const monday = new Date(currentDay)\n    monday.setDate(currentDay.getDate() - (dayOfWeek === 0 ? 6 : dayOfWeek - 1))\n\n    for (let i = 0; i < 7; i++) {\n      const day = new Date(monday)\n      day.setDate(monday.getDate() + i)\n      days.push(day)\n    }\n    return days\n  }, [selectedDate])\n\n  const stats = useMemo(() => {\n    const weekDates = weekDays.map((d) => formatDateLocal(d))\n    const weekTasks = tasks.filter((t) => weekDates.includes(t.date))\n    const total = weekTasks.length\n    const completed = weekTasks.filter((t) => t.completed).length\n    return { total, completed }\n  }, [tasks, weekDays])\n\n  const getTasksForDay = (date: Date) => {\n    const dateStr = formatDateLocal(date)\n    return tasks.filter((t) => t.date === dateStr)\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Stats */}\n      <div className=\"text-xs text-muted-foreground\">\n        {stats.total > 0 ? (\n          <p>\n            本周共有 {stats.total} 件待办，已完成 {stats.completed} 件\n          </p>\n        ) : (\n          <p className=\"text-center py-16 text-sm\">本周暂无待办，享受轻松时光吧~</p>\n        )}\n      </div>\n\n      {/* Week Grid - Horizontal scrollable cards */}\n      {stats.total > 0 && (\n        <div className=\"overflow-x-auto -mx-4 px-4 pb-2\">\n          <div className=\"flex gap-3 snap-x snap-mandatory\">\n            {weekDays.map((day) => {\n              const dayTasks = getTasksForDay(day)\n              const isToday = day.toDateString() === new Date().toDateString()\n\n              return (\n                <div\n                  key={day.toISOString()}\n                  className={`flex-shrink-0 w-[160px] snap-center rounded-2xl border transition-all ${\n                    isToday ? \"border-foreground/30 bg-muted/40 shadow-sm\" : \"border-border/40 bg-muted/10\"\n                  } p-4`}\n                >\n                  <div className=\"text-center mb-4\">\n                    <div className=\"text-xs text-muted-foreground font-medium\">\n                      {day.toLocaleDateString(\"zh-CN\", { weekday: \"short\" })}\n                    </div>\n                    <div className={`text-2xl font-bold mt-1 ${isToday ? \"text-foreground\" : \"text-foreground/80\"}`}>\n                      {day.getDate()}\n                    </div>\n                    {dayTasks.length > 0 && (\n                      <div className=\"text-[10px] text-muted-foreground mt-1\">\n                        {dayTasks.filter((t) => t.completed).length}/{dayTasks.length}\n                      </div>\n                    )}\n                  </div>\n                  <div className=\"space-y-2\">\n                    {dayTasks.length === 0 ? (\n                      <div className=\"text-center py-6 text-xs text-muted-foreground\">无任务</div>\n                    ) : (\n                      dayTasks.map((task) => (\n                        <button\n                          key={task.id}\n                          onClick={() => onTaskClick(task)}\n                          className={`w-full text-left px-3 py-2.5 rounded-xl text-xs transition-all active:scale-95 ${\n                            task.completed\n                              ? \"text-muted-foreground bg-muted/30\"\n                              : \"text-foreground bg-background shadow-sm border border-border/40\"\n                          }`}\n                        >\n                          <div className=\"flex items-start justify-between gap-2\">\n                            <div className=\"flex-1 min-w-0\">\n                              <div className=\"text-[10px] text-muted-foreground mb-1\">{task.time}</div>\n                              <div className=\"font-medium line-clamp-2 leading-relaxed\">{task.title}</div>\n                            </div>\n                            {task.completed && <Check className=\"h-3.5 w-3.5 text-muted-foreground flex-shrink-0\" />}\n                          </div>\n                        </button>\n                      ))\n                    )}\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 448, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/components/month-view.tsx"],"sourcesContent":["\"use client\"\n\nimport type { Task, TaskCategory, CalendarDayResponse } from \"@/types/task\"\nimport { useMemo, useState } from \"react\"\nimport { ChevronLeft, ChevronRight, ListTodo } from \"lucide-react\"\n\ninterface MonthViewProps {\n  tasks?: Task[] // 可选，用于兼容旧代码\n  monthData?: CalendarDayResponse[] // 后端返回的月视图数据\n  selectedDate: Date\n  onDateClick: (date: Date) => void\n  onMonthChange?: (date: Date) => void\n  categories?: TaskCategory[]\n}\n\n// 格式化日期为本地日期字符串（避免时区问题）\nfunction formatDateLocal(date: Date): string {\n  const year = date.getFullYear()\n  const month = String(date.getMonth() + 1).padStart(2, \"0\")\n  const day = String(date.getDate()).padStart(2, \"0\")\n  return `${year}-${month}-${day}`\n}\n\nexport function MonthView({ tasks = [], monthData, selectedDate, onDateClick, onMonthChange, categories = [] }: MonthViewProps) {\n  const [showIncompleteModal, setShowIncompleteModal] = useState(false)\n\n  // 创建日期到月视图数据的映射\n  const monthDataMap = useMemo(() => {\n    if (!monthData) return new Map<string, CalendarDayResponse>()\n    const map = new Map<string, CalendarDayResponse>()\n    monthData.forEach((day) => {\n      map.set(day.date, day)\n    })\n    return map\n  }, [monthData])\n\n  const { calendarDays, stats, incompleteTasks } = useMemo(() => {\n    const year = selectedDate.getFullYear()\n    const month = selectedDate.getMonth()\n\n    const firstDay = new Date(year, month, 1)\n    const lastDay = new Date(year, month + 1, 0)\n\n    const firstDayOfWeek = firstDay.getDay()\n    const startDate = new Date(firstDay)\n    startDate.setDate(1 - (firstDayOfWeek === 0 ? 6 : firstDayOfWeek - 1))\n\n    const days = []\n    const currentDate = new Date(startDate)\n\n    for (let i = 0; i < 42; i++) {\n      days.push(new Date(currentDate))\n      currentDate.setDate(currentDate.getDate() + 1)\n    }\n\n    // 如果有后端数据，使用后端数据；否则使用 tasks\n    let total = 0\n    let completed = 0\n    const incomplete: Task[] = []\n\n    if (monthData && monthData.length > 0) {\n      // 使用后端返回的数据\n      monthData.forEach((day) => {\n        total += day.totalCount\n        completed += day.completedCount\n        if (day.hasUnfinished) {\n          // 从 tasks 中找到未完成的任务\n          const dayTasks = tasks.filter((t) => t.date === day.date && !t.completed)\n          incomplete.push(...dayTasks)\n        }\n      })\n    } else {\n      // 使用 tasks 数据（兼容旧代码）\n      const monthDates = days.filter((d) => d.getMonth() === month).map((d) => formatDateLocal(d))\n      const monthTasks = tasks.filter((t) => monthDates.includes(t.date))\n      total = monthTasks.length\n      completed = monthTasks.filter((t) => t.completed).length\n      incomplete.push(...monthTasks.filter((t) => !t.completed))\n    }\n\n    return {\n      calendarDays: days,\n      stats: { total, completed },\n      incompleteTasks: incomplete,\n    }\n  }, [selectedDate, tasks, monthData])\n\n  const getTaskStatsForDay = (date: Date) => {\n    const dateStr = formatDateLocal(date)\n    \n    // 优先使用后端返回的数据\n    const dayData = monthDataMap.get(dateStr)\n    if (dayData) {\n      return {\n        total: dayData.totalCount,\n        completed: dayData.completedCount,\n        completionRate: dayData.completionRate,\n        completedTypeIcons: dayData.completedTypeIcons,\n        hasUnfinished: dayData.hasUnfinished,\n      }\n    }\n\n    // 如果没有后端数据，使用 tasks（兼容旧代码）\n    const dayTasks = tasks.filter((t) => t.date === dateStr)\n    const total = dayTasks.length\n    const completed = dayTasks.filter((t) => t.completed).length\n    const completedWithCategories = dayTasks.filter((t) => t.completed && t.categoryId)\n\n    return {\n      total,\n      completed,\n      completionRate: total > 0 ? completed / total : 0,\n      completedTypeIcons: completedWithCategories.map((t) => t.categoryIcon || \"\").filter(Boolean),\n      hasUnfinished: total > completed,\n    }\n  }\n\n  const getCompletionColor = (rate: number) => {\n    if (rate >= 1) return \"bg-green-100/80 border-green-200\"\n    if (rate >= 0.75) return \"bg-blue-100/80 border-blue-200\"\n    if (rate >= 0.5) return \"bg-yellow-100/80 border-yellow-200\"\n    if (rate >= 0.25) return \"bg-orange-100/80 border-orange-200\"\n    return \"\"\n  }\n\n  const getCategoryById = (id: string) => categories.find((c) => c.id === id)\n\n  const weekDays = [\"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\", \"Su\"]\n\n  const handlePreviousMonth = () => {\n    const newDate = new Date(selectedDate)\n    newDate.setMonth(newDate.getMonth() - 1)\n    onMonthChange?.(newDate)\n  }\n\n  const handleNextMonth = () => {\n    const newDate = new Date(selectedDate)\n    newDate.setMonth(newDate.getMonth() + 1)\n    onMonthChange?.(newDate)\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"text-center mb-6\">\n        <div className=\"flex items-center justify-center gap-4\">\n          <button\n            onClick={handlePreviousMonth}\n            className=\"p-2 hover:bg-muted/50 rounded-full transition-colors active:scale-95\"\n            aria-label=\"Previous month\"\n          >\n            <ChevronLeft className=\"h-6 w-6 text-foreground/70\" />\n          </button>\n\n          <div className=\"inline-block relative\">\n            <div className=\"text-5xl font-bold text-foreground/90 tracking-tight\">\n              {selectedDate.toLocaleDateString(\"en-US\", { month: \"short\" })}.\n            </div>\n            <div className=\"absolute -top-2 -right-12 text-2xl\">✨</div>\n          </div>\n\n          <button\n            onClick={handleNextMonth}\n            className=\"p-2 hover:bg-muted/50 rounded-full transition-colors active:scale-95\"\n            aria-label=\"Next month\"\n          >\n            <ChevronRight className=\"h-6 w-6 text-foreground/70\" />\n          </button>\n        </div>\n\n        <div className=\"text-sm text-muted-foreground font-handwriting mt-2\">{selectedDate.getFullYear()}</div>\n      </div>\n\n      {incompleteTasks.length > 0 && (\n        <button\n          onClick={() => setShowIncompleteModal(true)}\n          className=\"w-full py-3 px-4 bg-amber-50 border-2 border-amber-200 rounded-xl flex items-center justify-between active:scale-[0.98] transition-transform hover:bg-amber-100\"\n        >\n          <div className=\"flex items-center gap-2\">\n            <ListTodo className=\"h-5 w-5 text-amber-600\" />\n            <span className=\"text-sm font-medium text-amber-900\">待完成任务</span>\n          </div>\n          <span className=\"text-lg font-bold text-amber-600\">{incompleteTasks.length}</span>\n        </button>\n      )}\n\n      <div className=\"bg-background rounded-2xl border-2 border-foreground/20 overflow-hidden sketch-border\">\n        <div className=\"grid grid-cols-7 border-b-2 border-foreground/20 bg-muted/20\">\n          {weekDays.map((day) => (\n            <div key={day} className=\"text-center py-3 text-xs font-bold text-foreground/70 uppercase tracking-wider\">\n              {day}\n            </div>\n          ))}\n        </div>\n\n        <div className=\"grid grid-cols-7\" style={{ gridAutoRows: \"minmax(85px, 1fr)\" }}>\n          {calendarDays.map((day, index) => {\n            const isCurrentMonth = day.getMonth() === selectedDate.getMonth()\n            const isToday = day.toDateString() === new Date().toDateString()\n            const { total, completed, completionRate, completedTypeIcons, hasUnfinished } = getTaskStatsForDay(day)\n\n            return (\n              <button\n                key={index}\n                onClick={() => {\n                  // 创建新的 Date 对象，使用本地时间，避免时区问题\n                  const localDate = new Date(day.getFullYear(), day.getMonth(), day.getDate())\n                  onDateClick(localDate)\n                }}\n                disabled={!isCurrentMonth}\n                className={`relative w-full aspect-square min-h-[85px] border-r border-b border-foreground/15 p-2.5 transition-all active:scale-95 disabled:active:scale-100 overflow-hidden ${\n                  !isCurrentMonth ? \"text-muted-foreground/30 bg-muted/5\" : \"hover:bg-muted/30\"\n                } ${isToday ? \"bg-yellow-50 border-yellow-300 border-2\" : \"\"} ${\n                  total > 0 && isCurrentMonth ? getCompletionColor(completionRate) : \"\"\n                }`}\n              >\n                <div className=\"flex flex-col items-start justify-start h-full w-full gap-1\">\n                  <div className={`text-sm font-bold leading-none ${isToday ? \"text-foreground\" : \"text-foreground/80\"}`}>\n                    {day.getDate()}\n                  </div>\n\n                  {isCurrentMonth && completedTypeIcons && completedTypeIcons.length > 0 && (() => {\n                    const iconCount = completedTypeIcons.length\n                    // 根据图标数量动态调整图标大小和显示数量，尽可能并排显示更多图标\n                    let iconSize = \"w-5 h-5\"\n                    let textSize = \"text-[10px]\"\n                    let gapSize = \"gap-1\"\n                    let maxIcons = iconCount // 默认显示所有图标\n                    \n                    // 如果图标太多，缩小尺寸以容纳更多\n                    if (iconCount > 12) {\n                      iconSize = \"w-3 h-3\"\n                      textSize = \"text-[7px]\"\n                      gapSize = \"gap-0.5\"\n                      maxIcons = Math.min(iconCount, 16) // 最多显示16个\n                    } else if (iconCount > 9) {\n                      iconSize = \"w-3.5 h-3.5\"\n                      textSize = \"text-[8px]\"\n                      gapSize = \"gap-0.5\"\n                      maxIcons = iconCount\n                    } else if (iconCount > 6) {\n                      iconSize = \"w-4 h-4\"\n                      textSize = \"text-[9px]\"\n                      gapSize = \"gap-0.5\"\n                      maxIcons = iconCount\n                    } else if (iconCount > 4) {\n                      iconSize = \"w-4.5 h-4.5\"\n                      textSize = \"text-[9px]\"\n                      gapSize = \"gap-0.5\"\n                      maxIcons = iconCount\n                    }\n                    \n                    const displayIcons = completedTypeIcons.slice(0, maxIcons)\n                    const remainingCount = iconCount - maxIcons\n                    \n                    return (\n                      <div className={`flex flex-wrap ${gapSize} mt-0.5 w-full max-w-full px-0.5`}>\n                        {displayIcons.map((icon, idx) => (\n                          <div\n                            key={idx}\n                            className={`${iconSize} rounded-full bg-white border border-foreground/20 flex items-center justify-center ${textSize} shadow-sm flex-shrink-0`}\n                            title=\"已完成\"\n                          >\n                            {icon}\n                          </div>\n                        ))}\n                        {remainingCount > 0 && (\n                          <div className={`${iconSize} rounded-full bg-white border border-foreground/20 flex items-center justify-center text-[7px] font-bold text-foreground/60 flex-shrink-0`}>\n                            +{remainingCount}\n                          </div>\n                        )}\n                      </div>\n                    )\n                  })()}\n\n                  {total > 0 && isCurrentMonth && hasUnfinished && (\n                    <div className=\"flex items-center gap-1 mt-auto w-full px-0.5\">\n                      <div className=\"w-4 h-4 rounded-full border-2 border-foreground/40 flex items-center justify-center text-[8px] font-bold flex-shrink-0\">\n                        {total - completed}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </button>\n            )\n          })}\n        </div>\n      </div>\n\n      <div className=\"text-center text-sm text-muted-foreground font-handwriting\">\n        {stats.total > 0 ? (\n          <p>\n            {stats.completed} of {stats.total} tasks completed this month\n          </p>\n        ) : (\n          <p>No tasks this month, time to plan ahead!</p>\n        )}\n      </div>\n\n      {showIncompleteModal && (\n        <div className=\"fixed inset-0 z-50 bg-black/50 flex items-end\" onClick={() => setShowIncompleteModal(false)}>\n          <div\n            className=\"w-full bg-background rounded-t-3xl max-h-[70vh] overflow-y-auto pb-safe\"\n            onClick={(e) => e.stopPropagation()}\n          >\n            <div className=\"sticky top-0 bg-background border-b border-border px-6 py-4\">\n              <div className=\"w-12 h-1 bg-muted-foreground/30 rounded-full mx-auto mb-4\" />\n              <h3 className=\"text-lg font-bold\">待完成任务 ({incompleteTasks.length})</h3>\n            </div>\n            <div className=\"px-6 py-4 space-y-3\">\n              {incompleteTasks.map((task) => {\n                const category = task.categoryId ? getCategoryById(task.categoryId) : null\n                return (\n                  <div\n                    key={task.id}\n                    className=\"p-4 bg-muted/30 rounded-xl border border-border flex items-center justify-between\"\n                  >\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-2 mb-1\">\n                        {category && <span className=\"text-lg\">{category.icon}</span>}\n                        <span className=\"font-medium text-foreground\">{task.title}</span>\n                      </div>\n                      <div className=\"text-xs text-muted-foreground\">\n                        {new Date(task.date).toLocaleDateString(\"zh-CN\")} {task.time}\n                      </div>\n                    </div>\n                  </div>\n                )\n              })}\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1008, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/components/task-detail-sheet.tsx"],"sourcesContent":["\"use client\"\n\nimport type { Task } from \"@/types/task\"\nimport { Check, X, Download, FileImage } from \"lucide-react\"\nimport { useEffect } from \"react\"\n\ninterface TaskDetailSheetProps {\n  task: Task | null\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  onComplete: (taskId: string) => void\n}\n\nexport function TaskDetailSheet({ task, open, onOpenChange, onComplete }: TaskDetailSheetProps) {\n  useEffect(() => {\n    if (open && task) {\n      document.body.style.overflow = \"hidden\"\n    } else {\n      document.body.style.overflow = \"unset\"\n    }\n    return () => {\n      document.body.style.overflow = \"unset\"\n    }\n  }, [open, task])\n\n  useEffect(() => {\n    if (!open || !task) return\n\n    const handleComplete = () => {\n      const event = new CustomEvent(\"show-toast\", {\n        detail: { message: `太棒了！已完成「${task.title}」`, type: \"success\" },\n      })\n      window.dispatchEvent(event)\n    }\n\n    window.addEventListener(\"task-completed\", handleComplete)\n    return () => window.removeEventListener(\"task-completed\", handleComplete)\n  }, [open, task])\n\n  if (!open || !task) return null\n\n  const handleComplete = () => {\n    onComplete(task.id)\n    window.dispatchEvent(new Event(\"task-completed\"))\n  }\n\n  const handleImageDownload = (imageUrl: string, index: number) => {\n    const link = document.createElement(\"a\")\n    link.href = imageUrl\n    link.download = `attachment-${index + 1}.png`\n    link.click()\n  }\n\n  return (\n    <>\n      {/* Backdrop */}\n      <div\n        className=\"fixed inset-0 bg-black/40 backdrop-blur-sm z-40 animate-in fade-in duration-200\"\n        onClick={() => onOpenChange(false)}\n      />\n\n      {/* Sheet */}\n      <div className=\"fixed bottom-0 left-0 right-0 z-50 animate-slide-up\">\n        <div className=\"bg-background rounded-t-3xl border-t border-x border-border/40 shadow-2xl max-w-lg mx-auto pb-safe max-h-[85vh] overflow-y-auto\">\n          {/* Handle */}\n          <div className=\"flex justify-center pt-3 pb-2\">\n            <div className=\"w-12 h-1 rounded-full bg-muted-foreground/30\" />\n          </div>\n\n          {/* Content */}\n          <div className=\"px-5 pt-2 pb-5\">\n            <div className=\"flex items-start justify-between mb-6\">\n              <div className=\"flex items-start gap-3 flex-1 pr-4\">\n                {task.categoryIcon && <span className=\"text-2xl\">{task.categoryIcon}</span>}\n                <div>\n                  <h2 className=\"text-lg font-semibold text-foreground leading-relaxed\">{task.title}</h2>\n                  {task.category && <p className=\"text-xs text-muted-foreground mt-1\">{task.category}</p>}\n                </div>\n              </div>\n              <button\n                onClick={() => onOpenChange(false)}\n                className=\"w-8 h-8 rounded-full bg-muted/50 flex items-center justify-center active:scale-95 transition-transform flex-shrink-0\"\n              >\n                <X className=\"h-4 w-4\" />\n              </button>\n            </div>\n\n            <div className=\"space-y-4 mb-6\">\n              <div className=\"flex items-center justify-between py-3 border-b border-border/40\">\n                <div className=\"text-sm text-muted-foreground font-medium\">时间</div>\n                <div className=\"text-sm font-semibold\">{task.time}</div>\n              </div>\n\n              {task.repeatConfig?.enabled && (\n                <div className=\"flex items-center justify-between py-3 border-b border-border/40\">\n                  <div className=\"text-sm text-muted-foreground font-medium\">重复</div>\n                  <div className=\"text-sm font-semibold\">\n                    {task.repeatConfig.frequency === \"daily\"\n                      ? \"每天\"\n                      : task.repeatConfig.frequency === \"weekly\"\n                        ? \"每周\"\n                        : \"每月\"}\n                  </div>\n                </div>\n              )}\n\n              <div className=\"flex items-center justify-between py-3 border-b border-border/40\">\n                <div className=\"text-sm text-muted-foreground font-medium\">状态</div>\n                <div className={`text-sm font-semibold ${task.completed ? \"text-muted-foreground\" : \"\"}`}>\n                  {task.completed ? \"已完成\" : \"待完成\"}\n                </div>\n              </div>\n\n              {task.images && task.images.length > 0 && (\n                <div className=\"pt-3\">\n                  <div className=\"text-sm text-muted-foreground font-medium mb-3\">附件</div>\n                  <div className=\"grid grid-cols-3 gap-3\">\n                    {task.images.map((img, idx) => (\n                      <div key={idx} className=\"relative group\">\n                        <div className=\"aspect-square rounded-lg overflow-hidden border border-border/40 bg-muted/20\">\n                          <img\n                            src={img || \"/placeholder.svg\"}\n                            alt={`附件 ${idx + 1}`}\n                            className=\"w-full h-full object-cover\"\n                          />\n                        </div>\n                        <div className=\"absolute inset-0 bg-black/60 opacity-0 group-active:opacity-100 transition-opacity rounded-lg flex items-center justify-center gap-2\">\n                          <button\n                            onClick={() => handleImageDownload(img, idx)}\n                            className=\"w-8 h-8 rounded-full bg-white/90 flex items-center justify-center active:scale-95 transition-transform\"\n                          >\n                            <Download className=\"h-4 w-4 text-black\" />\n                          </button>\n                        </div>\n                        <div className=\"mt-1 text-xs text-center text-muted-foreground truncate\">\n                          <FileImage className=\"h-3 w-3 inline mr-1\" />\n                          图片 {idx + 1}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {/* Action Button */}\n            {!task.completed && (\n              <button\n                onClick={handleComplete}\n                className=\"w-full flex items-center justify-center gap-2 py-3.5 px-4 bg-foreground text-background rounded-xl font-semibold active:scale-[0.98] transition-transform shadow-sm\"\n              >\n                <Check className=\"h-5 w-5\" />\n                标记完成\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n    </>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1376, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/components/add-task-sheet.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\nimport { useState, useRef, useEffect } from \"react\"\nimport { X, Mic, ImageIcon, BookTemplate as Template, Plus, Repeat, ChevronRight, ChevronDown } from \"lucide-react\"\nimport type { Task, TaskTemplate, TaskCategory, RepeatConfig } from \"@/types/task\"\n\n// 格式化本地日期为 YYYY-MM-DD 格式（不使用UTC）\nfunction formatLocalDate(date: Date): string {\n  const year = date.getFullYear()\n  const month = String(date.getMonth() + 1).padStart(2, '0')\n  const day = String(date.getDate()).padStart(2, '0')\n  return `${year}-${month}-${day}`\n}\n\ninterface AddTaskSheetProps {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  onAdd: (task: Omit<Task, \"id\">) => void\n  selectedDate: Date\n  currentView: \"day\" | \"week\" | \"month\"\n  templates: TaskTemplate[]\n  categories: TaskCategory[]\n  onManageTemplates: () => void\n  onManageCategories: () => void\n}\n\nexport function AddTaskSheet({\n  open,\n  onOpenChange,\n  onAdd,\n  selectedDate,\n  currentView,\n  templates,\n  categories,\n  onManageTemplates,\n  onManageCategories,\n}: AddTaskSheetProps) {\n  // 获取应该使用的日期：周视图时使用今天，其他视图使用 selectedDate\n  const getInitialDate = () => {\n    if (currentView === \"week\") {\n      return new Date()\n    }\n    return selectedDate\n  }\n\n  const initialDate = getInitialDate()\n  const [mode, setMode] = useState<\"single\" | \"template\">(\"single\")\n  const [title, setTitle] = useState(\"\")\n  const [time, setTime] = useState(\"09:00\")\n  const [date, setDate] = useState(formatLocalDate(initialDate))\n  const [images, setImages] = useState<string[]>([])\n  const [isRecording, setIsRecording] = useState(false)\n  const [selectedCategory, setSelectedCategory] = useState<string>(\"\")\n  const [showRepeatConfig, setShowRepeatConfig] = useState(false)\n  const [repeatConfig, setRepeatConfig] = useState<RepeatConfig>({\n    enabled: false,\n    frequency: \"daily\",\n    interval: 1,\n  })\n  const [selectedTemplate, setSelectedTemplate] = useState<string | null>(null)\n  const [expandedTemplate, setExpandedTemplate] = useState<string | null>(null)\n  const [templateTime, setTemplateTime] = useState(\"09:00\")\n  const [templateDate, setTemplateDate] = useState(formatLocalDate(initialDate))\n\n  // 当打开表单或视图/日期变化时，更新日期状态\n  // 周视图时始终使用今天，其他视图使用 selectedDate\n  useEffect(() => {\n    if (open) {\n      const targetDate = currentView === \"week\" ? new Date() : selectedDate\n      setDate(formatLocalDate(targetDate))\n      setTemplateDate(formatLocalDate(targetDate))\n    }\n  }, [open, currentView, selectedDate])\n  const [editingTasks, setEditingTasks] = useState<\n    { title: string; time: string; category?: string; categoryIcon?: string; categoryId?: string }[]\n  >([])\n\n  const fileInputRef = useRef<HTMLInputElement>(null)\n\n  const handleVoiceInput = () => {\n    if (!isRecording) {\n      setIsRecording(true)\n      // Simulated voice recognition - in production, use Web Speech API\n      setTimeout(() => {\n        setTitle(\"语音输入的任务示例\")\n        setIsRecording(false)\n      }, 2000)\n    }\n  }\n\n  const handleImageUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = e.target.files\n    if (!files) return\n\n    Array.from(files).forEach((file) => {\n      const reader = new FileReader()\n      reader.onloadend = () => {\n        setImages((prev) => [...prev, reader.result as string])\n      }\n      reader.readAsDataURL(file)\n    })\n  }\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault()\n    if (!title.trim()) return\n\n    const category = categories.find((c) => c.id === selectedCategory)\n    onAdd({\n      title: title.trim(),\n      time,\n      completed: false,\n      date,\n      images: images.length > 0 ? images : undefined,\n      category: category?.name,\n      categoryIcon: category?.icon,\n      categoryId: selectedCategory || undefined,\n      repeatConfig: repeatConfig.enabled ? repeatConfig : undefined,\n    })\n\n    // Reset form\n    setTitle(\"\")\n    setTime(\"09:00\")\n    setImages([])\n    setSelectedCategory(\"\")\n    setRepeatConfig({ enabled: false, frequency: \"daily\", interval: 1 })\n    const targetDate = currentView === \"week\" ? new Date() : selectedDate\n    setDate(formatLocalDate(targetDate))\n  }\n\n  const handleTemplateExpand = (template: TaskTemplate) => {\n    if (expandedTemplate === template.id) {\n      setExpandedTemplate(null)\n      setSelectedTemplate(null)\n      setEditingTasks([])\n    } else {\n      setExpandedTemplate(template.id)\n      setSelectedTemplate(template.id)\n      setEditingTasks(\n        template.tasks.map((t) => ({ \n          ...t, \n          category: t.category, \n          categoryIcon: t.categoryIcon,\n          categoryId: t.categoryId,\n        })),\n      )\n    }\n  }\n\n  const handleTemplateSubmit = () => {\n    if (!selectedTemplate) return\n\n    // 确定使用的日期：日视图使用 date，周视图使用今天，其他视图使用 templateDate\n    const targetDate = currentView === \"day\" ? date : currentView === \"week\" ? formatLocalDate(new Date()) : templateDate\n\n    editingTasks.forEach((task) => {\n      onAdd({\n        title: task.title,\n        time: currentView === \"day\" ? task.time : templateTime,\n        completed: false,\n        date: targetDate,\n        images: undefined,\n        category: task.category,\n        categoryIcon: task.categoryIcon,\n        categoryId: task.categoryId,\n      })\n    })\n\n    onOpenChange(false)\n    setExpandedTemplate(null)\n    setSelectedTemplate(null)\n    setEditingTasks([])\n  }\n\n  if (!open) return null\n\n  return (\n    <>\n      <div className=\"fixed inset-0 z-40 bg-black/40 backdrop-blur-sm\" onClick={() => onOpenChange(false)} />\n\n      <div className=\"fixed inset-x-0 bottom-0 z-50 bg-background rounded-t-3xl shadow-2xl animate-slide-up pb-safe max-h-[85vh] overflow-y-auto\">\n        <div className=\"px-5 py-4 border-b border-border/40 sticky top-0 bg-background z-10\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-lg font-semibold\">添加待办</h2>\n            <button\n              onClick={() => onOpenChange(false)}\n              className=\"w-8 h-8 rounded-full bg-muted/50 flex items-center justify-center active:scale-95 transition-transform\"\n            >\n              <X className=\"h-4 w-4\" />\n            </button>\n          </div>\n\n          <div className=\"flex gap-2 mt-3\">\n            <button\n              type=\"button\"\n              onClick={() => setMode(\"single\")}\n              className={`flex-1 py-2 rounded-lg text-sm font-medium transition-all active:scale-95 flex items-center justify-center gap-1.5 ${\n                mode === \"single\" ? \"bg-foreground text-background\" : \"bg-muted/40 text-muted-foreground\"\n              }`}\n            >\n              <Plus className=\"h-4 w-4\" />\n              单个任务\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setMode(\"template\")}\n              className={`flex-1 py-2 rounded-lg text-sm font-medium transition-all active:scale-95 flex items-center justify-center gap-1.5 ${\n                mode === \"template\" ? \"bg-foreground text-background\" : \"bg-muted/40 text-muted-foreground\"\n              }`}\n            >\n              <Template className=\"h-4 w-4\" />\n              从模板\n            </button>\n          </div>\n        </div>\n\n        {mode === \"single\" ? (\n          <form onSubmit={handleSubmit} className=\"px-5 py-5 space-y-5\">\n            <div>\n              <label className=\"block text-sm font-medium mb-2\">任务名称</label>\n              <div className=\"relative\">\n                <input\n                  type=\"text\"\n                  value={title}\n                  onChange={(e) => setTitle(e.target.value)}\n                  placeholder=\"输入任务名称\"\n                  className=\"w-full px-4 py-3 pr-12 rounded-xl border border-border/40 bg-background text-sm focus:outline-none focus:ring-2 focus:ring-foreground/20\"\n                  autoFocus\n                />\n                <button\n                  type=\"button\"\n                  onClick={handleVoiceInput}\n                  className={`absolute right-2 top-1/2 -translate-y-1/2 w-8 h-8 rounded-lg flex items-center justify-center transition-all active:scale-95 ${\n                    isRecording ? \"bg-red-500 text-white\" : \"bg-muted/50\"\n                  }`}\n                >\n                  <Mic className=\"h-4 w-4\" />\n                </button>\n              </div>\n            </div>\n\n            <div>\n              <div className=\"flex items-center justify-between mb-2\">\n                <label className=\"block text-sm font-medium\">任务分类</label>\n                <button\n                  type=\"button\"\n                  onClick={onManageCategories}\n                  className=\"text-xs text-muted-foreground hover:text-foreground\"\n                >\n                  管理分类\n                </button>\n              </div>\n              <div className=\"flex gap-2 flex-wrap\">\n                {categories.map((category) => (\n                  <button\n                    key={category.id}\n                    type=\"button\"\n                    onClick={() => setSelectedCategory(category.id)}\n                    className={`px-3 py-2 rounded-lg text-sm flex items-center gap-1.5 transition-all active:scale-95 ${\n                      selectedCategory === category.id ? \"bg-foreground text-background\" : \"bg-muted/40 text-foreground\"\n                    }`}\n                  >\n                    <span className=\"text-base\">{category.icon}</span>\n                    <span>{category.name}</span>\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {currentView !== \"day\" && (\n              <div>\n                <label className=\"block text-sm font-medium mb-2\">日期</label>\n                <input\n                  type=\"date\"\n                  value={date}\n                  onChange={(e) => setDate(e.target.value)}\n                  className=\"w-full px-4 py-3 rounded-xl border border-border/40 bg-background text-sm focus:outline-none focus:ring-2 focus:ring-foreground/20\"\n                />\n              </div>\n            )}\n\n            <div>\n              <label className=\"block text-sm font-medium mb-2\">时间</label>\n              <input\n                type=\"time\"\n                value={time}\n                onChange={(e) => setTime(e.target.value)}\n                className=\"w-full px-4 py-3 rounded-xl border border-border/40 bg-background text-sm focus:outline-none focus:ring-2 focus:ring-foreground/20\"\n              />\n            </div>\n\n            <div>\n              <button\n                type=\"button\"\n                onClick={() => setShowRepeatConfig(!showRepeatConfig)}\n                className=\"w-full flex items-center justify-between px-4 py-3 rounded-xl border border-border/40 bg-background text-sm active:scale-[0.98] transition-transform\"\n              >\n                <div className=\"flex items-center gap-2\">\n                  <Repeat className=\"h-4 w-4\" />\n                  <span>{repeatConfig.enabled ? \"重复已启用\" : \"设置重复\"}</span>\n                </div>\n                <ChevronRight className={`h-4 w-4 transition-transform ${showRepeatConfig ? \"rotate-90\" : \"\"}`} />\n              </button>\n\n              {showRepeatConfig && (\n                <div className=\"mt-3 space-y-3 p-4 rounded-xl bg-muted/20 border border-border/40\">\n                  <label className=\"flex items-center gap-2\">\n                    <input\n                      type=\"checkbox\"\n                      checked={repeatConfig.enabled}\n                      onChange={(e) => setRepeatConfig({ ...repeatConfig, enabled: e.target.checked })}\n                      className=\"w-4 h-4 rounded\"\n                    />\n                    <span className=\"text-sm\">启用重复</span>\n                  </label>\n\n                  {repeatConfig.enabled && (\n                    <>\n                      <div>\n                        <label className=\"block text-xs font-medium mb-1.5\">重复频率</label>\n                        <select\n                          value={repeatConfig.frequency}\n                          onChange={(e) => {\n                            const newFrequency = e.target.value as \"daily\" | \"weekly\" | \"monthly\"\n                            setRepeatConfig({\n                              ...repeatConfig,\n                              frequency: newFrequency,\n                              interval: newFrequency === \"daily\" ? 1 : repeatConfig.interval,\n                              daysOfWeek: newFrequency === \"weekly\" ? [] : undefined,\n                              dayOfMonth: newFrequency === \"monthly\" ? undefined : undefined,\n                            })\n                          }}\n                          className=\"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm\"\n                        >\n                          <option value=\"daily\">每天</option>\n                          <option value=\"weekly\">每周</option>\n                          <option value=\"monthly\">每月</option>\n                        </select>\n                      </div>\n\n                      {repeatConfig.frequency !== \"daily\" && (\n                        <div>\n                          <label className=\"block text-xs font-medium mb-1.5\">\n                            间隔（每 {repeatConfig.frequency === \"weekly\" ? \"几周\" : \"几月\"}）\n                          </label>\n                          <input\n                            type=\"number\"\n                            min=\"1\"\n                            value={repeatConfig.interval}\n                            onChange={(e) => setRepeatConfig({ ...repeatConfig, interval: Number(e.target.value) })}\n                            className=\"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm\"\n                          />\n                        </div>\n                      )}\n\n                      {repeatConfig.frequency === \"weekly\" && (\n                        <div>\n                          <label className=\"block text-xs font-medium mb-1.5\">选择重复日期</label>\n                          <div className=\"grid grid-cols-7 gap-1\">\n                            {[\"日\", \"一\", \"二\", \"三\", \"四\", \"五\", \"六\"].map((day, idx) => {\n                              const isSelected = repeatConfig.daysOfWeek?.includes(idx) || false\n                              return (\n                                <button\n                                  key={idx}\n                                  type=\"button\"\n                                  onClick={() => {\n                                    const current = repeatConfig.daysOfWeek || []\n                                    const newDays = isSelected\n                                      ? current.filter((d) => d !== idx)\n                                      : [...current, idx].sort()\n                                    setRepeatConfig({ ...repeatConfig, daysOfWeek: newDays })\n                                  }}\n                                  className={`py-2 rounded-lg text-xs font-medium transition-all active:scale-95 ${\n                                    isSelected ? \"bg-foreground text-background\" : \"bg-muted/40 text-muted-foreground\"\n                                  }`}\n                                >\n                                  {day}\n                                </button>\n                              )\n                            })}\n                          </div>\n                        </div>\n                      )}\n\n                      {repeatConfig.frequency === \"monthly\" && (\n                        <div>\n                          <label className=\"block text-xs font-medium mb-1.5\">选择每月的哪一天</label>\n                          <input\n                            type=\"number\"\n                            min=\"1\"\n                            max=\"31\"\n                            value={repeatConfig.dayOfMonth || \"\"}\n                            onChange={(e) =>\n                              setRepeatConfig({\n                                ...repeatConfig,\n                                dayOfMonth: e.target.value ? Number(e.target.value) : undefined,\n                              })\n                            }\n                            placeholder=\"例如: 15 (每月15号)\"\n                            className=\"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm\"\n                          />\n                        </div>\n                      )}\n\n                      <div>\n                        <label className=\"block text-xs font-medium mb-1.5\">重复次数（可选）</label>\n                        <input\n                          type=\"number\"\n                          min=\"1\"\n                          value={repeatConfig.count || \"\"}\n                          onChange={(e) =>\n                            setRepeatConfig({\n                              ...repeatConfig,\n                              count: e.target.value ? Number(e.target.value) : undefined,\n                            })\n                          }\n                          placeholder=\"不限制\"\n                          className=\"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm\"\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-xs font-medium mb-1.5\">结束日期（可选）</label>\n                        <input\n                          type=\"date\"\n                          value={repeatConfig.endDate || \"\"}\n                          onChange={(e) => setRepeatConfig({ ...repeatConfig, endDate: e.target.value })}\n                          className=\"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm\"\n                        />\n                      </div>\n                    </>\n                  )}\n                </div>\n              )}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium mb-2\">图片附件</label>\n              <input\n                ref={fileInputRef}\n                type=\"file\"\n                accept=\"image/*\"\n                multiple\n                onChange={handleImageUpload}\n                className=\"hidden\"\n              />\n              <button\n                type=\"button\"\n                onClick={() => fileInputRef.current?.click()}\n                className=\"w-full py-3 rounded-xl border border-dashed border-border/40 bg-muted/20 text-sm text-muted-foreground flex items-center justify-center gap-2 active:scale-[0.98] transition-transform\"\n              >\n                <ImageIcon className=\"h-4 w-4\" />\n                添加图片\n              </button>\n              {images.length > 0 && (\n                <div className=\"flex gap-2 mt-3 flex-wrap\">\n                  {images.map((img, idx) => (\n                    <div key={idx} className=\"relative w-20 h-20 rounded-lg overflow-hidden border border-border/40\">\n                      <img src={img || \"/placeholder.svg\"} alt=\"\" className=\"w-full h-full object-cover\" />\n                      <button\n                        type=\"button\"\n                        onClick={() => setImages((prev) => prev.filter((_, i) => i !== idx))}\n                        className=\"absolute top-1 right-1 w-5 h-5 rounded-full bg-black/60 text-white flex items-center justify-center\"\n                      >\n                        <X className=\"h-3 w-3\" />\n                      </button>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={!title.trim()}\n              className=\"w-full py-3.5 rounded-xl bg-foreground text-background font-medium active:scale-[0.98] transition-transform disabled:opacity-40 disabled:active:scale-100\"\n            >\n              添加\n            </button>\n          </form>\n        ) : (\n          <div className=\"px-5 py-5 space-y-4\">\n            <div className=\"space-y-3\">\n              {templates.map((template) => (\n                <div key={template.id} className=\"rounded-xl border border-border/40 bg-muted/20 overflow-hidden\">\n                  <button\n                    onClick={() => handleTemplateExpand(template)}\n                    className=\"w-full p-4 flex items-center gap-3 active:bg-muted/30 transition-all text-left\"\n                  >\n                    {expandedTemplate === template.id ? (\n                      <ChevronDown className=\"h-4 w-4 text-muted-foreground flex-shrink-0\" />\n                    ) : (\n                      <ChevronRight className=\"h-4 w-4 text-muted-foreground flex-shrink-0\" />\n                    )}\n                    <div className=\"text-2xl\">{template.icon}</div>\n                    <div className=\"flex-1\">\n                      <div className=\"font-medium text-sm\">{template.name}</div>\n                      <div className=\"text-xs text-muted-foreground mt-0.5\">{template.tasks.length} 项任务</div>\n                    </div>\n                  </button>\n\n                  {expandedTemplate === template.id && (\n                    <div className=\"px-4 pb-4 space-y-3\">\n                      <div className=\"space-y-2 max-h-48 overflow-y-auto\">\n                        {editingTasks.map((task, idx) => (\n                          <div key={idx} className=\"flex items-start gap-2 text-sm bg-background/50 rounded-lg p-2.5\">\n                            <div className=\"w-5 h-5 rounded-full bg-muted/50 flex items-center justify-center text-xs text-muted-foreground flex-shrink-0 mt-0.5\">\n                              {idx + 1}\n                            </div>\n                            <div className=\"flex-1\">\n                              <input\n                                type=\"text\"\n                                value={task.title}\n                                onChange={(e) => {\n                                  const newTasks = [...editingTasks]\n                                  newTasks[idx].title = e.target.value\n                                  setEditingTasks(newTasks)\n                                }}\n                                className=\"w-full bg-transparent border-none outline-none font-medium text-sm\"\n                              />\n                              {task.category && (\n                                <div className=\"text-xs text-muted-foreground mt-1 flex items-center gap-1\">\n                                  {task.categoryIcon && <span>{task.categoryIcon}</span>}\n                                  <span>{task.category}</span>\n                                </div>\n                              )}\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n\n                      <div className=\"pt-3 border-t border-border/30 space-y-3\">\n                        <div className=\"text-xs font-medium text-muted-foreground\">为所有任务设置时间</div>\n\n                        {currentView !== \"day\" && (\n                          <div>\n                            <label className=\"block text-xs font-medium mb-1.5\">日期</label>\n                            <input\n                              type=\"date\"\n                              value={templateDate}\n                              onChange={(e) => setTemplateDate(e.target.value)}\n                              className=\"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm\"\n                            />\n                          </div>\n                        )}\n\n                        <div>\n                          <label className=\"block text-xs font-medium mb-1.5\">时间</label>\n                          <input\n                            type=\"time\"\n                            value={templateTime}\n                            onChange={(e) => setTemplateTime(e.target.value)}\n                            className=\"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm\"\n                          />\n                        </div>\n\n                        <button\n                          onClick={handleTemplateSubmit}\n                          className=\"w-full py-2.5 rounded-lg bg-foreground text-background text-sm font-medium active:scale-95 transition-transform\"\n                        >\n                          添加 {editingTasks.length} 个任务\n                        </button>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              ))}\n            </div>\n\n            <button\n              onClick={onManageTemplates}\n              className=\"w-full py-3 rounded-xl border border-dashed border-border/40 bg-muted/20 text-sm font-medium text-muted-foreground active:scale-[0.98] transition-transform\"\n            >\n              管理模板\n            </button>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2514, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/lib/data-transform.ts"],"sourcesContent":["import type {\n  Task,\n  TodoResponse,\n  TodoCreateRequest,\n  RepeatConfig,\n  RepeatRule,\n  TaskCategory,\n  TodoTypeResponse,\n  TaskTemplate,\n  TemplateResponse,\n} from \"@/types/task\"\n\n/**\n * 将后端返回的 TodoResponse 转换为前端使用的 Task\n */\nexport function transformTodoResponse(todo: TodoResponse): Task {\n  return {\n    id: todo.id,\n    title: todo.title,\n    time: todo.time || \"00:00\",\n    completed: todo.status === \"completed\",\n    date: todo.date,\n    description: todo.description,\n    category: todo.typeName,\n    categoryIcon: todo.typeIcon,\n    categoryId: todo.typeId,\n    repeatType: todo.repeatType,\n    repeatRule: todo.repeatRule,\n    attachments: todo.attachments,\n    source: todo.source,\n    templateId: todo.templateId,\n    createdAt: todo.createdAt,\n    completedAt: todo.completedAt,\n    updatedAt: todo.updatedAt,\n    // 兼容旧代码：将 attachments 转换为 images\n    images: todo.attachments\n      ?.filter((att) => att.type === \"image\")\n      .map((att) => att.previewUrl || att.url),\n  }\n}\n\n/**\n * 将前端 Task 转换为后端 TodoCreateRequest\n */\nexport function transformTaskToRequest(task: Omit<Task, \"id\">): TodoCreateRequest {\n  const request: TodoCreateRequest = {\n    title: task.title,\n    description: task.description,\n    date: task.date,\n    time: task.time || undefined,\n    typeId: task.categoryId,\n  }\n\n  // 处理重复配置\n  if (task.repeatConfig?.enabled) {\n    request.repeatType = task.repeatConfig.frequency\n\n    // 转换重复规则\n    if (task.repeatConfig.frequency === \"weekly\" && task.repeatConfig.daysOfWeek) {\n      // 前端使用 0-6 (0=周日)，后端使用 1-7 (1=周一)\n      request.repeatRule = {\n        type: \"weekly\",\n        days: task.repeatConfig.daysOfWeek.map((day) => {\n          // 转换：前端 0(周日) -> 后端 7(周日)\n          // 前端 1(周一) -> 后端 1(周一)\n          return day === 0 ? 7 : day\n        }),\n      }\n    } else if (task.repeatConfig.frequency === \"monthly\" && task.repeatConfig.dayOfMonth) {\n      request.repeatRule = {\n        type: \"monthly\",\n        days: [task.repeatConfig.dayOfMonth],\n      }\n    } else if (task.repeatConfig.frequency === \"daily\") {\n      request.repeatRule = {\n        type: \"daily\",\n        days: [],\n      }\n    }\n  } else if (task.repeatType && task.repeatType !== \"none\") {\n    // 如果已经有后端格式的重复类型，直接使用\n    request.repeatType = task.repeatType\n    request.repeatRule = task.repeatRule\n  } else {\n    request.repeatType = \"none\"\n  }\n\n  return request\n}\n\n/**\n * 将后端 RepeatRule 转换为前端 RepeatConfig\n */\nexport function transformRepeatRule(repeatType?: string, repeatRule?: RepeatRule): RepeatConfig | undefined {\n  if (!repeatType || repeatType === \"none\" || !repeatRule) {\n    return undefined\n  }\n\n  const config: RepeatConfig = {\n    enabled: true,\n    frequency: repeatRule.type as \"daily\" | \"weekly\" | \"monthly\",\n    interval: 1,\n  }\n\n  if (repeatRule.type === \"weekly\" && repeatRule.days.length > 0) {\n    // 后端使用 1-7 (1=周一)，前端使用 0-6 (0=周日)\n    config.daysOfWeek = repeatRule.days.map((day) => {\n      return day === 7 ? 0 : day\n    })\n  } else if (repeatRule.type === \"monthly\" && repeatRule.days.length > 0) {\n    config.dayOfMonth = repeatRule.days[0]\n  }\n\n  return config\n}\n\n/**\n * 将后端 TodoTypeResponse 转换为前端 TaskCategory\n */\nexport function transformTypeResponse(type: TodoTypeResponse): TaskCategory {\n  return {\n    id: type.typeId,\n    name: type.typeName,\n    icon: type.icon,\n    color: type.color,\n  }\n}\n\n/**\n * 将后端 TemplateResponse 转换为前端 TaskTemplate\n */\nexport function transformTemplateResponse(template: TemplateResponse): TaskTemplate {\n  return {\n    id: template.templateId,\n    name: template.templateName,\n    icon: \"📝\", // 后端没有图标字段，使用默认图标\n    description: template.description,\n    tasks: template.todos.map((todo) => ({\n      id: todo.id,\n      title: todo.title,\n      time: \"09:00\", // 后端模板任务项没有时间，使用默认时间\n      category: todo.typeName,\n      categoryIcon: todo.typeIcon,\n      categoryId: todo.typeId,\n      sortOrder: todo.sortOrder,\n    })),\n  }\n}\n\n/**\n * 将前端 TaskTemplate 转换为后端 TemplateCreateRequest\n */\nexport function transformTemplateToRequest(template: Omit<TaskTemplate, \"id\" | \"tasks\">): {\n  templateName: string\n  description?: string\n} {\n  return {\n    templateName: template.name,\n    description: template.description,\n  }\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2649, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/hooks/use-toast.ts"],"sourcesContent":["'use client'\n\n// Inspired by react-hot-toast library\nimport * as React from 'react'\n\nimport type { ToastActionElement, ToastProps } from '@/components/ui/toast'\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: 'ADD_TOAST',\n  UPDATE_TOAST: 'UPDATE_TOAST',\n  DISMISS_TOAST: 'DISMISS_TOAST',\n  REMOVE_TOAST: 'REMOVE_TOAST',\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType['ADD_TOAST']\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType['UPDATE_TOAST']\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType['DISMISS_TOAST']\n      toastId?: ToasterToast['id']\n    }\n  | {\n      type: ActionType['REMOVE_TOAST']\n      toastId?: ToasterToast['id']\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: 'REMOVE_TOAST',\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case 'ADD_TOAST':\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case 'UPDATE_TOAST':\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t,\n        ),\n      }\n\n    case 'DISMISS_TOAST': {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t,\n        ),\n      }\n    }\n    case 'REMOVE_TOAST':\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, 'id'>\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: 'UPDATE_TOAST',\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: 'DISMISS_TOAST', toastId: id })\n\n  dispatch({\n    type: 'ADD_TOAST',\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: 'DISMISS_TOAST', toastId }),\n  }\n}\n\nexport { useToast, toast }\n"],"names":[],"mappings":";;;;;;;;AAEA,sCAAsC;AACtC;AAHA;;AAOA,MAAM,cAAc;AACpB,MAAM,qBAAqB;AAS3B,MAAM,cAAc;IAClB,WAAW;IACX,cAAc;IACd,eAAe;IACf,cAAc;AAChB;AAEA,IAAI,QAAQ;AAEZ,SAAS;IACP,QAAQ,CAAC,QAAQ,CAAC,IAAI,OAAO,gBAAgB;IAC7C,OAAO,MAAM,QAAQ;AACvB;AA0BA,MAAM,gBAAgB,IAAI;AAE1B,MAAM,mBAAmB,CAAC;IACxB,IAAI,cAAc,GAAG,CAAC,UAAU;QAC9B;IACF;IAEA,MAAM,UAAU,WAAW;QACzB,cAAc,MAAM,CAAC;QACrB,SAAS;YACP,MAAM;YACN,SAAS;QACX;IACF,GAAG;IAEH,cAAc,GAAG,CAAC,SAAS;AAC7B;AAEO,MAAM,UAAU,CAAC,OAAc;IACpC,OAAQ,OAAO,IAAI;QACjB,KAAK;YACH,OAAO;gBACL,GAAG,KAAK;gBACR,QAAQ;oBAAC,OAAO,KAAK;uBAAK,MAAM,MAAM;iBAAC,CAAC,KAAK,CAAC,GAAG;YACnD;QAEF,KAAK;YACH,OAAO;gBACL,GAAG,KAAK;gBACR,QAAQ,MAAM,MAAM,CAAC,GAAG,CAAC,CAAC,IACxB,EAAE,EAAE,KAAK,OAAO,KAAK,CAAC,EAAE,GAAG;wBAAE,GAAG,CAAC;wBAAE,GAAG,OAAO,KAAK;oBAAC,IAAI;YAE3D;QAEF,KAAK;YAAiB;gBACpB,MAAM,EAAE,OAAO,EAAE,GAAG;gBAEpB,2EAA2E;gBAC3E,uCAAuC;gBACvC,IAAI,SAAS;oBACX,iBAAiB;gBACnB,OAAO;oBACL,MAAM,MAAM,CAAC,OAAO,CAAC,CAAC;wBACpB,iBAAiB,MAAM,EAAE;oBAC3B;gBACF;gBAEA,OAAO;oBACL,GAAG,KAAK;oBACR,QAAQ,MAAM,MAAM,CAAC,GAAG,CAAC,CAAC,IACxB,EAAE,EAAE,KAAK,WAAW,YAAY,YAC5B;4BACE,GAAG,CAAC;4BACJ,MAAM;wBACR,IACA;gBAER;YACF;QACA,KAAK;YACH,IAAI,OAAO,OAAO,KAAK,WAAW;gBAChC,OAAO;oBACL,GAAG,KAAK;oBACR,QAAQ,EAAE;gBACZ;YACF;YACA,OAAO;gBACL,GAAG,KAAK;gBACR,QAAQ,MAAM,MAAM,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,OAAO,OAAO;YAC5D;IACJ;AACF;AAEA,MAAM,YAA2C,EAAE;AAEnD,IAAI,cAAqB;IAAE,QAAQ,EAAE;AAAC;AAEtC,SAAS,SAAS,MAAc;IAC9B,cAAc,QAAQ,aAAa;IACnC,UAAU,OAAO,CAAC,CAAC;QACjB,SAAS;IACX;AACF;AAIA,SAAS,MAAM,EAAE,GAAG,OAAc;IAChC,MAAM,KAAK;IAEX,MAAM,SAAS,CAAC,QACd,SAAS;YACP,MAAM;YACN,OAAO;gBAAE,GAAG,KAAK;gBAAE;YAAG;QACxB;IACF,MAAM,UAAU,IAAM,SAAS;YAAE,MAAM;YAAiB,SAAS;QAAG;IAEpE,SAAS;QACP,MAAM;QACN,OAAO;YACL,GAAG,KAAK;YACR;YACA,MAAM;YACN,cAAc,CAAC;gBACb,IAAI,CAAC,MAAM;YACb;QACF;IACF;IAEA,OAAO;QACL,IAAI;QACJ;QACA;IACF;AACF;AAEA,SAAS;IACP,MAAM,CAAC,OAAO,SAAS,GAAG,+YAAc,CAAQ;IAEhD,gZAAe,CAAC;QACd,UAAU,IAAI,CAAC;QACf,OAAO;YACL,MAAM,QAAQ,UAAU,OAAO,CAAC;YAChC,IAAI,QAAQ,CAAC,GAAG;gBACd,UAAU,MAAM,CAAC,OAAO;YAC1B;QACF;IACF,GAAG;QAAC;KAAM;IAEV,OAAO;QACL,GAAG,KAAK;QACR;QACA,SAAS,CAAC,UAAqB,SAAS;gBAAE,MAAM;gBAAiB;YAAQ;IAC3E;AACF"}},
    {"offset": {"line": 2806, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/hooks/use-templates.ts"],"sourcesContent":["\"use client\"\n\nimport { useState, useCallback, useEffect } from \"react\"\nimport { apiClient } from \"@/lib/api-client\"\nimport { transformTemplateResponse, transformTemplateToRequest } from \"@/lib/data-transform\"\nimport type { TaskTemplate, TemplateResponse } from \"@/types/task\"\nimport { toast } from \"@/hooks/use-toast\"\n\nexport function useTemplates() {\n  const [templates, setTemplates] = useState<TaskTemplate[]>([])\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState<Error | null>(null)\n\n  const loadTemplates = useCallback(async () => {\n    setLoading(true)\n    setError(null)\n    try {\n      const response = await apiClient.getTemplates()\n      const transformedTemplates = response.data.map(transformTemplateResponse)\n      setTemplates(transformedTemplates)\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"加载模板失败\")\n      setError(error)\n      toast({\n        title: \"加载失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoading(false)\n    }\n  }, [])\n\n  useEffect(() => {\n    loadTemplates()\n  }, [loadTemplates])\n\n  const createTemplate = useCallback(async (template: Omit<TaskTemplate, \"id\" | \"tasks\">) => {\n    try {\n      const request = transformTemplateToRequest(template)\n      const response = await apiClient.createTemplate(request)\n      const newTemplate = transformTemplateResponse(response.data)\n      setTemplates((prev) => [...prev, newTemplate])\n      toast({\n        title: \"创建成功\",\n        description: `模板「${newTemplate.name}」已创建`,\n      })\n      return newTemplate\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"创建模板失败\")\n      toast({\n        title: \"创建失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n      throw error\n    }\n  }, [])\n\n  const updateTemplate = useCallback(async (id: string, template: Omit<TaskTemplate, \"id\" | \"tasks\">) => {\n    try {\n      const request = transformTemplateToRequest(template)\n      const response = await apiClient.updateTemplate(id, request)\n      const updatedTemplate = transformTemplateResponse(response.data)\n      setTemplates((prev) => prev.map((t) => (t.id === id ? updatedTemplate : t)))\n      toast({\n        title: \"更新成功\",\n        description: `模板「${updatedTemplate.name}」已更新`,\n      })\n      return updatedTemplate\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"更新模板失败\")\n      toast({\n        title: \"更新失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n      throw error\n    }\n  }, [])\n\n  const deleteTemplate = useCallback(async (id: string) => {\n    try {\n      await apiClient.deleteTemplate(id)\n      setTemplates((prev) => prev.filter((t) => t.id !== id))\n      toast({\n        title: \"删除成功\",\n        description: \"模板已删除\",\n      })\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"删除模板失败\")\n      toast({\n        title: \"删除失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n      throw error\n    }\n  }, [])\n\n  const addTemplateTodo = useCallback(async (templateId: string, title: string, typeId?: string) => {\n    try {\n      await apiClient.addTemplateTodo(templateId, title, typeId)\n      await loadTemplates() // 重新加载模板列表\n      toast({\n        title: \"添加成功\",\n        description: \"任务项已添加到模板\",\n      })\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"添加任务项失败\")\n      toast({\n        title: \"添加失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n      throw error\n    }\n  }, [loadTemplates])\n\n  const updateTemplateTodo = useCallback(\n    async (templateId: string, todoId: string, updates: { title?: string; typeId?: string }) => {\n      try {\n        await apiClient.updateTemplateTodo(templateId, todoId, updates)\n        await loadTemplates() // 重新加载模板列表\n        toast({\n          title: \"更新成功\",\n          description: \"任务项已更新\",\n        })\n      } catch (err) {\n        const error = err instanceof Error ? err : new Error(\"更新任务项失败\")\n        toast({\n          title: \"更新失败\",\n          description: error.message,\n          variant: \"destructive\",\n        })\n        throw error\n      }\n    },\n    [loadTemplates]\n  )\n\n  const deleteTemplateTodo = useCallback(async (templateId: string, todoId: string) => {\n    try {\n      await apiClient.deleteTemplateTodo(templateId, todoId)\n      await loadTemplates() // 重新加载模板列表\n      toast({\n        title: \"删除成功\",\n        description: \"任务项已删除\",\n      })\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"删除任务项失败\")\n      toast({\n        title: \"删除失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n      throw error\n    }\n  }, [loadTemplates])\n\n  const applyTemplate = useCallback(async (templateId: string, date: string, time?: string) => {\n    try {\n      const response = await apiClient.applyTemplate(templateId, date, time)\n      toast({\n        title: \"应用成功\",\n        description: `已创建 ${response.data.length} 个任务`,\n      })\n      return response.data\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"应用模板失败\")\n      toast({\n        title: \"应用失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n      throw error\n    }\n  }, [])\n\n  return {\n    templates,\n    loading,\n    error,\n    createTemplate,\n    updateTemplate,\n    deleteTemplate,\n    addTemplateTodo,\n    updateTemplateTodo,\n    deleteTemplateTodo,\n    applyTemplate,\n    refresh: loadTemplates,\n  }\n}\n\nexport function useTemplate(id: string | null) {\n  const [template, setTemplate] = useState<TaskTemplate | null>(null)\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState<Error | null>(null)\n\n  const loadTemplate = useCallback(async () => {\n    if (!id) {\n      setTemplate(null)\n      return\n    }\n\n    setLoading(true)\n    setError(null)\n    try {\n      const response = await apiClient.getTemplateById(id)\n      const transformedTemplate = transformTemplateResponse(response.data)\n      setTemplate(transformedTemplate)\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"加载模板失败\")\n      setError(error)\n      toast({\n        title: \"加载失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoading(false)\n    }\n  }, [id])\n\n  useEffect(() => {\n    loadTemplate()\n  }, [loadTemplate])\n\n  return {\n    template,\n    loading,\n    error,\n    refresh: loadTemplate,\n  }\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3049, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/components/template-manager.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { X, Plus, Edit2, Trash2, ChevronDown, ChevronRight } from \"lucide-react\"\nimport type { TaskTemplate, TaskCategory } from \"@/types/task\"\nimport { useTemplates } from \"@/hooks/use-templates\"\n\ninterface TemplateManagerProps {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  templates: TaskTemplate[]\n  categories: TaskCategory[]\n  onSave: (templates: TaskTemplate[]) => void\n}\n\nexport function TemplateManager({ open, onOpenChange, templates, categories, onSave }: TemplateManagerProps) {\n  const {\n    createTemplate,\n    updateTemplate,\n    deleteTemplate,\n    addTemplateTodo,\n    updateTemplateTodo,\n    deleteTemplateTodo,\n    refresh,\n  } = useTemplates()\n\n  const [localTemplates, setLocalTemplates] = useState<TaskTemplate[]>(templates)\n  const [editing, setEditing] = useState<string | null>(null)\n  const [editName, setEditName] = useState(\"\")\n  const [editIcon, setEditIcon] = useState(\"\")\n  const [expandedTemplate, setExpandedTemplate] = useState<string | null>(null)\n  const [editingTasks, setEditingTasks] = useState<\n    Array<{ id?: string; title: string; time: string; category?: string; categoryIcon?: string; categoryId?: string }>\n  >([])\n  const [editingTemplateId, setEditingTemplateId] = useState<string | null>(null)\n  const [saving, setSaving] = useState(false)\n\n  // 当 templates prop 变化时，更新本地状态\n  useEffect(() => {\n    setLocalTemplates(templates)\n  }, [templates])\n\n  const handleAddTemplate = async () => {\n    try {\n      setSaving(true)\n      const newTemplate = await createTemplate({\n        name: \"新模板\",\n        icon: \"📝\",\n        description: \"\",\n      })\n      setLocalTemplates([...localTemplates, newTemplate])\n      onSave([]) // 通知父组件刷新\n      setEditing(newTemplate.id)\n      setEditName(newTemplate.name)\n      setEditIcon(newTemplate.icon)\n    } catch (error) {\n      console.error(\"创建模板失败:\", error)\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  const handleSaveEdit = async (id: string) => {\n    if (!editName.trim()) {\n      return\n    }\n    try {\n      setSaving(true)\n      const template = localTemplates.find((t) => t.id === id)\n      if (!template) return\n\n      await updateTemplate(id, {\n        name: editName,\n        icon: editIcon,\n        description: template.description,\n      })\n      await refresh()\n      onSave([]) // 通知父组件刷新\n      setEditing(null)\n    } catch (error) {\n      console.error(\"更新模板失败:\", error)\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  const handleDeleteTemplate = async (id: string) => {\n    if (!confirm(\"确定要删除这个模板吗？\")) {\n      return\n    }\n    try {\n      setSaving(true)\n      await deleteTemplate(id)\n      setLocalTemplates((prev) => prev.filter((t) => t.id !== id))\n      onSave([]) // 通知父组件刷新\n    } catch (error) {\n      console.error(\"删除模板失败:\", error)\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  const handleEditTasks = (template: TaskTemplate) => {\n    setEditingTemplateId(template.id)\n    setEditingTasks(\n      template.tasks.map((task) => ({\n        id: task.id,\n        title: task.title,\n        time: task.time,\n        category: task.category,\n        categoryIcon: task.categoryIcon,\n        categoryId: task.categoryId,\n      }))\n    )\n  }\n\n  const handleSaveEditedTasks = async () => {\n    if (!editingTemplateId) return\n\n    const template = localTemplates.find((t) => t.id === editingTemplateId)\n    if (!template) return\n\n    try {\n      setSaving(true)\n\n      // 获取原始任务列表\n      const originalTasks = template.tasks\n\n      // 找出需要删除的任务（在原始列表中但不在新列表中）\n      const tasksToDelete = originalTasks.filter(\n        (originalTask) => originalTask.id && !editingTasks.find((task) => task.id === originalTask.id)\n      )\n\n      // 找出需要添加的任务（在新列表中但没有 id）\n      const tasksToAdd = editingTasks.filter((task) => !task.id)\n\n      // 找出需要更新的任务（在新列表中有 id 但内容有变化）\n      const tasksToUpdate = editingTasks.filter((task) => {\n        if (!task.id) return false\n        const originalTask = originalTasks.find((t) => t.id === task.id)\n        if (!originalTask) return false\n        return (\n          originalTask.title !== task.title ||\n          originalTask.categoryId !== task.categoryId\n        )\n      })\n\n      // 执行删除操作\n      for (const task of tasksToDelete) {\n        if (task.id) {\n          await deleteTemplateTodo(editingTemplateId, task.id)\n        }\n      }\n\n      // 执行添加操作\n      for (const task of tasksToAdd) {\n        await addTemplateTodo(editingTemplateId, task.title, task.categoryId)\n      }\n\n      // 执行更新操作\n      for (const task of tasksToUpdate) {\n        if (task.id) {\n          await updateTemplateTodo(editingTemplateId, task.id, {\n            title: task.title,\n            typeId: task.categoryId,\n          })\n        }\n      }\n\n      // 刷新模板列表\n      await refresh()\n      onSave([]) // 通知父组件刷新\n      setEditingTemplateId(null)\n      setEditingTasks([])\n    } catch (error) {\n      console.error(\"保存模板项失败:\", error)\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  const handleAddTaskToTemplate = () => {\n    setEditingTasks([...editingTasks, { title: \"新任务\", time: \"09:00\" }])\n  }\n\n  const handleDeleteTaskFromTemplate = (index: number) => {\n    setEditingTasks((prev) => prev.filter((_, i) => i !== index))\n  }\n\n  const handleUpdateTask = (index: number, field: \"title\" | \"time\" | \"category\", value: string) => {\n    setEditingTasks((prev) => {\n      const newTasks = [...prev]\n      if (field === \"category\") {\n        const category = categories.find((c) => c.id === value)\n        newTasks[index] = {\n          ...newTasks[index],\n          category: category?.name,\n          categoryIcon: category?.icon,\n          categoryId: category?.id,\n        }\n      } else {\n        newTasks[index] = { ...newTasks[index], [field]: value }\n      }\n      return newTasks\n    })\n  }\n\n  const handleSave = async () => {\n    try {\n      setSaving(true)\n      await refresh()\n      onSave([]) // 通知父组件刷新\n      onOpenChange(false)\n    } catch (error) {\n      console.error(\"刷新模板列表失败:\", error)\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  if (!open) return null\n\n  return (\n    <>\n      <div className=\"fixed inset-0 z-40 bg-black/40 backdrop-blur-sm\" onClick={() => onOpenChange(false)} />\n\n      <div className=\"fixed inset-x-0 bottom-0 z-50 bg-background rounded-t-3xl shadow-2xl animate-slide-up pb-safe max-h-[85vh] overflow-y-auto\">\n        <div className=\"px-5 py-4 border-b border-border/40 sticky top-0 bg-background z-10\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-lg font-semibold\">管理模板</h2>\n            <button\n              onClick={() => onOpenChange(false)}\n              className=\"w-8 h-8 rounded-full bg-muted/50 flex items-center justify-center active:scale-95 transition-transform\"\n            >\n              <X className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n\n        <div className=\"px-5 py-5 space-y-3\">\n          {localTemplates.map((template) => (\n            <div key={template.id} className=\"rounded-xl border border-border/40 bg-muted/20 overflow-hidden\">\n              <div className=\"p-4\">\n                {editing === template.id ? (\n                  <div className=\"space-y-3\">\n                    <input\n                      type=\"text\"\n                      value={editIcon}\n                      onChange={(e) => setEditIcon(e.target.value)}\n                      placeholder=\"图标 (emoji)\"\n                      className=\"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm\"\n                    />\n                    <input\n                      type=\"text\"\n                      value={editName}\n                      onChange={(e) => setEditName(e.target.value)}\n                      placeholder=\"模板名称\"\n                      className=\"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm\"\n                    />\n                    <button\n                      onClick={() => handleSaveEdit(template.id)}\n                      disabled={saving || !editName.trim()}\n                      className=\"w-full py-2 rounded-lg bg-foreground text-background text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      {saving ? \"保存中...\" : \"保存\"}\n                    </button>\n                  </div>\n                ) : editingTemplateId === template.id ? (\n                  <div className=\"space-y-3\">\n                    <div className=\"flex items-center gap-2 mb-3\">\n                      <div className=\"text-2xl\">{template.icon}</div>\n                      <div className=\"flex-1 font-medium\">{template.name}</div>\n                      <button\n                        onClick={handleSaveEditedTasks}\n                        disabled={saving}\n                        className=\"px-3 py-1.5 rounded-lg bg-foreground text-background text-xs font-medium disabled:opacity-50 disabled:cursor-not-allowed\"\n                      >\n                        {saving ? \"保存中...\" : \"保存修改\"}\n                      </button>\n                    </div>\n\n                    <div className=\"space-y-2 max-h-96 overflow-y-auto\">\n                      {editingTasks.map((task, idx) => (\n                        <div key={idx} className=\"p-3 rounded-lg bg-background/50 border border-border/30 space-y-2\">\n                          <div className=\"flex items-start gap-2\">\n                            <div className=\"flex-1 space-y-2\">\n                              <input\n                                type=\"text\"\n                                value={task.title}\n                                onChange={(e) => handleUpdateTask(idx, \"title\", e.target.value)}\n                                placeholder=\"任务名称\"\n                                className=\"w-full px-2 py-1.5 rounded border border-border/40 bg-background text-sm\"\n                              />\n                              <input\n                                type=\"time\"\n                                value={task.time}\n                                onChange={(e) => handleUpdateTask(idx, \"time\", e.target.value)}\n                                className=\"w-full px-2 py-1.5 rounded border border-border/40 bg-background text-sm\"\n                              />\n                              <select\n                                value={categories.find((c) => c.name === task.category)?.id || \"\"}\n                                onChange={(e) => handleUpdateTask(idx, \"category\", e.target.value)}\n                                className=\"w-full px-2 py-1.5 rounded border border-border/40 bg-background text-sm\"\n                              >\n                                <option value=\"\">无分类</option>\n                                {categories.map((cat) => (\n                                  <option key={cat.id} value={cat.id}>\n                                    {cat.icon} {cat.name}\n                                  </option>\n                                ))}\n                              </select>\n                            </div>\n                            <button\n                              onClick={() => handleDeleteTaskFromTemplate(idx)}\n                              className=\"w-7 h-7 rounded-lg bg-red-500/10 text-red-500 flex items-center justify-center active:scale-95 transition-transform\"\n                            >\n                              <Trash2 className=\"h-3.5 w-3.5\" />\n                            </button>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n\n                    <button\n                      onClick={handleAddTaskToTemplate}\n                      className=\"w-full py-2.5 rounded-lg border border-dashed border-border/40 bg-muted/20 text-sm text-muted-foreground active:scale-95 transition-transform flex items-center justify-center gap-2\"\n                    >\n                      <Plus className=\"h-4 w-4\" />\n                      添加任务项\n                    </button>\n                  </div>\n                ) : (\n                  <>\n                    <div className=\"flex items-start gap-3\">\n                      <button\n                        onClick={() => setExpandedTemplate(expandedTemplate === template.id ? null : template.id)}\n                        className=\"mt-1 active:scale-95 transition-transform\"\n                      >\n                        {expandedTemplate === template.id ? (\n                          <ChevronDown className=\"h-4 w-4 text-muted-foreground\" />\n                        ) : (\n                          <ChevronRight className=\"h-4 w-4 text-muted-foreground\" />\n                        )}\n                      </button>\n                      <div className=\"text-2xl\">{template.icon}</div>\n                      <div className=\"flex-1\">\n                        <div className=\"font-medium\">{template.name}</div>\n                        <div className=\"text-xs text-muted-foreground mt-1\">{template.tasks.length} 项任务</div>\n                      </div>\n                      <div className=\"flex gap-2\">\n                        <button\n                          onClick={() => handleEditTasks(template)}\n                          className=\"w-8 h-8 rounded-lg bg-blue-500/10 text-blue-500 flex items-center justify-center active:scale-95 transition-transform\"\n                          title=\"编辑任务\"\n                        >\n                          <Edit2 className=\"h-4 w-4\" />\n                        </button>\n                        <button\n                          onClick={() => {\n                            setEditing(template.id)\n                            setEditName(template.name)\n                            setEditIcon(template.icon)\n                          }}\n                          className=\"w-8 h-8 rounded-lg bg-muted/50 flex items-center justify-center active:scale-95 transition-transform\"\n                          title=\"编辑名称\"\n                        >\n                          <Edit2 className=\"h-4 w-4\" />\n                        </button>\n                        <button\n                          onClick={() => handleDeleteTemplate(template.id)}\n                          disabled={saving}\n                          className=\"w-8 h-8 rounded-lg bg-red-500/10 text-red-500 flex items-center justify-center active:scale-95 transition-transform disabled:opacity-50 disabled:cursor-not-allowed\"\n                          title=\"删除模板\"\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                        </button>\n                      </div>\n                    </div>\n\n                    {expandedTemplate === template.id && template.tasks.length > 0 && (\n                      <div className=\"mt-4 pt-4 border-t border-border/30 space-y-2\">\n                        {template.tasks.map((task, idx) => (\n                          <div key={idx} className=\"flex items-start gap-2 text-sm bg-background/50 rounded-lg p-2.5\">\n                            <div className=\"w-5 h-5 rounded-full bg-muted/50 flex items-center justify-center text-xs text-muted-foreground flex-shrink-0 mt-0.5\">\n                              {idx + 1}\n                            </div>\n                            <div className=\"flex-1\">\n                              <div className=\"flex items-center gap-1.5\">\n                                {task.categoryIcon && <span className=\"text-sm\">{task.categoryIcon}</span>}\n                                <span className=\"font-medium\">{task.title}</span>\n                              </div>\n                              <div className=\"text-xs text-muted-foreground mt-0.5 flex items-center gap-2\">\n                                <span>{task.time}</span>\n                                {task.category && <span>· {task.category}</span>}\n                              </div>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </>\n                )}\n              </div>\n            </div>\n          ))}\n\n          <button\n            onClick={handleAddTemplate}\n            disabled={saving}\n            className=\"w-full py-3 rounded-xl border border-dashed border-border/40 bg-muted/20 text-sm font-medium text-muted-foreground active:scale-[0.98] transition-transform flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            <Plus className=\"h-4 w-4\" />\n            {saving ? \"创建中...\" : \"添加新模板\"}\n          </button>\n        </div>\n\n        <div className=\"px-5 pb-5\">\n          <button\n            onClick={handleSave}\n            disabled={saving}\n            className=\"w-full py-3.5 rounded-xl bg-foreground text-background font-medium active:scale-[0.98] transition-transform disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            完成\n          </button>\n        </div>\n      </div>\n    </>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3789, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/components/category-manager.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { X, Plus, Trash2 } from \"lucide-react\"\nimport type { TaskCategory } from \"@/types/task\"\n\ninterface CategoryManagerProps {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  categories: TaskCategory[]\n  onCreateCategory: (category: Omit<TaskCategory, \"id\">) => Promise<TaskCategory>\n  onDeleteCategory: (id: string) => Promise<void>\n  onSave?: () => void\n}\n\n// 常用图标列表\nconst COMMON_ICONS = [\n  \"💪\",\n  \"⭐\",\n  \"▶️\",\n  \"✅\",\n  \"🎯\",\n  \"📚\",\n  \"🏃\",\n  \"🍎\",\n  \"💼\",\n  \"🎨\",\n  \"🎵\",\n  \"📱\",\n  \"✈️\",\n  \"🏠\",\n  \"🛒\",\n  \"💰\",\n  \"🎓\",\n  \"🧘\",\n  \"🏋️\",\n  \"🚴\",\n  \"📝\",\n  \"💡\",\n  \"🎬\",\n  \"🎮\",\n]\n\nexport function CategoryManager({ \n  open, \n  onOpenChange, \n  categories, \n  onCreateCategory,\n  onDeleteCategory,\n  onSave \n}: CategoryManagerProps) {\n  const [newCategoryName, setNewCategoryName] = useState(\"\")\n  const [selectedIcon, setSelectedIcon] = useState(\"⭐\")\n  const [isCreating, setIsCreating] = useState(false)\n  const [deletingIds, setDeletingIds] = useState<Set<string>>(new Set())\n\n  // 当组件打开时重置表单\n  useEffect(() => {\n    if (open) {\n      setNewCategoryName(\"\")\n      setSelectedIcon(\"⭐\")\n    }\n  }, [open])\n\n  const handleAddCategory = async () => {\n    if (!newCategoryName.trim() || isCreating) return\n\n    setIsCreating(true)\n    try {\n      await onCreateCategory({\n        name: newCategoryName.trim(),\n        icon: selectedIcon,\n      })\n      setNewCategoryName(\"\")\n      setSelectedIcon(\"⭐\")\n    } catch (error) {\n      // 错误已经在 hook 中处理了\n    } finally {\n      setIsCreating(false)\n    }\n  }\n\n  const handleDeleteCategory = async (id: string) => {\n    if (deletingIds.has(id)) return\n\n    setDeletingIds((prev) => new Set(prev).add(id))\n    try {\n      await onDeleteCategory(id)\n    } catch (error) {\n      // 错误已经在 hook 中处理了\n    } finally {\n      setDeletingIds((prev) => {\n        const next = new Set(prev)\n        next.delete(id)\n        return next\n      })\n    }\n  }\n\n  const handleSave = () => {\n    if (onSave) {\n      onSave()\n    }\n    onOpenChange(false)\n  }\n\n  if (!open) return null\n\n  return (\n    <>\n      <div className=\"fixed inset-0 z-40 bg-black/40 backdrop-blur-sm\" onClick={() => onOpenChange(false)} />\n\n      <div className=\"fixed inset-x-0 bottom-0 z-50 bg-background rounded-t-3xl shadow-2xl animate-slide-up pb-safe max-h-[85vh] overflow-y-auto\">\n        <div className=\"px-5 py-4 border-b border-border/40 sticky top-0 bg-background z-10\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-lg font-semibold\">管理分类</h2>\n            <button\n              onClick={() => onOpenChange(false)}\n              className=\"w-8 h-8 rounded-full bg-muted/50 flex items-center justify-center active:scale-95 transition-transform\"\n            >\n              <X className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n\n        <div className=\"px-5 py-5 space-y-5\">\n          {/* 添加新分类 */}\n          <div className=\"space-y-3 p-4 rounded-xl bg-muted/20 border border-border/40\">\n            <h3 className=\"text-sm font-medium\">添加新分类</h3>\n\n            <div>\n              <label className=\"block text-xs font-medium mb-2\">选择图标</label>\n              <div className=\"flex flex-wrap gap-2\">\n                {COMMON_ICONS.map((icon) => (\n                  <button\n                    key={icon}\n                    type=\"button\"\n                    onClick={() => setSelectedIcon(icon)}\n                    className={`w-10 h-10 rounded-lg flex items-center justify-center text-xl transition-all active:scale-95 ${\n                      selectedIcon === icon\n                        ? \"bg-foreground text-background ring-2 ring-foreground ring-offset-2\"\n                        : \"bg-background border border-border/40\"\n                    }`}\n                  >\n                    {icon}\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            <div>\n              <label className=\"block text-xs font-medium mb-2\">分类名称</label>\n              <input\n                type=\"text\"\n                value={newCategoryName}\n                onChange={(e) => setNewCategoryName(e.target.value)}\n                onKeyDown={(e) => {\n                  if (e.key === \"Enter\" && newCategoryName.trim() && !isCreating) {\n                    e.preventDefault()\n                    handleAddCategory()\n                  }\n                }}\n                placeholder=\"例如：运动、学习、工作\"\n                className=\"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm focus:outline-none focus:ring-2 focus:ring-foreground/20\"\n              />\n            </div>\n\n            <button\n              onClick={handleAddCategory}\n              disabled={!newCategoryName.trim() || isCreating}\n              className=\"w-full py-2 rounded-lg bg-foreground text-background text-sm font-medium active:scale-[0.98] transition-transform disabled:opacity-40 flex items-center justify-center gap-2\"\n            >\n              <Plus className=\"h-4 w-4\" />\n              {isCreating ? \"添加中...\" : \"添加分类\"}\n            </button>\n          </div>\n\n          {/* 现有分类列表 */}\n          <div>\n            <h3 className=\"text-sm font-medium mb-3\">已有分类</h3>\n            <div className=\"space-y-2\">\n              {categories.map((category) => {\n                const isDeleting = deletingIds.has(category.id)\n                return (\n                  <div\n                    key={category.id}\n                    className=\"flex items-center justify-between p-3 rounded-xl bg-muted/20 border border-border/40\"\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <span className=\"text-2xl\">{category.icon}</span>\n                      <span className=\"text-sm font-medium\">{category.name}</span>\n                    </div>\n                    <button\n                      onClick={() => handleDeleteCategory(category.id)}\n                      disabled={isDeleting}\n                      className=\"w-8 h-8 rounded-lg bg-red-500/10 text-red-500 flex items-center justify-center active:scale-95 transition-transform disabled:opacity-50\"\n                    >\n                      <Trash2 className=\"h-4 w-4\" />\n                    </button>\n                  </div>\n                )\n              })}\n              {categories.length === 0 && (\n                <p className=\"text-sm text-muted-foreground text-center py-4\">暂无分类，添加一个试试吧</p>\n              )}\n            </div>\n          </div>\n\n          <button\n            onClick={handleSave}\n            className=\"w-full py-3.5 rounded-xl bg-foreground text-background font-medium active:scale-[0.98] transition-transform\"\n          >\n            完成\n          </button>\n        </div>\n      </div>\n    </>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAHA;;;;AAeA,SAAS;AACT,MAAM,eAAe;IACnB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAEM,SAAS,gBAAgB,EAC9B,IAAI,EACJ,YAAY,EACZ,UAAU,EACV,gBAAgB,EAChB,gBAAgB,EAChB,MAAM,EACe;IACrB,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,+YAAQ,EAAC;IACvD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,+YAAQ,EAAC;IACjD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,+YAAQ,EAAC;IAC7C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,+YAAQ,EAAc,IAAI;IAEhE,aAAa;IACb,IAAA,gZAAS,EAAC;QACR,IAAI,MAAM;YACR,mBAAmB;YACnB,gBAAgB;QAClB;IACF,GAAG;QAAC;KAAK;IAET,MAAM,oBAAoB;QACxB,IAAI,CAAC,gBAAgB,IAAI,MAAM,YAAY;QAE3C,cAAc;QACd,IAAI;YACF,MAAM,iBAAiB;gBACrB,MAAM,gBAAgB,IAAI;gBAC1B,MAAM;YACR;YACA,mBAAmB;YACnB,gBAAgB;QAClB,EAAE,OAAO,OAAO;QACd,kBAAkB;QACpB,SAAU;YACR,cAAc;QAChB;IACF;IAEA,MAAM,uBAAuB,OAAO;QAClC,IAAI,YAAY,GAAG,CAAC,KAAK;QAEzB,eAAe,CAAC,OAAS,IAAI,IAAI,MAAM,GAAG,CAAC;QAC3C,IAAI;YACF,MAAM,iBAAiB;QACzB,EAAE,OAAO,OAAO;QACd,kBAAkB;QACpB,SAAU;YACR,eAAe,CAAC;gBACd,MAAM,OAAO,IAAI,IAAI;gBACrB,KAAK,MAAM,CAAC;gBACZ,OAAO;YACT;QACF;IACF;IAEA,MAAM,aAAa;QACjB,IAAI,QAAQ;YACV;QACF;QACA,aAAa;IACf;IAEA,IAAI,CAAC,MAAM,OAAO;IAElB,qBACE;;0BACE,4aAAC;gBAAI,WAAU;gBAAkD,SAAS,IAAM,aAAa;;;;;;0BAE7F,4aAAC;gBAAI,WAAU;;kCACb,4aAAC;wBAAI,WAAU;kCACb,cAAA,4aAAC;4BAAI,WAAU;;8CACb,4aAAC;oCAAG,WAAU;8CAAwB;;;;;;8CACtC,4aAAC;oCACC,SAAS,IAAM,aAAa;oCAC5B,WAAU;8CAEV,cAAA,4aAAC,mVAAC;wCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;kCAKnB,4aAAC;wBAAI,WAAU;;0CAEb,4aAAC;gCAAI,WAAU;;kDACb,4aAAC;wCAAG,WAAU;kDAAsB;;;;;;kDAEpC,4aAAC;;0DACC,4aAAC;gDAAM,WAAU;0DAAiC;;;;;;0DAClD,4aAAC;gDAAI,WAAU;0DACZ,aAAa,GAAG,CAAC,CAAC,qBACjB,4aAAC;wDAEC,MAAK;wDACL,SAAS,IAAM,gBAAgB;wDAC/B,WAAW,CAAC,6FAA6F,EACvG,iBAAiB,OACb,uEACA,yCACJ;kEAED;uDATI;;;;;;;;;;;;;;;;kDAeb,4aAAC;;0DACC,4aAAC;gDAAM,WAAU;0DAAiC;;;;;;0DAClD,4aAAC;gDACC,MAAK;gDACL,OAAO;gDACP,UAAU,CAAC,IAAM,mBAAmB,EAAE,MAAM,CAAC,KAAK;gDAClD,WAAW,CAAC;oDACV,IAAI,EAAE,GAAG,KAAK,WAAW,gBAAgB,IAAI,MAAM,CAAC,YAAY;wDAC9D,EAAE,cAAc;wDAChB;oDACF;gDACF;gDACA,aAAY;gDACZ,WAAU;;;;;;;;;;;;kDAId,4aAAC;wCACC,SAAS;wCACT,UAAU,CAAC,gBAAgB,IAAI,MAAM;wCACrC,WAAU;;0DAEV,4aAAC,4VAAI;gDAAC,WAAU;;;;;;4CACf,aAAa,WAAW;;;;;;;;;;;;;0CAK7B,4aAAC;;kDACC,4aAAC;wCAAG,WAAU;kDAA2B;;;;;;kDACzC,4aAAC;wCAAI,WAAU;;4CACZ,WAAW,GAAG,CAAC,CAAC;gDACf,MAAM,aAAa,YAAY,GAAG,CAAC,SAAS,EAAE;gDAC9C,qBACE,4aAAC;oDAEC,WAAU;;sEAEV,4aAAC;4DAAI,WAAU;;8EACb,4aAAC;oEAAK,WAAU;8EAAY,SAAS,IAAI;;;;;;8EACzC,4aAAC;oEAAK,WAAU;8EAAuB,SAAS,IAAI;;;;;;;;;;;;sEAEtD,4aAAC;4DACC,SAAS,IAAM,qBAAqB,SAAS,EAAE;4DAC/C,UAAU;4DACV,WAAU;sEAEV,cAAA,4aAAC,sWAAM;gEAAC,WAAU;;;;;;;;;;;;mDAZf,SAAS,EAAE;;;;;4CAgBtB;4CACC,WAAW,MAAM,KAAK,mBACrB,4aAAC;gDAAE,WAAU;0DAAiD;;;;;;;;;;;;;;;;;;0CAKpE,4aAAC;gCACC,SAAS;gCACT,WAAU;0CACX;;;;;;;;;;;;;;;;;;;;AAOX"}},
    {"offset": {"line": 4152, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/hooks/use-statistics.ts"],"sourcesContent":["\"use client\"\n\nimport { useState, useCallback, useEffect } from \"react\"\nimport { apiClient } from \"@/lib/api-client\"\nimport type { MonthStatisticsResponse, TypeStatisticsResponse } from \"@/types/task\"\nimport { toast } from \"@/hooks/use-toast\"\n\ninterface UseStatisticsOptions {\n  autoLoad?: boolean\n}\n\nexport function useStatistics(yearMonth: string, options: UseStatisticsOptions = {}) {\n  const { autoLoad = true } = options\n  const [monthStats, setMonthStats] = useState<MonthStatisticsResponse | null>(null)\n  const [typeStats, setTypeStats] = useState<TypeStatisticsResponse[]>([])\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState<Error | null>(null)\n\n  const loadStatistics = useCallback(async () => {\n    setLoading(true)\n    setError(null)\n    try {\n      const [monthResponse, typeResponse] = await Promise.all([\n        apiClient.getMonthStatistics(yearMonth),\n        apiClient.getTypeStatistics(yearMonth),\n      ])\n      setMonthStats(monthResponse.data)\n      setTypeStats(typeResponse.data)\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"加载统计数据失败\")\n      setError(error)\n      toast({\n        title: \"加载失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoading(false)\n    }\n  }, [yearMonth])\n\n  useEffect(() => {\n    if (autoLoad && yearMonth) {\n      loadStatistics()\n    }\n  }, [autoLoad, yearMonth, loadStatistics])\n\n  return {\n    monthStats,\n    typeStats,\n    loading,\n    error,\n    refresh: loadStatistics,\n  }\n}\n\n"],"names":[],"mappings":";;;;AAEA;AACA;AAEA;AALA;;;;AAWO,SAAS,cAAc,SAAiB,EAAE,UAAgC,CAAC,CAAC;IACjF,MAAM,EAAE,WAAW,IAAI,EAAE,GAAG;IAC5B,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,+YAAQ,EAAiC;IAC7E,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,+YAAQ,EAA2B,EAAE;IACvE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+YAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+YAAQ,EAAe;IAEjD,MAAM,iBAAiB,IAAA,kZAAW,EAAC;QACjC,WAAW;QACX,SAAS;QACT,IAAI;YACF,MAAM,CAAC,eAAe,aAAa,GAAG,MAAM,QAAQ,GAAG,CAAC;gBACtD,+LAAS,CAAC,kBAAkB,CAAC;gBAC7B,+LAAS,CAAC,iBAAiB,CAAC;aAC7B;YACD,cAAc,cAAc,IAAI;YAChC,aAAa,aAAa,IAAI;QAChC,EAAE,OAAO,KAAK;YACZ,MAAM,QAAQ,eAAe,QAAQ,MAAM,IAAI,MAAM;YACrD,SAAS;YACT,IAAA,4LAAK,EAAC;gBACJ,OAAO;gBACP,aAAa,MAAM,OAAO;gBAC1B,SAAS;YACX;QACF,SAAU;YACR,WAAW;QACb;IACF,GAAG;QAAC;KAAU;IAEd,IAAA,gZAAS,EAAC;QACR,IAAI,YAAY,WAAW;YACzB;QACF;IACF,GAAG;QAAC;QAAU;QAAW;KAAe;IAExC,OAAO;QACL;QACA;QACA;QACA;QACA,SAAS;IACX;AACF"}},
    {"offset": {"line": 4214, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/components/statistics-view.tsx"],"sourcesContent":["\"use client\"\n\nimport { useMemo } from \"react\"\nimport { X, TrendingUp, Award, Target, Loader2 } from \"lucide-react\"\nimport { useStatistics } from \"@/hooks/use-statistics\"\n\ninterface StatisticsViewProps {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n}\n\nexport function StatisticsView({ open, onOpenChange }: StatisticsViewProps) {\n  // 获取当前年月（格式：yyyy-MM）\n  const yearMonth = useMemo(() => {\n    const now = new Date()\n    const year = now.getFullYear()\n    const month = String(now.getMonth() + 1).padStart(2, \"0\")\n    return `${year}-${month}`\n  }, [open]) // 当 open 变化时重新计算，确保使用最新的月份\n\n  // 使用 hook 获取统计数据\n  const { monthStats, typeStats, loading } = useStatistics(yearMonth, { autoLoad: open })\n\n  if (!open) return null\n\n  return (\n    <>\n      <div className=\"fixed inset-0 z-40 bg-black/40 backdrop-blur-sm\" onClick={() => onOpenChange(false)} />\n\n      <div className=\"fixed inset-x-0 bottom-0 z-50 bg-background rounded-t-3xl shadow-2xl animate-slide-up pb-safe max-h-[85vh] overflow-y-auto\">\n        <div className=\"px-5 py-4 border-b border-border/40 sticky top-0 bg-background z-10\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-lg font-semibold\">本月统计</h2>\n            <button\n              onClick={() => onOpenChange(false)}\n              className=\"w-8 h-8 rounded-full bg-muted/50 flex items-center justify-center active:scale-95 transition-transform\"\n            >\n              <X className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n\n        <div className=\"px-5 py-5 space-y-5\">\n          {loading ? (\n            <div className=\"flex items-center justify-center py-12\">\n              <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n            </div>\n          ) : (\n            <>\n              {/* 总体统计卡片 */}\n              <div className=\"p-5 rounded-2xl bg-gradient-to-br from-purple-500/10 to-pink-500/10 border border-purple-500/20\">\n                <div className=\"flex items-center gap-2 mb-4\">\n                  <Award className=\"h-5 w-5 text-purple-500\" />\n                  <h3 className=\"text-base font-semibold\">总体完成情况</h3>\n                </div>\n                <div className=\"flex items-end gap-2 mb-2\">\n                  <span className=\"text-4xl font-bold\">\n                    {monthStats ? Math.round(monthStats.completionRate * 100) : 0}%\n                  </span>\n                  <span className=\"text-muted-foreground mb-1\">完成率</span>\n                </div>\n                <p className=\"text-sm text-muted-foreground\">\n                  已完成 {monthStats?.completedCount ?? 0} / {monthStats?.totalCount ?? 0} 项任务\n                </p>\n              </div>\n\n              {/* 分类统计 */}\n              <div>\n                <div className=\"flex items-center gap-2 mb-3\">\n                  <Target className=\"h-4 w-4\" />\n                  <h3 className=\"text-sm font-semibold\">分类统计</h3>\n                </div>\n\n                {typeStats && typeStats.length > 0 ? (\n                  <div className=\"space-y-3\">\n                    {typeStats.map((stat) => (\n                      <div key={stat.typeId} className=\"p-4 rounded-xl bg-muted/20 border border-border/40\">\n                        <div className=\"flex items-center justify-between mb-3\">\n                          <div className=\"flex items-center gap-2\">\n                            <span className=\"text-2xl\">{stat.typeIcon}</span>\n                            <span className=\"font-medium\">{stat.typeName}</span>\n                          </div>\n                          <div className=\"text-right\">\n                            <div className=\"text-lg font-bold\">{stat.completedCount}</div>\n                            <div className=\"text-xs text-muted-foreground\">已完成</div>\n                          </div>\n                        </div>\n\n                        {/* 进度条 - 基于分类的完成情况计算 */}\n                        <div className=\"h-2 bg-muted rounded-full overflow-hidden\">\n                          <div\n                            className=\"h-full bg-gradient-to-r from-purple-500 to-pink-500 transition-all duration-500\"\n                            style={{\n                              width: `${(() => {\n                                const total = stat.completedCount + (stat.pendingCount || 0)\n                                if (total === 0) return 0\n                                return Math.round((stat.completedCount / total) * 100)\n                              })()}%`\n                            }}\n                          />\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8 text-muted-foreground\">\n                    <TrendingUp className=\"h-12 w-12 mx-auto mb-3 opacity-40\" />\n                    <p className=\"text-sm\">本月还没有完成的任务</p>\n                    <p className=\"text-xs mt-1\">开始添加并完成任务来查看统计吧</p>\n                  </div>\n                )}\n              </div>\n\n              {/* 成就提示 */}\n              {monthStats && Math.round(monthStats.completionRate * 100) >= 80 && (\n                <div className=\"p-4 rounded-xl bg-gradient-to-r from-amber-500/10 to-orange-500/10 border border-amber-500/20\">\n                  <div className=\"flex items-center gap-2 text-amber-600 dark:text-amber-400\">\n                    <Award className=\"h-5 w-5\" />\n                    <div>\n                      <div className=\"font-semibold\">太棒了！</div>\n                      <div className=\"text-xs\">本月完成率超过80%，继续保持！</div>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </>\n          )}\n        </div>\n      </div>\n    </>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4617, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/components/ai-chat.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\n\nimport { useState, useRef, useEffect } from \"react\"\nimport { X, Send, Sparkles } from \"lucide-react\"\n\ninterface Message {\n  id: string\n  role: \"user\" | \"assistant\"\n  content: string\n}\n\ninterface AIChatProps {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n}\n\nexport function AIChat({ open, onOpenChange }: AIChatProps) {\n  const [messages, setMessages] = useState<Message[]>([\n    {\n      id: \"1\",\n      role: \"assistant\",\n      content: \"你好！我是你的 AI 助手，可以帮你管理待办事项、提供建议和回答问题。有什么可以帮你的吗？\",\n    },\n  ])\n  const [input, setInput] = useState(\"\")\n  const [isTyping, setIsTyping] = useState(false)\n  const messagesEndRef = useRef<HTMLDivElement>(null)\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" })\n  }\n\n  useEffect(() => {\n    scrollToBottom()\n  }, [messages])\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    if (!input.trim()) return\n\n    const userMessage: Message = {\n      id: Date.now().toString(),\n      role: \"user\",\n      content: input,\n    }\n\n    setMessages((prev) => [...prev, userMessage])\n    setInput(\"\")\n    setIsTyping(true)\n\n    // Simulate AI response\n    setTimeout(() => {\n      const aiMessage: Message = {\n        id: (Date.now() + 1).toString(),\n        role: \"assistant\",\n        content: \"这是一个模拟的 AI 回复。在实际应用中，这里会调用真实的 AI API 来生成回复。\",\n      }\n      setMessages((prev) => [...prev, aiMessage])\n      setIsTyping(false)\n    }, 1500)\n  }\n\n  if (!open) return null\n\n  return (\n    <>\n      <div className=\"fixed inset-0 z-40 bg-black/40 backdrop-blur-sm\" onClick={() => onOpenChange(false)} />\n\n      <div className=\"fixed inset-x-0 bottom-0 z-50 bg-background rounded-t-3xl shadow-2xl animate-slide-up pb-safe h-[85vh] flex flex-col\">\n        <div className=\"px-5 py-4 border-b border-border/40 flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\">\n              <Sparkles className=\"h-4 w-4 text-white\" />\n            </div>\n            <div>\n              <h2 className=\"text-lg font-semibold\">AI 助手</h2>\n              <p className=\"text-xs text-muted-foreground\">随时为你解答</p>\n            </div>\n          </div>\n          <button\n            onClick={() => onOpenChange(false)}\n            className=\"w-8 h-8 rounded-full bg-muted/50 flex items-center justify-center active:scale-95 transition-transform\"\n          >\n            <X className=\"h-4 w-4\" />\n          </button>\n        </div>\n\n        <div className=\"flex-1 overflow-y-auto px-5 py-4 space-y-4\">\n          {messages.map((message) => (\n            <div key={message.id} className={`flex ${message.role === \"user\" ? \"justify-end\" : \"justify-start\"}`}>\n              <div\n                className={`max-w-[80%] px-4 py-3 rounded-2xl ${\n                  message.role === \"user\" ? \"bg-foreground text-background\" : \"bg-muted/40 text-foreground\"\n                }`}\n              >\n                <p className=\"text-sm leading-relaxed\">{message.content}</p>\n              </div>\n            </div>\n          ))}\n          {isTyping && (\n            <div className=\"flex justify-start\">\n              <div className=\"bg-muted/40 px-4 py-3 rounded-2xl\">\n                <div className=\"flex gap-1\">\n                  <span\n                    className=\"w-2 h-2 rounded-full bg-muted-foreground/50 animate-bounce\"\n                    style={{ animationDelay: \"0ms\" }}\n                  />\n                  <span\n                    className=\"w-2 h-2 rounded-full bg-muted-foreground/50 animate-bounce\"\n                    style={{ animationDelay: \"150ms\" }}\n                  />\n                  <span\n                    className=\"w-2 h-2 rounded-full bg-muted-foreground/50 animate-bounce\"\n                    style={{ animationDelay: \"300ms\" }}\n                  />\n                </div>\n              </div>\n            </div>\n          )}\n          <div ref={messagesEndRef} />\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"px-5 py-4 border-t border-border/40\">\n          <div className=\"flex gap-2\">\n            <input\n              type=\"text\"\n              value={input}\n              onChange={(e) => setInput(e.target.value)}\n              placeholder=\"输入你的问题...\"\n              className=\"flex-1 px-4 py-3 rounded-xl border border-border/40 bg-background text-sm focus:outline-none focus:ring-2 focus:ring-foreground/20\"\n            />\n            <button\n              type=\"submit\"\n              disabled={!input.trim()}\n              className=\"w-12 h-12 rounded-xl bg-foreground text-background flex items-center justify-center active:scale-95 transition-transform disabled:opacity-40 disabled:active:scale-100\"\n            >\n              <Send className=\"h-5 w-5\" />\n            </button>\n          </div>\n        </form>\n      </div>\n    </>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4912, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\nimport { twMerge } from 'tailwind-merge'\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,kSAAO,EAAC,IAAA,4PAAI,EAAC;AACtB"}},
    {"offset": {"line": 4927, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/components/ui/avatar.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as AvatarPrimitive from '@radix-ui/react-avatar'\n\nimport { cn } from '@/lib/utils'\n\nfunction Avatar({\n  className,\n  ...props\n}: React.ComponentProps<typeof AvatarPrimitive.Root>) {\n  return (\n    <AvatarPrimitive.Root\n      data-slot=\"avatar\"\n      className={cn(\n        'relative flex size-8 shrink-0 overflow-hidden rounded-full',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AvatarImage({\n  className,\n  ...props\n}: React.ComponentProps<typeof AvatarPrimitive.Image>) {\n  return (\n    <AvatarPrimitive.Image\n      data-slot=\"avatar-image\"\n      className={cn('aspect-square size-full', className)}\n      {...props}\n    />\n  )\n}\n\nfunction AvatarFallback({\n  className,\n  ...props\n}: React.ComponentProps<typeof AvatarPrimitive.Fallback>) {\n  return (\n    <AvatarPrimitive.Fallback\n      data-slot=\"avatar-fallback\"\n      className={cn(\n        'bg-muted flex size-full items-center justify-center rounded-full',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Avatar, AvatarImage, AvatarFallback }\n"],"names":[],"mappings":";;;;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,OAAO,EACd,SAAS,EACT,GAAG,OAC+C;IAClD,qBACE,4aAAC,4bAAoB;QACnB,aAAU;QACV,WAAW,IAAA,gLAAE,EACX,8DACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,4aAAC,6bAAqB;QACpB,aAAU;QACV,WAAW,IAAA,gLAAE,EAAC,2BAA2B;QACxC,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,eAAe,EACtB,SAAS,EACT,GAAG,OACmD;IACtD,qBACE,4aAAC,gcAAwB;QACvB,aAAU;QACV,WAAW,IAAA,gLAAE,EACX,oEACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 4980, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/components/ui/dropdown-menu.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as DropdownMenuPrimitive from '@radix-ui/react-dropdown-menu'\nimport { CheckIcon, ChevronRightIcon, CircleIcon } from 'lucide-react'\n\nimport { cn } from '@/lib/utils'\n\nfunction DropdownMenu({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Root>) {\n  return <DropdownMenuPrimitive.Root data-slot=\"dropdown-menu\" {...props} />\n}\n\nfunction DropdownMenuPortal({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Portal>) {\n  return (\n    <DropdownMenuPrimitive.Portal data-slot=\"dropdown-menu-portal\" {...props} />\n  )\n}\n\nfunction DropdownMenuTrigger({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Trigger>) {\n  return (\n    <DropdownMenuPrimitive.Trigger\n      data-slot=\"dropdown-menu-trigger\"\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuContent({\n  className,\n  sideOffset = 4,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Content>) {\n  return (\n    <DropdownMenuPrimitive.Portal>\n      <DropdownMenuPrimitive.Content\n        data-slot=\"dropdown-menu-content\"\n        sideOffset={sideOffset}\n        className={cn(\n          'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md',\n          className,\n        )}\n        {...props}\n      />\n    </DropdownMenuPrimitive.Portal>\n  )\n}\n\nfunction DropdownMenuGroup({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Group>) {\n  return (\n    <DropdownMenuPrimitive.Group data-slot=\"dropdown-menu-group\" {...props} />\n  )\n}\n\nfunction DropdownMenuItem({\n  className,\n  inset,\n  variant = 'default',\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Item> & {\n  inset?: boolean\n  variant?: 'default' | 'destructive'\n}) {\n  return (\n    <DropdownMenuPrimitive.Item\n      data-slot=\"dropdown-menu-item\"\n      data-inset={inset}\n      data-variant={variant}\n      className={cn(\n        \"focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuCheckboxItem({\n  className,\n  children,\n  checked,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.CheckboxItem>) {\n  return (\n    <DropdownMenuPrimitive.CheckboxItem\n      data-slot=\"dropdown-menu-checkbox-item\"\n      className={cn(\n        \"focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className,\n      )}\n      checked={checked}\n      {...props}\n    >\n      <span className=\"pointer-events-none absolute left-2 flex size-3.5 items-center justify-center\">\n        <DropdownMenuPrimitive.ItemIndicator>\n          <CheckIcon className=\"size-4\" />\n        </DropdownMenuPrimitive.ItemIndicator>\n      </span>\n      {children}\n    </DropdownMenuPrimitive.CheckboxItem>\n  )\n}\n\nfunction DropdownMenuRadioGroup({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioGroup>) {\n  return (\n    <DropdownMenuPrimitive.RadioGroup\n      data-slot=\"dropdown-menu-radio-group\"\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuRadioItem({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioItem>) {\n  return (\n    <DropdownMenuPrimitive.RadioItem\n      data-slot=\"dropdown-menu-radio-item\"\n      className={cn(\n        \"focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className,\n      )}\n      {...props}\n    >\n      <span className=\"pointer-events-none absolute left-2 flex size-3.5 items-center justify-center\">\n        <DropdownMenuPrimitive.ItemIndicator>\n          <CircleIcon className=\"size-2 fill-current\" />\n        </DropdownMenuPrimitive.ItemIndicator>\n      </span>\n      {children}\n    </DropdownMenuPrimitive.RadioItem>\n  )\n}\n\nfunction DropdownMenuLabel({\n  className,\n  inset,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Label> & {\n  inset?: boolean\n}) {\n  return (\n    <DropdownMenuPrimitive.Label\n      data-slot=\"dropdown-menu-label\"\n      data-inset={inset}\n      className={cn(\n        'px-2 py-1.5 text-sm font-medium data-[inset]:pl-8',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Separator>) {\n  return (\n    <DropdownMenuPrimitive.Separator\n      data-slot=\"dropdown-menu-separator\"\n      className={cn('bg-border -mx-1 my-1 h-px', className)}\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuShortcut({\n  className,\n  ...props\n}: React.ComponentProps<'span'>) {\n  return (\n    <span\n      data-slot=\"dropdown-menu-shortcut\"\n      className={cn(\n        'text-muted-foreground ml-auto text-xs tracking-widest',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuSub({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Sub>) {\n  return <DropdownMenuPrimitive.Sub data-slot=\"dropdown-menu-sub\" {...props} />\n}\n\nfunction DropdownMenuSubTrigger({\n  className,\n  inset,\n  children,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.SubTrigger> & {\n  inset?: boolean\n}) {\n  return (\n    <DropdownMenuPrimitive.SubTrigger\n      data-slot=\"dropdown-menu-sub-trigger\"\n      data-inset={inset}\n      className={cn(\n        \"focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className,\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronRightIcon className=\"ml-auto size-4\" />\n    </DropdownMenuPrimitive.SubTrigger>\n  )\n}\n\nfunction DropdownMenuSubContent({\n  className,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.SubContent>) {\n  return (\n    <DropdownMenuPrimitive.SubContent\n      data-slot=\"dropdown-menu-sub-content\"\n      className={cn(\n        'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  DropdownMenu,\n  DropdownMenuPortal,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuGroup,\n  DropdownMenuLabel,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioGroup,\n  DropdownMenuRadioItem,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuSub,\n  DropdownMenuSubTrigger,\n  DropdownMenuSubContent,\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5255, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/components/layout/calendar-header.tsx"],"sourcesContent":["\"use client\"\n\nimport { useRouter } from \"next/navigation\"\nimport { useAuth } from \"@/lib/auth-context\"\nimport { Calendar, CalendarDays, CalendarRange, User, LogOut } from \"lucide-react\"\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\"\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\"\n\ntype ViewType = \"day\" | \"week\" | \"month\"\n\ninterface CalendarHeaderProps {\n  view: ViewType\n  selectedDate: Date\n  onViewChange: (view: ViewType) => void\n  onLogout: () => void\n}\n\nexport function CalendarHeader({ view, selectedDate, onViewChange, onLogout }: CalendarHeaderProps) {\n  const router = useRouter()\n  const { user, isAuthenticated } = useAuth()\n\n  return (\n    <header className=\"sticky top-0 z-30 border-b border-border/40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/80\">\n      <div className=\"px-4 py-4 flex items-center justify-between gap-3\">\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center gap-2\">\n            <h1 className=\"text-lg font-bold tracking-tight text-foreground leading-tight\">\n              {view === \"day\" && selectedDate.toLocaleDateString(\"zh-CN\", { month: \"long\", day: \"numeric\" })}\n              {view === \"week\" && \"本周\"}\n              {view === \"month\" && selectedDate.toLocaleDateString(\"zh-CN\", { year: \"numeric\", month: \"long\" })}\n            </h1>\n            {view === \"day\" && <span className=\"text-base\">☀️</span>}\n          </div>\n          {view === \"day\" && (\n            <p className=\"text-xs text-muted-foreground mt-0.5 font-handwriting\">\n              {selectedDate.toLocaleDateString(\"zh-CN\", { weekday: \"long\" })}\n            </p>\n          )}\n        </div>\n\n        <div className=\"flex items-center gap-2\">\n          {isAuthenticated ? (\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n                <button className=\"flex items-center gap-2 rounded-full focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\">\n                  <Avatar className=\"h-8 w-8\">\n                    <AvatarFallback className=\"bg-primary/10 text-primary text-sm\">\n                      {user?.username?.charAt(0).toUpperCase() || \"U\"}\n                    </AvatarFallback>\n                  </Avatar>\n                </button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent align=\"end\" className=\"w-48\">\n                <DropdownMenuLabel>\n                  <div className=\"flex flex-col\">\n                    <span className=\"font-medium\">{user?.username}</span>\n                    {user?.email && <span className=\"text-xs text-muted-foreground\">{user.email}</span>}\n                  </div>\n                </DropdownMenuLabel>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem onClick={() => router.push(\"/profile\")}>\n                  <User className=\"h-4 w-4\" />\n                  <span>个人信息</span>\n                </DropdownMenuItem>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem onClick={onLogout} variant=\"destructive\">\n                  <LogOut className=\"h-4 w-4\" />\n                  <span>登出</span>\n                </DropdownMenuItem>\n              </DropdownMenuContent>\n            </DropdownMenu>\n          ) : (\n            <button\n              onClick={() => router.push(\"/login\")}\n              className=\"text-sm text-muted-foreground hover:text-foreground px-3 py-1.5 rounded-md hover:bg-muted/50 transition-colors\"\n            >\n              登录\n            </button>\n          )}\n\n          <div className=\"flex gap-1 bg-muted/40 rounded-lg p-1\">\n            <button\n              onClick={() => onViewChange(\"day\")}\n              className={`flex items-center justify-center px-3 py-2 rounded-md text-xs font-medium transition-all active:scale-95 ${\n                view === \"day\" ? \"bg-background text-foreground shadow-sm\" : \"text-muted-foreground\"\n              }`}\n            >\n              <Calendar className=\"h-4 w-4\" />\n            </button>\n            <button\n              onClick={() => onViewChange(\"week\")}\n              className={`flex items-center justify-center px-3 py-2 rounded-md text-xs font-medium transition-all active:scale-95 ${\n                view === \"week\" ? \"bg-background text-foreground shadow-sm\" : \"text-muted-foreground\"\n              }`}\n            >\n              <CalendarDays className=\"h-4 w-4\" />\n            </button>\n            <button\n              onClick={() => onViewChange(\"month\")}\n              className={`flex items-center justify-center px-3 py-2 rounded-md text-xs font-medium transition-all active:scale-95 ${\n                view === \"month\" ? \"bg-background text-foreground shadow-sm\" : \"text-muted-foreground\"\n              }`}\n            >\n              <CalendarRange className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n      </div>\n    </header>\n  )\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AANA;;;;;;;AAwBO,SAAS,eAAe,EAAE,IAAI,EAAE,YAAY,EAAE,YAAY,EAAE,QAAQ,EAAuB;IAChG,MAAM,SAAS,IAAA,6UAAS;IACxB,MAAM,EAAE,IAAI,EAAE,eAAe,EAAE,GAAG,IAAA,gMAAO;IAEzC,qBACE,4aAAC;QAAO,WAAU;kBAChB,cAAA,4aAAC;YAAI,WAAU;;8BACb,4aAAC;oBAAI,WAAU;;sCACb,4aAAC;4BAAI,WAAU;;8CACb,4aAAC;oCAAG,WAAU;;wCACX,SAAS,SAAS,aAAa,kBAAkB,CAAC,SAAS;4CAAE,OAAO;4CAAQ,KAAK;wCAAU;wCAC3F,SAAS,UAAU;wCACnB,SAAS,WAAW,aAAa,kBAAkB,CAAC,SAAS;4CAAE,MAAM;4CAAW,OAAO;wCAAO;;;;;;;gCAEhG,SAAS,uBAAS,4aAAC;oCAAK,WAAU;8CAAY;;;;;;;;;;;;wBAEhD,SAAS,uBACR,4aAAC;4BAAE,WAAU;sCACV,aAAa,kBAAkB,CAAC,SAAS;gCAAE,SAAS;4BAAO;;;;;;;;;;;;8BAKlE,4aAAC;oBAAI,WAAU;;wBACZ,gCACC,4aAAC,mNAAY;;8CACX,4aAAC,0NAAmB;oCAAC,OAAO;8CAC1B,cAAA,4aAAC;wCAAO,WAAU;kDAChB,cAAA,4aAAC,mMAAM;4CAAC,WAAU;sDAChB,cAAA,4aAAC,2MAAc;gDAAC,WAAU;0DACvB,MAAM,UAAU,OAAO,GAAG,iBAAiB;;;;;;;;;;;;;;;;;;;;;8CAKpD,4aAAC,0NAAmB;oCAAC,OAAM;oCAAM,WAAU;;sDACzC,4aAAC,wNAAiB;sDAChB,cAAA,4aAAC;gDAAI,WAAU;;kEACb,4aAAC;wDAAK,WAAU;kEAAe,MAAM;;;;;;oDACpC,MAAM,uBAAS,4aAAC;wDAAK,WAAU;kEAAiC,KAAK,KAAK;;;;;;;;;;;;;;;;;sDAG/E,4aAAC,4NAAqB;;;;;sDACtB,4aAAC,uNAAgB;4CAAC,SAAS,IAAM,OAAO,IAAI,CAAC;;8DAC3C,4aAAC,4VAAI;oDAAC,WAAU;;;;;;8DAChB,4aAAC;8DAAK;;;;;;;;;;;;sDAER,4aAAC,4NAAqB;;;;;sDACtB,4aAAC,uNAAgB;4CAAC,SAAS;4CAAU,SAAQ;;8DAC3C,4aAAC,sWAAM;oDAAC,WAAU;;;;;;8DAClB,4aAAC;8DAAK;;;;;;;;;;;;;;;;;;;;;;;iDAKZ,4aAAC;4BACC,SAAS,IAAM,OAAO,IAAI,CAAC;4BAC3B,WAAU;sCACX;;;;;;sCAKH,4aAAC;4BAAI,WAAU;;8CACb,4aAAC;oCACC,SAAS,IAAM,aAAa;oCAC5B,WAAW,CAAC,yGAAyG,EACnH,SAAS,QAAQ,4CAA4C,yBAC7D;8CAEF,cAAA,4aAAC,wWAAQ;wCAAC,WAAU;;;;;;;;;;;8CAEtB,4aAAC;oCACC,SAAS,IAAM,aAAa;oCAC5B,WAAW,CAAC,yGAAyG,EACnH,SAAS,SAAS,4CAA4C,yBAC9D;8CAEF,cAAA,4aAAC,wXAAY;wCAAC,WAAU;;;;;;;;;;;8CAE1B,4aAAC;oCACC,SAAS,IAAM,aAAa;oCAC5B,WAAW,CAAC,yGAAyG,EACnH,SAAS,UAAU,4CAA4C,yBAC/D;8CAEF,cAAA,4aAAC,2XAAa;wCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOvC"}},
    {"offset": {"line": 5560, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/components/layout/floating-action-buttons.tsx"],"sourcesContent":["\"use client\"\n\nimport { Plus, Sparkles, BarChart3 } from \"lucide-react\"\n\ninterface FloatingActionButtonsProps {\n  onAddTask: () => void\n  onShowStatistics: () => void\n  onShowAIChat: () => void\n}\n\nexport function FloatingActionButtons({ onAddTask, onShowStatistics, onShowAIChat }: FloatingActionButtonsProps) {\n  return (\n    <div className=\"fixed bottom-6 right-6 z-20 flex flex-col gap-3\">\n      <button\n        onClick={onShowStatistics}\n        className=\"w-12 h-12 rounded-full bg-gradient-to-br from-amber-500 to-orange-500 text-white shadow-lg flex items-center justify-center active:scale-95 transition-transform hover:shadow-xl\"\n      >\n        <BarChart3 className=\"h-5 w-5\" />\n      </button>\n      <button\n        onClick={onShowAIChat}\n        className=\"w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 text-white shadow-lg flex items-center justify-center active:scale-95 transition-transform hover:shadow-xl\"\n      >\n        <Sparkles className=\"h-5 w-5\" />\n      </button>\n      <button\n        onClick={onAddTask}\n        className=\"w-14 h-14 rounded-full bg-foreground text-background shadow-lg flex items-center justify-center active:scale-95 transition-transform hover:shadow-xl\"\n      >\n        <Plus className=\"h-6 w-6\" />\n      </button>\n    </div>\n  )\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAFA;;;AAUO,SAAS,sBAAsB,EAAE,SAAS,EAAE,gBAAgB,EAAE,YAAY,EAA8B;IAC7G,qBACE,4aAAC;QAAI,WAAU;;0BACb,4aAAC;gBACC,SAAS;gBACT,WAAU;0BAEV,cAAA,4aAAC,iXAAS;oBAAC,WAAU;;;;;;;;;;;0BAEvB,4aAAC;gBACC,SAAS;gBACT,WAAU;0BAEV,cAAA,4aAAC,wWAAQ;oBAAC,WAAU;;;;;;;;;;;0BAEtB,4aAAC;gBACC,SAAS;gBACT,WAAU;0BAEV,cAAA,4aAAC,4VAAI;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAIxB"}},
    {"offset": {"line": 5631, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/hooks/use-todos.ts"],"sourcesContent":["\"use client\"\n\nimport { useState, useCallback, useEffect } from \"react\"\nimport { apiClient } from \"@/lib/api-client\"\nimport { transformTodoResponse, transformTaskToRequest } from \"@/lib/data-transform\"\nimport type { Task, TodoResponse } from \"@/types/task\"\nimport { toast } from \"@/hooks/use-toast\"\n\ninterface UseTodosOptions {\n  autoLoad?: boolean\n  startDate?: string\n  endDate?: string\n  status?: \"pending\" | \"completed\"\n}\n\nexport function useTodos(options: UseTodosOptions = {}) {\n  const { autoLoad = false, startDate, endDate, status } = options\n  const [todos, setTodos] = useState<Task[]>([])\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState<Error | null>(null)\n\n  const loadTodos = useCallback(async () => {\n    setLoading(true)\n    setError(null)\n    try {\n      const response = await apiClient.getTodos({ startDate, endDate, status })\n      const transformedTodos = response.data.map(transformTodoResponse)\n      setTodos(transformedTodos)\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"加载任务失败\")\n      setError(error)\n      toast({\n        title: \"加载失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoading(false)\n    }\n  }, [startDate, endDate, status])\n\n  useEffect(() => {\n    if (autoLoad) {\n      loadTodos()\n    }\n  }, [autoLoad, loadTodos])\n\n  const createTodo = useCallback(\n    async (task: Omit<Task, \"id\">) => {\n      try {\n        const request = transformTaskToRequest(task)\n        const response = await apiClient.createTodo(request)\n        const newTodo = transformTodoResponse(response.data)\n        setTodos((prev) => [...prev, newTodo])\n        toast({\n          title: \"创建成功\",\n          description: `任务「${newTodo.title}」已创建`,\n        })\n        return newTodo\n      } catch (err) {\n        const error = err instanceof Error ? err : new Error(\"创建任务失败\")\n        toast({\n          title: \"创建失败\",\n          description: error.message,\n          variant: \"destructive\",\n        })\n        throw error\n      }\n    },\n    []\n  )\n\n  const updateTodo = useCallback(async (id: string, task: Partial<Task>) => {\n    try {\n      const request = transformTaskToRequest(task as Omit<Task, \"id\">)\n      const response = await apiClient.updateTodo(id, request)\n      const updatedTodo = transformTodoResponse(response.data)\n      setTodos((prev) => prev.map((t) => (t.id === id ? updatedTodo : t)))\n      toast({\n        title: \"更新成功\",\n        description: `任务「${updatedTodo.title}」已更新`,\n      })\n      return updatedTodo\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"更新任务失败\")\n      toast({\n        title: \"更新失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n      throw error\n    }\n  }, [])\n\n  const deleteTodo = useCallback(async (id: string) => {\n    try {\n      await apiClient.deleteTodo(id)\n      setTodos((prev) => prev.filter((t) => t.id !== id))\n      toast({\n        title: \"删除成功\",\n        description: \"任务已删除\",\n      })\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"删除任务失败\")\n      toast({\n        title: \"删除失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n      throw error\n    }\n  }, [])\n\n  const completeTodo = useCallback(async (id: string) => {\n    try {\n      const response = await apiClient.completeTodo(id)\n      const updatedTodo = transformTodoResponse(response.data)\n      setTodos((prev) => prev.map((t) => (t.id === id ? updatedTodo : t)))\n      toast({\n        title: \"完成\",\n        description: `任务「${updatedTodo.title}」已完成`,\n      })\n      return updatedTodo\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"标记完成失败\")\n      toast({\n        title: \"操作失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n      throw error\n    }\n  }, [])\n\n  return {\n    todos,\n    loading,\n    error,\n    createTodo,\n    updateTodo,\n    deleteTodo,\n    completeTodo,\n    refresh: loadTodos,\n  }\n}\n\nexport function useTodo(id: string | null) {\n  const [todo, setTodo] = useState<Task | null>(null)\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState<Error | null>(null)\n\n  const loadTodo = useCallback(async () => {\n    if (!id) {\n      setTodo(null)\n      return\n    }\n\n    setLoading(true)\n    setError(null)\n    try {\n      const response = await apiClient.getTodoById(id)\n      const transformedTodo = transformTodoResponse(response.data)\n      setTodo(transformedTodo)\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"加载任务失败\")\n      setError(error)\n      toast({\n        title: \"加载失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoading(false)\n    }\n  }, [id])\n\n  useEffect(() => {\n    loadTodo()\n  }, [loadTodo])\n\n  const update = useCallback(\n    async (updates: Partial<Task>) => {\n      if (!id) return\n      try {\n        const request = transformTaskToRequest(updates as Omit<Task, \"id\">)\n        const response = await apiClient.updateTodo(id, request)\n        const updatedTodo = transformTodoResponse(response.data)\n        setTodo(updatedTodo)\n        toast({\n          title: \"更新成功\",\n          description: `任务「${updatedTodo.title}」已更新`,\n        })\n        return updatedTodo\n      } catch (err) {\n        const error = err instanceof Error ? err : new Error(\"更新任务失败\")\n        toast({\n          title: \"更新失败\",\n          description: error.message,\n          variant: \"destructive\",\n        })\n        throw error\n      }\n    },\n    [id]\n  )\n\n  return {\n    todo,\n    loading,\n    error,\n    update,\n    refresh: loadTodo,\n  }\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5850, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/hooks/use-categories.ts"],"sourcesContent":["\"use client\"\n\nimport { useState, useCallback, useEffect } from \"react\"\nimport { apiClient } from \"@/lib/api-client\"\nimport { transformTypeResponse } from \"@/lib/data-transform\"\nimport type { TaskCategory, TodoTypeResponse } from \"@/types/task\"\nimport { toast } from \"@/hooks/use-toast\"\n\nexport function useCategories() {\n  const [categories, setCategories] = useState<TaskCategory[]>([])\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState<Error | null>(null)\n\n  const loadCategories = useCallback(async () => {\n    setLoading(true)\n    setError(null)\n    try {\n      const response = await apiClient.getTypes()\n      const transformedCategories = response.data.map(transformTypeResponse)\n      setCategories(transformedCategories)\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"加载分类失败\")\n      setError(error)\n      toast({\n        title: \"加载失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoading(false)\n    }\n  }, [])\n\n  useEffect(() => {\n    loadCategories()\n  }, [loadCategories])\n\n  const createCategory = useCallback(async (category: Omit<TaskCategory, \"id\">) => {\n    try {\n      const response = await apiClient.createType({\n        typeName: category.name,\n        icon: category.icon,\n        color: category.color,\n      })\n      const newCategory = transformTypeResponse(response.data)\n      setCategories((prev) => [...prev, newCategory])\n      toast({\n        title: \"创建成功\",\n        description: `分类「${newCategory.name}」已创建`,\n      })\n      return newCategory\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"创建分类失败\")\n      toast({\n        title: \"创建失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n      throw error\n    }\n  }, [])\n\n  const updateCategory = useCallback(async (id: string, category: Partial<TaskCategory>) => {\n    try {\n      const response = await apiClient.updateType(id, {\n        typeName: category.name || \"\",\n        icon: category.icon || \"\",\n        color: category.color,\n      })\n      const updatedCategory = transformTypeResponse(response.data)\n      setCategories((prev) => prev.map((c) => (c.id === id ? updatedCategory : c)))\n      toast({\n        title: \"更新成功\",\n        description: `分类「${updatedCategory.name}」已更新`,\n      })\n      return updatedCategory\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"更新分类失败\")\n      toast({\n        title: \"更新失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n      throw error\n    }\n  }, [])\n\n  const deleteCategory = useCallback(async (id: string) => {\n    try {\n      await apiClient.deleteType(id)\n      setCategories((prev) => prev.filter((c) => c.id !== id))\n      toast({\n        title: \"删除成功\",\n        description: \"分类已删除\",\n      })\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"删除分类失败\")\n      toast({\n        title: \"删除失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n      throw error\n    }\n  }, [])\n\n  return {\n    categories,\n    loading,\n    error,\n    createCategory,\n    updateCategory,\n    deleteCategory,\n    refresh: loadCategories,\n  }\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5974, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/hooks/use-calendar.ts"],"sourcesContent":["\"use client\"\n\nimport { useState, useCallback, useEffect } from \"react\"\nimport { apiClient } from \"@/lib/api-client\"\nimport { transformTodoResponse } from \"@/lib/data-transform\"\nimport type { Task, CalendarDayResponse } from \"@/types/task\"\nimport { toast } from \"@/hooks/use-toast\"\n\ntype ViewType = \"day\" | \"week\" | \"month\"\n\ninterface UseCalendarViewOptions {\n  autoLoad?: boolean\n}\n\n// 格式化日期为本地日期字符串（避免时区问题）\nfunction formatDateLocal(date: Date): string {\n  const year = date.getFullYear()\n  const month = String(date.getMonth() + 1).padStart(2, \"0\")\n  const day = String(date.getDate()).padStart(2, \"0\")\n  return `${year}-${month}-${day}`\n}\n\nexport function useCalendarView(view: ViewType, date: Date, options: UseCalendarViewOptions = {}) {\n  const { autoLoad = true } = options\n  const [data, setData] = useState<{\n    tasks?: Task[]\n    monthData?: CalendarDayResponse[]\n  }>({})\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState<Error | null>(null)\n\n  const loadData = useCallback(async () => {\n    setLoading(true)\n    setError(null)\n    try {\n      if (view === \"day\") {\n        const dateStr = formatDateLocal(date)\n        const response = await apiClient.getDayView(dateStr)\n        const tasks = response.data.map(transformTodoResponse)\n        setData({ tasks })\n      } else if (view === \"week\") {\n        // 计算周的开始日期（周一）\n        const dayOfWeek = date.getDay()\n        const monday = new Date(date)\n        monday.setDate(date.getDate() - (dayOfWeek === 0 ? 6 : dayOfWeek - 1))\n        const weekStartDate = formatDateLocal(monday)\n        const response = await apiClient.getWeekView(weekStartDate)\n        const tasks = response.data.map(transformTodoResponse)\n        setData({ tasks })\n      } else if (view === \"month\") {\n        const yearMonth = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, \"0\")}`\n        const response = await apiClient.getMonthView(yearMonth)\n        setData({ monthData: response.data })\n      }\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"加载日历数据失败\")\n      setError(error)\n      toast({\n        title: \"加载失败\",\n        description: error.message,\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoading(false)\n    }\n  }, [view, date])\n\n  useEffect(() => {\n    if (autoLoad) {\n      loadData()\n    }\n  }, [autoLoad, loadData])\n\n  return {\n    data,\n    loading,\n    error,\n    refresh: loadData,\n  }\n}\n\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAEA;AANA;;;;;AAcA,wBAAwB;AACxB,SAAS,gBAAgB,IAAU;IACjC,MAAM,OAAO,KAAK,WAAW;IAC7B,MAAM,QAAQ,OAAO,KAAK,QAAQ,KAAK,GAAG,QAAQ,CAAC,GAAG;IACtD,MAAM,MAAM,OAAO,KAAK,OAAO,IAAI,QAAQ,CAAC,GAAG;IAC/C,OAAO,GAAG,KAAK,CAAC,EAAE,MAAM,CAAC,EAAE,KAAK;AAClC;AAEO,SAAS,gBAAgB,IAAc,EAAE,IAAU,EAAE,UAAkC,CAAC,CAAC;IAC9F,MAAM,EAAE,WAAW,IAAI,EAAE,GAAG;IAC5B,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,+YAAQ,EAG7B,CAAC;IACJ,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+YAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+YAAQ,EAAe;IAEjD,MAAM,WAAW,IAAA,kZAAW,EAAC;QAC3B,WAAW;QACX,SAAS;QACT,IAAI;YACF,IAAI,SAAS,OAAO;gBAClB,MAAM,UAAU,gBAAgB;gBAChC,MAAM,WAAW,MAAM,+LAAS,CAAC,UAAU,CAAC;gBAC5C,MAAM,QAAQ,SAAS,IAAI,CAAC,GAAG,CAAC,+MAAqB;gBACrD,QAAQ;oBAAE;gBAAM;YAClB,OAAO,IAAI,SAAS,QAAQ;gBAC1B,eAAe;gBACf,MAAM,YAAY,KAAK,MAAM;gBAC7B,MAAM,SAAS,IAAI,KAAK;gBACxB,OAAO,OAAO,CAAC,KAAK,OAAO,KAAK,CAAC,cAAc,IAAI,IAAI,YAAY,CAAC;gBACpE,MAAM,gBAAgB,gBAAgB;gBACtC,MAAM,WAAW,MAAM,+LAAS,CAAC,WAAW,CAAC;gBAC7C,MAAM,QAAQ,SAAS,IAAI,CAAC,GAAG,CAAC,+MAAqB;gBACrD,QAAQ;oBAAE;gBAAM;YAClB,OAAO,IAAI,SAAS,SAAS;gBAC3B,MAAM,YAAY,GAAG,KAAK,WAAW,GAAG,CAAC,EAAE,OAAO,KAAK,QAAQ,KAAK,GAAG,QAAQ,CAAC,GAAG,MAAM;gBACzF,MAAM,WAAW,MAAM,+LAAS,CAAC,YAAY,CAAC;gBAC9C,QAAQ;oBAAE,WAAW,SAAS,IAAI;gBAAC;YACrC;QACF,EAAE,OAAO,KAAK;YACZ,MAAM,QAAQ,eAAe,QAAQ,MAAM,IAAI,MAAM;YACrD,SAAS;YACT,IAAA,4LAAK,EAAC;gBACJ,OAAO;gBACP,aAAa,MAAM,OAAO;gBAC1B,SAAS;YACX;QACF,SAAU;YACR,WAAW;QACb;IACF,GAAG;QAAC;QAAM;KAAK;IAEf,IAAA,gZAAS,EAAC;QACR,IAAI,UAAU;YACZ;QACF;IACF,GAAG;QAAC;QAAU;KAAS;IAEvB,OAAO;QACL;QACA;QACA;QACA,SAAS;IACX;AACF"}},
    {"offset": {"line": 6062, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/app/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect, useMemo } from \"react\"\nimport { useSearchParams } from \"next/navigation\"\nimport { DayView } from \"@/components/day-view\"\nimport { WeekView } from \"@/components/week-view\"\nimport { MonthView } from \"@/components/month-view\"\nimport { TaskDetailSheet } from \"@/components/task-detail-sheet\"\nimport { AddTaskSheet } from \"@/components/add-task-sheet\"\nimport { TemplateManager } from \"@/components/template-manager\"\nimport { CategoryManager } from \"@/components/category-manager\"\nimport { StatisticsView } from \"@/components/statistics-view\"\nimport { AIChat } from \"@/components/ai-chat\"\nimport { CalendarHeader } from \"@/components/layout/calendar-header\"\nimport { FloatingActionButtons } from \"@/components/layout/floating-action-buttons\"\nimport { useAuth } from \"@/lib/auth-context\"\nimport { useTodos } from \"@/hooks/use-todos\"\nimport { useTemplates } from \"@/hooks/use-templates\"\nimport { useCategories } from \"@/hooks/use-categories\"\nimport { useCalendarView } from \"@/hooks/use-calendar\"\nimport type { Task } from \"@/types/task\"\n\ntype ViewType = \"day\" | \"week\" | \"month\"\n\nexport default function CalendarPage() {\n  const { logout } = useAuth()\n  const searchParams = useSearchParams()\n  const [view, setView] = useState<ViewType>(\"day\")\n  \n  // 从 URL 参数读取日期，如果没有则使用当前日期\n  const initialDate = useMemo(() => {\n    const dateParam = searchParams.get(\"date\")\n    if (dateParam) {\n      const parsedDate = new Date(dateParam)\n      if (!isNaN(parsedDate.getTime())) {\n        return parsedDate\n      }\n    }\n    return new Date()\n  }, [searchParams])\n  \n  const [selectedDate, setSelectedDate] = useState(initialDate)\n  \n  // 当 URL 参数变化时更新日期\n  useEffect(() => {\n    const dateParam = searchParams.get(\"date\")\n    if (dateParam) {\n      const parsedDate = new Date(dateParam)\n      if (!isNaN(parsedDate.getTime())) {\n        setSelectedDate(parsedDate)\n      }\n    }\n  }, [searchParams])\n  const [selectedTask, setSelectedTask] = useState<Task | null>(null)\n  const [sheetOpen, setSheetOpen] = useState(false)\n  const [addSheetOpen, setAddSheetOpen] = useState(false)\n  const [templateManagerOpen, setTemplateManagerOpen] = useState(false)\n  const [categoryManagerOpen, setCategoryManagerOpen] = useState(false)\n  const [statisticsOpen, setStatisticsOpen] = useState(false)\n  const [aiChatOpen, setAIChatOpen] = useState(false)\n  const [consecutiveCount, setConsecutiveCount] = useState(0)\n\n  // 使用 hooks 管理数据\n  const { templates, refresh: refreshTemplates } = useTemplates()\n  const { categories, createCategory, deleteCategory, refresh: refreshCategories } = useCategories()\n  const calendarData = useCalendarView(view, selectedDate)\n  const { createTodo, completeTodo } = useTodos({ autoLoad: false })\n\n  // 根据视图获取任务列表\n  const tasks = useMemo(() => {\n    if (view === \"day\" || view === \"week\") {\n      return calendarData.data.tasks || []\n    }\n    return []\n  }, [view, calendarData.data])\n\n  const handleLogout = async () => {\n    await logout()\n  }\n\n  const handleTaskClick = (task: Task) => {\n    setSelectedTask(task)\n    setSheetOpen(true)\n  }\n\n  const handleTaskComplete = async (taskId: string) => {\n    try {\n      const task = tasks.find((t) => t.id === taskId)\n      if (task && !task.completed) {\n        await completeTodo(taskId)\n        const newCount = consecutiveCount + 1\n        setConsecutiveCount(newCount)\n\n        if (newCount === 3) {\n          setTimeout(() => {\n            const event = new CustomEvent(\"show-toast\", {\n              detail: { message: \"三连完成！效率满分！\", type: \"achievement\" },\n            })\n            window.dispatchEvent(event)\n            setConsecutiveCount(0)\n          }, 500)\n        }\n      } else {\n        setConsecutiveCount(0)\n      }\n      // 刷新日历数据\n      calendarData.refresh()\n      setSheetOpen(false)\n    } catch (error) {\n      console.error(\"完成任务失败:\", error)\n    }\n  }\n\n  const handleDateSelect = (date: Date) => {\n    setSelectedDate(date)\n    setView(\"day\")\n  }\n\n  const handleMonthChange = (date: Date) => {\n    setSelectedDate(date)\n  }\n\n  const handleAddTask = async (newTask: Omit<Task, \"id\">) => {\n    try {\n      await createTodo(newTask)\n      // 刷新日历数据\n      calendarData.refresh()\n      setAddSheetOpen(false)\n    } catch (error) {\n      console.error(\"添加任务失败:\", error)\n    }\n  }\n\n  // 视图切换时刷新数据\n  useEffect(() => {\n    calendarData.refresh()\n  }, [view, selectedDate])\n\n  // 打开添加待办表单时刷新分类和模板数据，确保数据是最新的\n  useEffect(() => {\n    if (addSheetOpen) {\n      refreshCategories()\n      refreshTemplates()\n    }\n  }, [addSheetOpen, refreshCategories, refreshTemplates])\n\n  return (\n    <div className=\"min-h-screen bg-background pb-safe\">\n      <CalendarHeader view={view} selectedDate={selectedDate} onViewChange={setView} onLogout={handleLogout} />\n\n      <main className=\"px-4 py-5\">\n        {calendarData.loading ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <div className=\"text-muted-foreground\">加载中...</div>\n          </div>\n        ) : (\n          <>\n            {view === \"day\" && <DayView tasks={tasks} selectedDate={selectedDate} onTaskClick={handleTaskClick} />}\n            {view === \"week\" && <WeekView tasks={tasks} selectedDate={selectedDate} onTaskClick={handleTaskClick} />}\n            {view === \"month\" && (\n              <MonthView\n                tasks={tasks}\n                monthData={calendarData.data.monthData}\n                selectedDate={selectedDate}\n                onDateClick={handleDateSelect}\n                onMonthChange={handleMonthChange}\n                categories={categories}\n              />\n            )}\n          </>\n        )}\n      </main>\n\n      <FloatingActionButtons\n        onAddTask={() => setAddSheetOpen(true)}\n        onShowStatistics={() => setStatisticsOpen(true)}\n        onShowAIChat={() => setAIChatOpen(true)}\n      />\n\n      <TaskDetailSheet\n        task={selectedTask}\n        open={sheetOpen}\n        onOpenChange={setSheetOpen}\n        onComplete={handleTaskComplete}\n      />\n\n      <AddTaskSheet\n        open={addSheetOpen}\n        onOpenChange={setAddSheetOpen}\n        onAdd={handleAddTask}\n        selectedDate={selectedDate}\n        currentView={view}\n        templates={templates}\n        categories={categories}\n        onManageTemplates={() => {\n          setAddSheetOpen(false)\n          setTemplateManagerOpen(true)\n        }}\n        onManageCategories={() => {\n          setAddSheetOpen(false)\n          setCategoryManagerOpen(true)\n        }}\n      />\n\n      <TemplateManager\n        open={templateManagerOpen}\n        onOpenChange={setTemplateManagerOpen}\n        templates={templates}\n        categories={categories}\n        onSave={refreshTemplates}\n      />\n\n      <CategoryManager\n        open={categoryManagerOpen}\n        onOpenChange={setCategoryManagerOpen}\n        categories={categories}\n        onCreateCategory={createCategory}\n        onDeleteCategory={deleteCategory}\n        onSave={refreshCategories}\n      />\n\n      <StatisticsView open={statisticsOpen} onOpenChange={setStatisticsOpen} />\n\n      <AIChat open={aiChatOpen} onOpenChange={setAIChatOpen} />\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}