{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/lib/config.ts"],"sourcesContent":["// 项目配置文件\nexport const config = {\n  // 后端 API 基础 URL（用于 Next.js API 代理）\n  backendApiBaseUrl: \"http://localhost:6158/api\",\n  // 前端 API 基础 URL（通过 Next.js API 路由代理）\n  // 在浏览器中使用相对路径，避免 CORS 问题\n  apiBaseUrl: typeof window !== \"undefined\" ? \"/api/proxy\" : \"http://localhost:6158/api\",\n} as const\n\n"],"names":[],"mappings":"AAAA,SAAS;;;;;AACF,MAAM,SAAS;IACpB,mCAAmC;IACnC,mBAAmB;IACnB,qCAAqC;IACrC,yBAAyB;IACzB,YAAY,sCAAgC,0BAAe;AAC7D"}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["file:///Users/jeyyu/Desktop/web/calendar-design-and-interaction/app/api/proxy/%5B...path%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\nimport { config } from \"@/lib/config\"\n\nexport async function GET(\n  request: NextRequest,\n  { params }: { params: Promise<{ path: string[] }> }\n) {\n  const { path } = await params\n  return proxyRequest(request, path, \"GET\")\n}\n\nexport async function POST(\n  request: NextRequest,\n  { params }: { params: Promise<{ path: string[] }> }\n) {\n  const { path } = await params\n  return proxyRequest(request, path, \"POST\")\n}\n\nexport async function PUT(\n  request: NextRequest,\n  { params }: { params: Promise<{ path: string[] }> }\n) {\n  const { path } = await params\n  return proxyRequest(request, path, \"PUT\")\n}\n\nexport async function DELETE(\n  request: NextRequest,\n  { params }: { params: Promise<{ path: string[] }> }\n) {\n  const { path } = await params\n  return proxyRequest(request, path, \"DELETE\")\n}\n\nasync function proxyRequest(\n  request: NextRequest,\n  path: string[],\n  method: string\n) {\n  try {\n    const pathString = path.join(\"/\")\n    // 获取查询参数\n    const searchParams = request.nextUrl.searchParams.toString()\n    // 构建完整的 URL，包含查询参数\n    const url = `${config.backendApiBaseUrl}/${pathString}${searchParams ? `?${searchParams}` : \"\"}`\n    \n    console.log(`[Proxy] ${method} ${url}`)\n    \n    // 检查是否是文件上传请求\n    const contentType = request.headers.get(\"content-type\") || \"\"\n    const isFileUpload = contentType.includes(\"multipart/form-data\")\n    \n    // 获取请求体\n    let body: BodyInit | undefined\n    if (method !== \"GET\" && method !== \"DELETE\") {\n      if (isFileUpload) {\n        // 文件上传：直接使用 FormData\n        body = await request.formData()\n      } else {\n        // JSON 请求：转换为文本\n        body = await request.text()\n        console.log(`[Proxy] Request body:`, body)\n      }\n    }\n\n    // 构建 headers\n    const headers: Record<string, string> = {}\n    \n    // 如果不是文件上传，设置 Content-Type\n    if (!isFileUpload && body) {\n      headers[\"Content-Type\"] = \"application/json\"\n    }\n    // 文件上传时不设置 Content-Type，让浏览器自动设置（包含 boundary）\n    \n    // 转发 BARCKE-TOKEN header（如果存在）\n    const token = request.headers.get(\"BARCKE-TOKEN\")\n    if (token) {\n      headers[\"BARCKE-TOKEN\"] = token\n    }\n\n    // 转发请求到后端\n    const response = await fetch(url, {\n      method,\n      headers,\n      body,\n    })\n\n    console.log(`[Proxy] Response status: ${response.status}`)\n\n    // 获取响应数据\n    const data = await response.text()\n    let jsonData: any\n    try {\n      jsonData = JSON.parse(data)\n    } catch {\n      jsonData = data\n    }\n\n    // 返回响应，保持状态码和 headers\n    return NextResponse.json(jsonData, {\n      status: response.status,\n      headers: {\n        \"Access-Control-Allow-Origin\": \"*\",\n        \"Access-Control-Allow-Methods\": \"GET, POST, PUT, DELETE, OPTIONS\",\n        \"Access-Control-Allow-Headers\": \"Content-Type, BARCKE-TOKEN\",\n      },\n    })\n  } catch (error: any) {\n    console.error(\"[Proxy] Error details:\", {\n      message: error?.message,\n      stack: error?.stack,\n      cause: error?.cause,\n    })\n    return NextResponse.json(\n      {\n        success: false,\n        message: error?.message || \"代理请求失败\",\n        error: process.env.NODE_ENV === \"development\" ? String(error) : undefined,\n      },\n      { status: 500 }\n    )\n  }\n}\n\n// 处理 OPTIONS 预检请求\nexport async function OPTIONS() {\n  return new NextResponse(null, {\n    status: 200,\n    headers: {\n      \"Access-Control-Allow-Origin\": \"*\",\n      \"Access-Control-Allow-Methods\": \"GET, POST, PUT, DELETE, OPTIONS\",\n      \"Access-Control-Allow-Headers\": \"Content-Type, BARCKE-TOKEN\",\n    },\n  })\n}\n\n"],"names":[],"mappings":"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"}}]
}