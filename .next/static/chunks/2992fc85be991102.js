(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,60207,e=>{"use strict";var t=e.i(5729),r=e.i(61655),n=e.i(28279),a=e.i(56602);let s=(0,a.default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);function o({tasks:e,selectedDate:n,onTaskClick:a}){let o,l,i,d=Array.from({length:24},(e,t)=>t),c=(o=n.getFullYear(),l=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0"),`${o}-${l}-${i}`),u=e.filter(e=>e.date===c),m=(0,r.useMemo)(()=>{let e=u.length;return{total:e,completed:u.filter(e=>e.completed).length,byCategory:u.reduce((e,t)=>{let r=t.categoryId||"uncategorized";return e[r]||(e[r]={total:0,completed:0}),e[r].total++,t.completed&&e[r].completed++,e},{})}},[u]);return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-950/20 dark:to-purple-950/20 rounded-2xl p-4 border-2 border-foreground/10",children:m.total>0?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-bold text-foreground/80",children:"Today's Progress"}),(0,t.jsxs)("span",{className:"text-xl font-bold text-foreground",children:[m.completed,"/",m.total]})]}),(0,t.jsx)("div",{className:"h-2 bg-foreground/10 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-gradient-to-r from-green-400 to-blue-500 rounded-full transition-all duration-500",style:{width:`${m.completed/m.total*100}%`}})}),Object.keys(m.byCategory).length>0&&(0,t.jsx)("div",{className:"flex gap-2 flex-wrap mt-3",children:Object.entries(m.byCategory).map(([e,r])=>(0,t.jsxs)("div",{className:"text-[10px] bg-background/60 rounded-full px-2 py-1 font-medium",children:[e,": ",r.completed,"/",r.total]},e))})]}):(0,t.jsx)("p",{className:"text-center py-8 text-sm font-handwriting text-muted-foreground",children:"No tasks today - enjoy your free time! â˜€ï¸"})}),m.total>0&&(0,t.jsx)("div",{className:"space-y-0 bg-muted/10 rounded-2xl border border-border/40 overflow-hidden",children:d.map(e=>{let r,n=(r=e.toString().padStart(2,"0"),u.filter(e=>e.time.startsWith(r)));return 0===n.length?null:(0,t.jsxs)("div",{className:"flex border-b border-border/30 last:border-0",children:[(0,t.jsxs)("div",{className:"w-16 flex-shrink-0 py-4 px-3 text-xs text-muted-foreground font-semibold",children:[e.toString().padStart(2,"0"),":00"]}),(0,t.jsx)("div",{className:"flex-1 py-3 pr-3 space-y-2",children:n.map(e=>(0,t.jsx)("button",{onClick:()=>a(e),className:`w-full text-left px-4 py-3 rounded-xl transition-all active:scale-[0.98] border ${e.completed?"text-muted-foreground bg-muted/20 border-transparent":"text-foreground bg-background border-border/40 shadow-sm active:shadow"}`,children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,t.jsx)("span",{className:"text-sm font-medium leading-relaxed",children:e.title}),e.completed&&(0,t.jsx)(s,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"})]})},e.id))})]},e)})})]})}function l(e){let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`}function i({tasks:e,selectedDate:n,onTaskClick:a}){let o=(0,r.useMemo)(()=>{let e=[],t=new Date(n),r=t.getDay(),a=new Date(t);a.setDate(t.getDate()-(0===r?6:r-1));for(let t=0;t<7;t++){let r=new Date(a);r.setDate(a.getDate()+t),e.push(r)}return e},[n]),i=(0,r.useMemo)(()=>{let t=o.map(e=>l(e)),r=e.filter(e=>t.includes(e.date));return{total:r.length,completed:r.filter(e=>e.completed).length}},[e,o]);return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:i.total>0?(0,t.jsxs)("p",{children:["æœ¬å‘¨å…±æœ‰ ",i.total," ä»¶å¾…åŠï¼Œå·²å®Œæˆ ",i.completed," ä»¶"]}):(0,t.jsx)("p",{className:"text-center py-16 text-sm",children:"æœ¬å‘¨æš‚æ— å¾…åŠï¼Œäº«å—è½»æ¾æ—¶å…‰å§~"})}),i.total>0&&(0,t.jsx)("div",{className:"overflow-x-auto -mx-4 px-4 pb-2",children:(0,t.jsx)("div",{className:"flex gap-3 snap-x snap-mandatory",children:o.map(r=>{let n,o=(n=l(r),e.filter(e=>e.date===n)),i=r.toDateString()===new Date().toDateString();return(0,t.jsxs)("div",{className:`flex-shrink-0 w-[160px] snap-center rounded-2xl border transition-all ${i?"border-foreground/30 bg-muted/40 shadow-sm":"border-border/40 bg-muted/10"} p-4`,children:[(0,t.jsxs)("div",{className:"text-center mb-4",children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground font-medium",children:r.toLocaleDateString("zh-CN",{weekday:"short"})}),(0,t.jsx)("div",{className:`text-2xl font-bold mt-1 ${i?"text-foreground":"text-foreground/80"}`,children:r.getDate()}),o.length>0&&(0,t.jsxs)("div",{className:"text-[10px] text-muted-foreground mt-1",children:[o.filter(e=>e.completed).length,"/",o.length]})]}),(0,t.jsx)("div",{className:"space-y-2",children:0===o.length?(0,t.jsx)("div",{className:"text-center py-6 text-xs text-muted-foreground",children:"æ— ä»»åŠ¡"}):o.map(e=>(0,t.jsx)("button",{onClick:()=>a(e),className:`w-full text-left px-3 py-2.5 rounded-xl text-xs transition-all active:scale-95 ${e.completed?"text-muted-foreground bg-muted/30":"text-foreground bg-background shadow-sm border border-border/40"}`,children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"text-[10px] text-muted-foreground mb-1",children:e.time}),(0,t.jsx)("div",{className:"font-medium line-clamp-2 leading-relaxed",children:e.title})]}),e.completed&&(0,t.jsx)(s,{className:"h-3.5 w-3.5 text-muted-foreground flex-shrink-0"})]})},e.id))})]},r.toISOString())})})})]})}let d=(0,a.default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),c=(0,a.default)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),u=(0,a.default)("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);function m(e){let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`}function f({tasks:e=[],monthData:n,selectedDate:a,onDateClick:s,onMonthChange:o,categories:l=[]}){let[i,f]=(0,r.useState)(!1),p=(0,r.useMemo)(()=>{if(!n)return new Map;let e=new Map;return n.forEach(t=>{e.set(t.date,t)}),e},[n]),{calendarDays:x,stats:h,incompleteTasks:g}=(0,r.useMemo)(()=>{let t=a.getFullYear(),r=a.getMonth(),s=new Date(t,r,1),o=s.getDay(),l=new Date(s);l.setDate(1-(0===o?6:o-1));let i=[],d=new Date(l);for(let e=0;e<42;e++)i.push(new Date(d)),d.setDate(d.getDate()+1);let c=0,u=0,f=[];if(n&&n.length>0)n.forEach(t=>{if(c+=t.totalCount,u+=t.completedCount,t.hasUnfinished){let r=e.filter(e=>e.date===t.date&&!e.completed);f.push(...r)}});else{let t=i.filter(e=>e.getMonth()===r).map(e=>m(e)),n=e.filter(e=>t.includes(e.date));c=n.length,u=n.filter(e=>e.completed).length,f.push(...n.filter(e=>!e.completed))}return{calendarDays:i,stats:{total:c,completed:u},incompleteTasks:f}},[a,e,n]);return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"text-center mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,t.jsx)("button",{onClick:()=>{let e=new Date(a);e.setMonth(e.getMonth()-1),o?.(e)},className:"p-2 hover:bg-muted/50 rounded-full transition-colors active:scale-95","aria-label":"Previous month",children:(0,t.jsx)(d,{className:"h-6 w-6 text-foreground/70"})}),(0,t.jsxs)("div",{className:"inline-block relative",children:[(0,t.jsxs)("div",{className:"text-5xl font-bold text-foreground/90 tracking-tight",children:[a.toLocaleDateString("en-US",{month:"short"}),"."]}),(0,t.jsx)("div",{className:"absolute -top-2 -right-12 text-2xl",children:"âœ¨"})]}),(0,t.jsx)("button",{onClick:()=>{let e=new Date(a);e.setMonth(e.getMonth()+1),o?.(e)},className:"p-2 hover:bg-muted/50 rounded-full transition-colors active:scale-95","aria-label":"Next month",children:(0,t.jsx)(c,{className:"h-6 w-6 text-foreground/70"})})]}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground font-handwriting mt-2",children:a.getFullYear()})]}),g.length>0&&(0,t.jsxs)("button",{onClick:()=>f(!0),className:"w-full py-3 px-4 bg-amber-50 border-2 border-amber-200 rounded-xl flex items-center justify-between active:scale-[0.98] transition-transform hover:bg-amber-100",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(u,{className:"h-5 w-5 text-amber-600"}),(0,t.jsx)("span",{className:"text-sm font-medium text-amber-900",children:"å¾…å®Œæˆä»»åŠ¡"})]}),(0,t.jsx)("span",{className:"text-lg font-bold text-amber-600",children:g.length})]}),(0,t.jsxs)("div",{className:"bg-background rounded-2xl border-2 border-foreground/20 overflow-hidden sketch-border",children:[(0,t.jsx)("div",{className:"grid grid-cols-7 border-b-2 border-foreground/20 bg-muted/20",children:["Mo","Tu","We","Th","Fr","Sa","Su"].map(e=>(0,t.jsx)("div",{className:"text-center py-3 text-xs font-bold text-foreground/70 uppercase tracking-wider",children:e},e))}),(0,t.jsx)("div",{className:"grid grid-cols-7",style:{gridAutoRows:"minmax(85px, 1fr)"},children:x.map((r,n)=>{let o,l,i,d,c,u,f,x=r.getMonth()===a.getMonth(),h=r.toDateString()===new Date().toDateString(),{total:g,completed:b,completionRate:y,completedTypeIcons:v,hasUnfinished:w}=(t=>{let r=m(t),n=p.get(r);if(n)return{total:n.totalCount,completed:n.completedCount,completionRate:n.completionRate,completedTypeIcons:n.completedTypeIcons,hasUnfinished:n.hasUnfinished};let a=e.filter(e=>e.date===r),s=a.length,o=a.filter(e=>e.completed).length;return{total:s,completed:o,completionRate:s>0?o/s:0,completedTypeIcons:a.filter(e=>e.completed&&e.categoryId).map(e=>e.categoryIcon||"").filter(Boolean),hasUnfinished:s>o}})(r);return(0,t.jsx)("button",{onClick:()=>{s(new Date(r.getFullYear(),r.getMonth(),r.getDate()))},disabled:!x,className:`relative w-full aspect-square min-h-[85px] border-r border-b border-foreground/15 p-2.5 transition-all active:scale-95 disabled:active:scale-100 overflow-hidden ${!x?"text-muted-foreground/30 bg-muted/5":"hover:bg-muted/30"} ${h?"bg-yellow-50 border-yellow-300 border-2":""} ${g>0&&x?y>=1?"bg-green-100/80 border-green-200":y>=.75?"bg-blue-100/80 border-blue-200":y>=.5?"bg-yellow-100/80 border-yellow-200":y>=.25?"bg-orange-100/80 border-orange-200":"":""}`,children:(0,t.jsxs)("div",{className:"flex flex-col items-start justify-start h-full w-full gap-1",children:[(0,t.jsx)("div",{className:`text-sm font-bold leading-none ${h?"text-foreground":"text-foreground/80"}`,children:r.getDate()}),x&&v&&v.length>0&&(o=v.length,l="w-5 h-5",i="text-[10px]",d="gap-1",c=o,o>12?(l="w-3 h-3",i="text-[7px]",d="gap-0.5",c=Math.min(o,16)):o>9?(l="w-3.5 h-3.5",i="text-[8px]",d="gap-0.5",c=o):o>6?(l="w-4 h-4",i="text-[9px]",d="gap-0.5",c=o):o>4&&(l="w-4.5 h-4.5",i="text-[9px]",d="gap-0.5",c=o),u=v.slice(0,c),f=o-c,(0,t.jsxs)("div",{className:`flex flex-wrap ${d} mt-0.5 w-full max-w-full px-0.5`,children:[u.map((e,r)=>(0,t.jsx)("div",{className:`${l} rounded-full bg-white border border-foreground/20 flex items-center justify-center ${i} shadow-sm flex-shrink-0`,title:"å·²å®Œæˆ",children:e},r)),f>0&&(0,t.jsxs)("div",{className:`${l} rounded-full bg-white border border-foreground/20 flex items-center justify-center text-[7px] font-bold text-foreground/60 flex-shrink-0`,children:["+",f]})]})),g>0&&x&&w&&(0,t.jsx)("div",{className:"flex items-center gap-1 mt-auto w-full px-0.5",children:(0,t.jsx)("div",{className:"w-4 h-4 rounded-full border-2 border-foreground/40 flex items-center justify-center text-[8px] font-bold flex-shrink-0",children:g-b})})]})},n)})})]}),(0,t.jsx)("div",{className:"text-center text-sm text-muted-foreground font-handwriting",children:h.total>0?(0,t.jsxs)("p",{children:[h.completed," of ",h.total," tasks completed this month"]}):(0,t.jsx)("p",{children:"No tasks this month, time to plan ahead!"})}),i&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-end",onClick:()=>f(!1),children:(0,t.jsxs)("div",{className:"w-full bg-background rounded-t-3xl max-h-[70vh] overflow-y-auto pb-safe",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"sticky top-0 bg-background border-b border-border px-6 py-4",children:[(0,t.jsx)("div",{className:"w-12 h-1 bg-muted-foreground/30 rounded-full mx-auto mb-4"}),(0,t.jsxs)("h3",{className:"text-lg font-bold",children:["å¾…å®Œæˆä»»åŠ¡ (",g.length,")"]})]}),(0,t.jsx)("div",{className:"px-6 py-4 space-y-3",children:g.map(e=>{let r,n=e.categoryId?(r=e.categoryId,l.find(e=>e.id===r)):null;return(0,t.jsx)("div",{className:"p-4 bg-muted/30 rounded-xl border border-border flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[n&&(0,t.jsx)("span",{className:"text-lg",children:n.icon}),(0,t.jsx)("span",{className:"font-medium text-foreground",children:e.title})]}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:[new Date(e.date).toLocaleDateString("zh-CN")," ",e.time]})]})},e.id)})})]})})]})}var p=e.i(98688),p=p;let x=(0,a.default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),h=(0,a.default)("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]);function g({task:e,open:n,onOpenChange:a,onComplete:o}){return((0,r.useEffect)(()=>(n&&e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[n,e]),(0,r.useEffect)(()=>{if(!n||!e)return;let t=()=>{let t=new CustomEvent("show-toast",{detail:{message:`å¤ªæ£’äº†ï¼å·²å®Œæˆã€Œ${e.title}ã€`,type:"success"}});window.dispatchEvent(t)};return window.addEventListener("task-completed",t),()=>window.removeEventListener("task-completed",t)},[n,e]),n&&e)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-40 animate-in fade-in duration-200",onClick:()=>a(!1)}),(0,t.jsx)("div",{className:"fixed bottom-0 left-0 right-0 z-50 animate-slide-up",children:(0,t.jsxs)("div",{className:"bg-background rounded-t-3xl border-t border-x border-border/40 shadow-2xl max-w-lg mx-auto pb-safe max-h-[85vh] overflow-y-auto",children:[(0,t.jsx)("div",{className:"flex justify-center pt-3 pb-2",children:(0,t.jsx)("div",{className:"w-12 h-1 rounded-full bg-muted-foreground/30"})}),(0,t.jsxs)("div",{className:"px-5 pt-2 pb-5",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3 flex-1 pr-4",children:[e.categoryIcon&&(0,t.jsx)("span",{className:"text-2xl",children:e.categoryIcon}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-foreground leading-relaxed",children:e.title}),e.category&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:e.category})]})]}),(0,t.jsx)("button",{onClick:()=>a(!1),className:"w-8 h-8 rounded-full bg-muted/50 flex items-center justify-center active:scale-95 transition-transform flex-shrink-0",children:(0,t.jsx)(p.default,{className:"h-4 w-4"})})]}),(0,t.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-border/40",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground font-medium",children:"æ—¶é—´"}),(0,t.jsx)("div",{className:"text-sm font-semibold",children:e.time})]}),e.repeatConfig?.enabled&&(0,t.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-border/40",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground font-medium",children:"é‡å¤"}),(0,t.jsx)("div",{className:"text-sm font-semibold",children:"daily"===e.repeatConfig.frequency?"æ¯å¤©":"weekly"===e.repeatConfig.frequency?"æ¯å‘¨":"æ¯æœˆ"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-border/40",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground font-medium",children:"çŠ¶æ€"}),(0,t.jsx)("div",{className:`text-sm font-semibold ${e.completed?"text-muted-foreground":""}`,children:e.completed?"å·²å®Œæˆ":"å¾…å®Œæˆ"})]}),e.images&&e.images.length>0&&(0,t.jsxs)("div",{className:"pt-3",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground font-medium mb-3",children:"é™„ä»¶"}),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-3",children:e.images.map((e,r)=>(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)("div",{className:"aspect-square rounded-lg overflow-hidden border border-border/40 bg-muted/20",children:(0,t.jsx)("img",{src:e||"/placeholder.svg",alt:`é™„ä»¶ ${r+1}`,className:"w-full h-full object-cover"})}),(0,t.jsx)("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-active:opacity-100 transition-opacity rounded-lg flex items-center justify-center gap-2",children:(0,t.jsx)("button",{onClick:()=>{let t;(t=document.createElement("a")).href=e,t.download=`attachment-${r+1}.png`,t.click()},className:"w-8 h-8 rounded-full bg-white/90 flex items-center justify-center active:scale-95 transition-transform",children:(0,t.jsx)(x,{className:"h-4 w-4 text-black"})})}),(0,t.jsxs)("div",{className:"mt-1 text-xs text-center text-muted-foreground truncate",children:[(0,t.jsx)(h,{className:"h-3 w-3 inline mr-1"}),"å›¾ç‰‡ ",r+1]})]},r))})]})]}),!e.completed&&(0,t.jsxs)("button",{onClick:()=>{o(e.id),window.dispatchEvent(new Event("task-completed"))},className:"w-full flex items-center justify-center gap-2 py-3.5 px-4 bg-foreground text-background rounded-xl font-semibold active:scale-[0.98] transition-transform shadow-sm",children:[(0,t.jsx)(s,{className:"h-5 w-5"}),"æ ‡è®°å®Œæˆ"]})]})]})})]}):null}var p=p;let b=(0,a.default)("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),y=(0,a.default)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),v=(0,a.default)("BookDashed",[["path",{d:"M12 17h2",key:"13u4lk"}],["path",{d:"M12 22h2",key:"kn7ki6"}],["path",{d:"M12 2h2",key:"cvn524"}],["path",{d:"M18 22h1a1 1 0 0 0 1-1",key:"w6gbqz"}],["path",{d:"M18 2h1a1 1 0 0 1 1 1v1",key:"1vpra5"}],["path",{d:"M20 15v2h-2",key:"fph276"}],["path",{d:"M20 8v3",key:"deu0bs"}],["path",{d:"M4 11V9",key:"v3xsx8"}],["path",{d:"M4 19.5V15",key:"6gr39e"}],["path",{d:"M4 5v-.5A2.5 2.5 0 0 1 6.5 2H8",key:"wywhs9"}],["path",{d:"M8 22H6.5a1 1 0 0 1 0-5H8",key:"1cu73q"}]]),w=(0,a.default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),j=(0,a.default)("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]),N=(0,a.default)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);function k(e){let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`}function C({open:e,onOpenChange:n,onAdd:a,selectedDate:s,currentView:o,templates:l,categories:i,onManageTemplates:d,onManageCategories:u}){let m="week"===o?new Date:s,[f,x]=(0,r.useState)("single"),[h,g]=(0,r.useState)(""),[C,S]=(0,r.useState)("09:00"),[M,E]=(0,r.useState)(k(m)),[R,D]=(0,r.useState)([]),[T,I]=(0,r.useState)(!1),[A,P]=(0,r.useState)(""),[O,L]=(0,r.useState)(!1),[F,$]=(0,r.useState)({enabled:!1,frequency:"daily",interval:1}),[_,H]=(0,r.useState)(null),[z,V]=(0,r.useState)(null),[q,K]=(0,r.useState)("09:00"),[W,U]=(0,r.useState)(k(m));(0,r.useEffect)(()=>{if(e){let e="week"===o?new Date:s;E(k(e)),U(k(e))}},[e,o,s]);let[B,Y]=(0,r.useState)([]),G=(0,r.useRef)(null),X=()=>{if(!_)return;let e="day"===o?M:"week"===o?k(new Date):W;B.forEach(t=>{a({title:t.title,time:"day"===o?t.time:q,completed:!1,date:e,images:void 0,category:t.category,categoryIcon:t.categoryIcon,categoryId:t.categoryId})}),n(!1),V(null),H(null),Y([])};return e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-40 bg-black/40 backdrop-blur-sm",onClick:()=>n(!1)}),(0,t.jsxs)("div",{className:"fixed inset-x-0 bottom-0 z-50 bg-background rounded-t-3xl shadow-2xl animate-slide-up pb-safe max-h-[85vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"px-5 py-4 border-b border-border/40 sticky top-0 bg-background z-10",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"æ·»åŠ å¾…åŠ"}),(0,t.jsx)("button",{onClick:()=>n(!1),className:"w-8 h-8 rounded-full bg-muted/50 flex items-center justify-center active:scale-95 transition-transform",children:(0,t.jsx)(p.default,{className:"h-4 w-4"})})]}),(0,t.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>x("single"),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-all active:scale-95 flex items-center justify-center gap-1.5 ${"single"===f?"bg-foreground text-background":"bg-muted/40 text-muted-foreground"}`,children:[(0,t.jsx)(w,{className:"h-4 w-4"}),"å•ä¸ªä»»åŠ¡"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>x("template"),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-all active:scale-95 flex items-center justify-center gap-1.5 ${"template"===f?"bg-foreground text-background":"bg-muted/40 text-muted-foreground"}`,children:[(0,t.jsx)(v,{className:"h-4 w-4"}),"ä»æ¨¡æ¿"]})]})]}),"single"===f?(0,t.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!h.trim())return;let t=i.find(e=>e.id===A);a({title:h.trim(),time:C,completed:!1,date:M,images:R.length>0?R:void 0,category:t?.name,categoryIcon:t?.icon,categoryId:A||void 0,repeatConfig:F.enabled?F:void 0}),g(""),S("09:00"),D([]),P(""),$({enabled:!1,frequency:"daily",interval:1}),E(k("week"===o?new Date:s))},className:"px-5 py-5 space-y-5",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"ä»»åŠ¡åç§°"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",value:h,onChange:e=>g(e.target.value),placeholder:"è¾“å…¥ä»»åŠ¡åç§°",className:"w-full px-4 py-3 pr-12 rounded-xl border border-border/40 bg-background text-sm focus:outline-none focus:ring-2 focus:ring-foreground/20",autoFocus:!0}),(0,t.jsx)("button",{type:"button",onClick:()=>{T||(I(!0),setTimeout(()=>{g("è¯­éŸ³è¾“å…¥çš„ä»»åŠ¡ç¤ºä¾‹"),I(!1)},2e3))},className:`absolute right-2 top-1/2 -translate-y-1/2 w-8 h-8 rounded-lg flex items-center justify-center transition-all active:scale-95 ${T?"bg-red-500 text-white":"bg-muted/50"}`,children:(0,t.jsx)(b,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium",children:"ä»»åŠ¡åˆ†ç±»"}),(0,t.jsx)("button",{type:"button",onClick:u,className:"text-xs text-muted-foreground hover:text-foreground",children:"ç®¡ç†åˆ†ç±»"})]}),(0,t.jsx)("div",{className:"flex gap-2 flex-wrap",children:i.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>P(e.id),className:`px-3 py-2 rounded-lg text-sm flex items-center gap-1.5 transition-all active:scale-95 ${A===e.id?"bg-foreground text-background":"bg-muted/40 text-foreground"}`,children:[(0,t.jsx)("span",{className:"text-base",children:e.icon}),(0,t.jsx)("span",{children:e.name})]},e.id))})]}),"day"!==o&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"æ—¥æœŸ"}),(0,t.jsx)("input",{type:"date",value:M,onChange:e=>E(e.target.value),className:"w-full px-4 py-3 rounded-xl border border-border/40 bg-background text-sm focus:outline-none focus:ring-2 focus:ring-foreground/20"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"æ—¶é—´"}),(0,t.jsx)("input",{type:"time",value:C,onChange:e=>S(e.target.value),className:"w-full px-4 py-3 rounded-xl border border-border/40 bg-background text-sm focus:outline-none focus:ring-2 focus:ring-foreground/20"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("button",{type:"button",onClick:()=>L(!O),className:"w-full flex items-center justify-between px-4 py-3 rounded-xl border border-border/40 bg-background text-sm active:scale-[0.98] transition-transform",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(j,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:F.enabled?"é‡å¤å·²å¯ç”¨":"è®¾ç½®é‡å¤"})]}),(0,t.jsx)(c,{className:`h-4 w-4 transition-transform ${O?"rotate-90":""}`})]}),O&&(0,t.jsxs)("div",{className:"mt-3 space-y-3 p-4 rounded-xl bg-muted/20 border border-border/40",children:[(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:F.enabled,onChange:e=>$({...F,enabled:e.target.checked}),className:"w-4 h-4 rounded"}),(0,t.jsx)("span",{className:"text-sm",children:"å¯ç”¨é‡å¤"})]}),F.enabled&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium mb-1.5",children:"é‡å¤é¢‘ç‡"}),(0,t.jsxs)("select",{value:F.frequency,onChange:e=>{let t=e.target.value;$({...F,frequency:t,interval:"daily"===t?1:F.interval,daysOfWeek:"weekly"===t?[]:void 0,dayOfMonth:void 0})},className:"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm",children:[(0,t.jsx)("option",{value:"daily",children:"æ¯å¤©"}),(0,t.jsx)("option",{value:"weekly",children:"æ¯å‘¨"}),(0,t.jsx)("option",{value:"monthly",children:"æ¯æœˆ"})]})]}),"daily"!==F.frequency&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-xs font-medium mb-1.5",children:["é—´éš”ï¼ˆæ¯ ","weekly"===F.frequency?"å‡ å‘¨":"å‡ æœˆ","ï¼‰"]}),(0,t.jsx)("input",{type:"number",min:"1",value:F.interval,onChange:e=>$({...F,interval:Number(e.target.value)}),className:"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm"})]}),"weekly"===F.frequency&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium mb-1.5",children:"é€‰æ‹©é‡å¤æ—¥æœŸ"}),(0,t.jsx)("div",{className:"grid grid-cols-7 gap-1",children:["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"].map((e,r)=>{let n=F.daysOfWeek?.includes(r)||!1;return(0,t.jsx)("button",{type:"button",onClick:()=>{let e=F.daysOfWeek||[],t=n?e.filter(e=>e!==r):[...e,r].sort();$({...F,daysOfWeek:t})},className:`py-2 rounded-lg text-xs font-medium transition-all active:scale-95 ${n?"bg-foreground text-background":"bg-muted/40 text-muted-foreground"}`,children:e},r)})})]}),"monthly"===F.frequency&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium mb-1.5",children:"é€‰æ‹©æ¯æœˆçš„å“ªä¸€å¤©"}),(0,t.jsx)("input",{type:"number",min:"1",max:"31",value:F.dayOfMonth||"",onChange:e=>$({...F,dayOfMonth:e.target.value?Number(e.target.value):void 0}),placeholder:"ä¾‹å¦‚: 15 (æ¯æœˆ15å·)",className:"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium mb-1.5",children:"é‡å¤æ¬¡æ•°ï¼ˆå¯é€‰ï¼‰"}),(0,t.jsx)("input",{type:"number",min:"1",value:F.count||"",onChange:e=>$({...F,count:e.target.value?Number(e.target.value):void 0}),placeholder:"ä¸é™åˆ¶",className:"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium mb-1.5",children:"ç»“æŸæ—¥æœŸï¼ˆå¯é€‰ï¼‰"}),(0,t.jsx)("input",{type:"date",value:F.endDate||"",onChange:e=>$({...F,endDate:e.target.value}),className:"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm"})]})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"å›¾ç‰‡é™„ä»¶"}),(0,t.jsx)("input",{ref:G,type:"file",accept:"image/*",multiple:!0,onChange:e=>{let t=e.target.files;t&&Array.from(t).forEach(e=>{let t=new FileReader;t.onloadend=()=>{D(e=>[...e,t.result])},t.readAsDataURL(e)})},className:"hidden"}),(0,t.jsxs)("button",{type:"button",onClick:()=>G.current?.click(),className:"w-full py-3 rounded-xl border border-dashed border-border/40 bg-muted/20 text-sm text-muted-foreground flex items-center justify-center gap-2 active:scale-[0.98] transition-transform",children:[(0,t.jsx)(y,{className:"h-4 w-4"}),"æ·»åŠ å›¾ç‰‡"]}),R.length>0&&(0,t.jsx)("div",{className:"flex gap-2 mt-3 flex-wrap",children:R.map((e,r)=>(0,t.jsxs)("div",{className:"relative w-20 h-20 rounded-lg overflow-hidden border border-border/40",children:[(0,t.jsx)("img",{src:e||"/placeholder.svg",alt:"",className:"w-full h-full object-cover"}),(0,t.jsx)("button",{type:"button",onClick:()=>D(e=>e.filter((e,t)=>t!==r)),className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-black/60 text-white flex items-center justify-center",children:(0,t.jsx)(p.default,{className:"h-3 w-3"})})]},r))})]}),(0,t.jsx)("button",{type:"submit",disabled:!h.trim(),className:"w-full py-3.5 rounded-xl bg-foreground text-background font-medium active:scale-[0.98] transition-transform disabled:opacity-40 disabled:active:scale-100",children:"æ·»åŠ "})]}):(0,t.jsxs)("div",{className:"px-5 py-5 space-y-4",children:[(0,t.jsx)("div",{className:"space-y-3",children:l.map(e=>(0,t.jsxs)("div",{className:"rounded-xl border border-border/40 bg-muted/20 overflow-hidden",children:[(0,t.jsxs)("button",{onClick:()=>{z===e.id?(V(null),H(null),Y([])):(V(e.id),H(e.id),Y(e.tasks.map(e=>({...e,category:e.category,categoryIcon:e.categoryIcon,categoryId:e.categoryId}))))},className:"w-full p-4 flex items-center gap-3 active:bg-muted/30 transition-all text-left",children:[z===e.id?(0,t.jsx)(N,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}):(0,t.jsx)(c,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),(0,t.jsx)("div",{className:"text-2xl",children:e.icon}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-medium text-sm",children:e.name}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground mt-0.5",children:[e.tasks.length," é¡¹ä»»åŠ¡"]})]})]}),z===e.id&&(0,t.jsxs)("div",{className:"px-4 pb-4 space-y-3",children:[(0,t.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:B.map((e,r)=>(0,t.jsxs)("div",{className:"flex items-start gap-2 text-sm bg-background/50 rounded-lg p-2.5",children:[(0,t.jsx)("div",{className:"w-5 h-5 rounded-full bg-muted/50 flex items-center justify-center text-xs text-muted-foreground flex-shrink-0 mt-0.5",children:r+1}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("input",{type:"text",value:e.title,onChange:e=>{let t=[...B];t[r].title=e.target.value,Y(t)},className:"w-full bg-transparent border-none outline-none font-medium text-sm"}),e.category&&(0,t.jsxs)("div",{className:"text-xs text-muted-foreground mt-1 flex items-center gap-1",children:[e.categoryIcon&&(0,t.jsx)("span",{children:e.categoryIcon}),(0,t.jsx)("span",{children:e.category})]})]})]},r))}),(0,t.jsxs)("div",{className:"pt-3 border-t border-border/30 space-y-3",children:[(0,t.jsx)("div",{className:"text-xs font-medium text-muted-foreground",children:"ä¸ºæ‰€æœ‰ä»»åŠ¡è®¾ç½®æ—¶é—´"}),"day"!==o&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium mb-1.5",children:"æ—¥æœŸ"}),(0,t.jsx)("input",{type:"date",value:W,onChange:e=>U(e.target.value),className:"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium mb-1.5",children:"æ—¶é—´"}),(0,t.jsx)("input",{type:"time",value:q,onChange:e=>K(e.target.value),className:"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm"})]}),(0,t.jsxs)("button",{onClick:X,className:"w-full py-2.5 rounded-lg bg-foreground text-background text-sm font-medium active:scale-95 transition-transform",children:["æ·»åŠ  ",B.length," ä¸ªä»»åŠ¡"]})]})]})]},e.id))}),(0,t.jsx)("button",{onClick:d,className:"w-full py-3 rounded-xl border border-dashed border-border/40 bg-muted/20 text-sm font-medium text-muted-foreground active:scale-[0.98] transition-transform",children:"ç®¡ç†æ¨¡æ¿"})]})]})]}):null}var p=p;let S=(0,a.default)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),M=(0,a.default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var E=e.i(50129);function R(e){return{id:e.id,title:e.title,time:e.time||"00:00",completed:"completed"===e.status,date:e.date,description:e.description,category:e.typeName,categoryIcon:e.typeIcon,categoryId:e.typeId,repeatType:e.repeatType,repeatRule:e.repeatRule,attachments:e.attachments,source:e.source,templateId:e.templateId,createdAt:e.createdAt,completedAt:e.completedAt,updatedAt:e.updatedAt,images:e.attachments?.filter(e=>"image"===e.type).map(e=>e.previewUrl||e.url)}}function D(e){let t={title:e.title,description:e.description,date:e.date,time:e.time||void 0,typeId:e.categoryId};return e.repeatConfig?.enabled?(t.repeatType=e.repeatConfig.frequency,"weekly"===e.repeatConfig.frequency&&e.repeatConfig.daysOfWeek?t.repeatRule={type:"weekly",days:e.repeatConfig.daysOfWeek.map(e=>0===e?7:e)}:"monthly"===e.repeatConfig.frequency&&e.repeatConfig.dayOfMonth?t.repeatRule={type:"monthly",days:[e.repeatConfig.dayOfMonth]}:"daily"===e.repeatConfig.frequency&&(t.repeatRule={type:"daily",days:[]})):e.repeatType&&"none"!==e.repeatType?(t.repeatType=e.repeatType,t.repeatRule=e.repeatRule):t.repeatType="none",t}function T(e){return{id:e.typeId,name:e.typeName,icon:e.icon,color:e.color}}function I(e){return{id:e.templateId,name:e.templateName,icon:"ğŸ“",description:e.description,tasks:e.todos.map(e=>({id:e.id,title:e.title,time:"09:00",category:e.typeName,categoryIcon:e.typeIcon,categoryId:e.typeId,sortOrder:e.sortOrder}))}}function A(e){return{templateName:e.name,description:e.description}}let P=0,O=new Map,L=e=>{if(O.has(e))return;let t=setTimeout(()=>{O.delete(e),_({type:"REMOVE_TOAST",toastId:e})},1e6);O.set(e,t)},F=[],$={toasts:[]};function _(e){$=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?L(r):e.toasts.forEach(e=>{L(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})($,e),F.forEach(e=>{e($)})}function H({...e}){let t=(P=(P+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>_({type:"DISMISS_TOAST",toastId:t});return _({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||r()}}}),{id:t,dismiss:r,update:e=>_({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function z(){let[e,t]=(0,r.useState)([]),[n,a]=(0,r.useState)(!1),[s,o]=(0,r.useState)(null),l=(0,r.useCallback)(async()=>{a(!0),o(null);try{let e=(await E.apiClient.getTemplates()).data.map(I);t(e)}catch(t){let e=t instanceof Error?t:Error("åŠ è½½æ¨¡æ¿å¤±è´¥");o(e),H({title:"åŠ è½½å¤±è´¥",description:e.message,variant:"destructive"})}finally{a(!1)}},[]);(0,r.useEffect)(()=>{l()},[l]);let i=(0,r.useCallback)(async e=>{try{let r=A(e),n=await E.apiClient.createTemplate(r),a=I(n.data);return t(e=>[...e,a]),H({title:"åˆ›å»ºæˆåŠŸ",description:`æ¨¡æ¿ã€Œ${a.name}ã€å·²åˆ›å»º`}),a}catch(t){let e=t instanceof Error?t:Error("åˆ›å»ºæ¨¡æ¿å¤±è´¥");throw H({title:"åˆ›å»ºå¤±è´¥",description:e.message,variant:"destructive"}),e}},[]),d=(0,r.useCallback)(async(e,r)=>{try{let n=A(r),a=await E.apiClient.updateTemplate(e,n),s=I(a.data);return t(t=>t.map(t=>t.id===e?s:t)),H({title:"æ›´æ–°æˆåŠŸ",description:`æ¨¡æ¿ã€Œ${s.name}ã€å·²æ›´æ–°`}),s}catch(t){let e=t instanceof Error?t:Error("æ›´æ–°æ¨¡æ¿å¤±è´¥");throw H({title:"æ›´æ–°å¤±è´¥",description:e.message,variant:"destructive"}),e}},[]),c=(0,r.useCallback)(async e=>{try{await E.apiClient.deleteTemplate(e),t(t=>t.filter(t=>t.id!==e)),H({title:"åˆ é™¤æˆåŠŸ",description:"æ¨¡æ¿å·²åˆ é™¤"})}catch(t){let e=t instanceof Error?t:Error("åˆ é™¤æ¨¡æ¿å¤±è´¥");throw H({title:"åˆ é™¤å¤±è´¥",description:e.message,variant:"destructive"}),e}},[]),u=(0,r.useCallback)(async(e,t,r)=>{try{await E.apiClient.addTemplateTodo(e,t,r),await l(),H({title:"æ·»åŠ æˆåŠŸ",description:"ä»»åŠ¡é¡¹å·²æ·»åŠ åˆ°æ¨¡æ¿"})}catch(t){let e=t instanceof Error?t:Error("æ·»åŠ ä»»åŠ¡é¡¹å¤±è´¥");throw H({title:"æ·»åŠ å¤±è´¥",description:e.message,variant:"destructive"}),e}},[l]),m=(0,r.useCallback)(async(e,t,r)=>{try{await E.apiClient.updateTemplateTodo(e,t,r),await l(),H({title:"æ›´æ–°æˆåŠŸ",description:"ä»»åŠ¡é¡¹å·²æ›´æ–°"})}catch(t){let e=t instanceof Error?t:Error("æ›´æ–°ä»»åŠ¡é¡¹å¤±è´¥");throw H({title:"æ›´æ–°å¤±è´¥",description:e.message,variant:"destructive"}),e}},[l]);return{templates:e,loading:n,error:s,createTemplate:i,updateTemplate:d,deleteTemplate:c,addTemplateTodo:u,updateTemplateTodo:m,deleteTemplateTodo:(0,r.useCallback)(async(e,t)=>{try{await E.apiClient.deleteTemplateTodo(e,t),await l(),H({title:"åˆ é™¤æˆåŠŸ",description:"ä»»åŠ¡é¡¹å·²åˆ é™¤"})}catch(t){let e=t instanceof Error?t:Error("åˆ é™¤ä»»åŠ¡é¡¹å¤±è´¥");throw H({title:"åˆ é™¤å¤±è´¥",description:e.message,variant:"destructive"}),e}},[l]),applyTemplate:(0,r.useCallback)(async(e,t,r)=>{try{let n=await E.apiClient.applyTemplate(e,t,r);return H({title:"åº”ç”¨æˆåŠŸ",description:`å·²åˆ›å»º ${n.data.length} ä¸ªä»»åŠ¡`}),n.data}catch(t){let e=t instanceof Error?t:Error("åº”ç”¨æ¨¡æ¿å¤±è´¥");throw H({title:"åº”ç”¨å¤±è´¥",description:e.message,variant:"destructive"}),e}},[]),refresh:l}}function V({open:e,onOpenChange:n,templates:a,categories:s,onSave:o}){let{createTemplate:l,updateTemplate:i,deleteTemplate:d,addTemplateTodo:u,updateTemplateTodo:m,deleteTemplateTodo:f,refresh:x}=z(),[h,g]=(0,r.useState)(a),[b,y]=(0,r.useState)(null),[v,j]=(0,r.useState)(""),[k,C]=(0,r.useState)(""),[E,R]=(0,r.useState)(null),[D,T]=(0,r.useState)([]),[I,A]=(0,r.useState)(null),[P,O]=(0,r.useState)(!1);(0,r.useEffect)(()=>{g(a)},[a]);let L=async()=>{try{O(!0);let e=await l({name:"æ–°æ¨¡æ¿",icon:"ğŸ“",description:""});g([...h,e]),o([]),y(e.id),j(e.name),C(e.icon)}catch(e){console.error("åˆ›å»ºæ¨¡æ¿å¤±è´¥:",e)}finally{O(!1)}},F=async e=>{if(v.trim())try{O(!0);let t=h.find(t=>t.id===e);if(!t)return;await i(e,{name:v,icon:k,description:t.description}),await x(),o([]),y(null)}catch(e){console.error("æ›´æ–°æ¨¡æ¿å¤±è´¥:",e)}finally{O(!1)}},$=async e=>{if(confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ¨¡æ¿å—ï¼Ÿ"))try{O(!0),await d(e),g(t=>t.filter(t=>t.id!==e)),o([])}catch(e){console.error("åˆ é™¤æ¨¡æ¿å¤±è´¥:",e)}finally{O(!1)}},_=async()=>{if(!I)return;let e=h.find(e=>e.id===I);if(e)try{O(!0);let t=e.tasks,r=t.filter(e=>e.id&&!D.find(t=>t.id===e.id)),n=D.filter(e=>!e.id),a=D.filter(e=>{if(!e.id)return!1;let r=t.find(t=>t.id===e.id);return!!r&&(r.title!==e.title||r.categoryId!==e.categoryId)});for(let e of r)e.id&&await f(I,e.id);for(let e of n)await u(I,e.title,e.categoryId);for(let e of a)e.id&&await m(I,e.id,{title:e.title,typeId:e.categoryId});await x(),o([]),A(null),T([])}catch(e){console.error("ä¿å­˜æ¨¡æ¿é¡¹å¤±è´¥:",e)}finally{O(!1)}},H=()=>{T([...D,{title:"æ–°ä»»åŠ¡",time:"09:00"}])},V=(e,t,r)=>{T(n=>{let a=[...n];if("category"===t){let t=s.find(e=>e.id===r);a[e]={...a[e],category:t?.name,categoryIcon:t?.icon,categoryId:t?.id}}else a[e]={...a[e],[t]:r};return a})},q=async()=>{try{O(!0),await x(),o([]),n(!1)}catch(e){console.error("åˆ·æ–°æ¨¡æ¿åˆ—è¡¨å¤±è´¥:",e)}finally{O(!1)}};return e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-40 bg-black/40 backdrop-blur-sm",onClick:()=>n(!1)}),(0,t.jsxs)("div",{className:"fixed inset-x-0 bottom-0 z-50 bg-background rounded-t-3xl shadow-2xl animate-slide-up pb-safe max-h-[85vh] overflow-y-auto",children:[(0,t.jsx)("div",{className:"px-5 py-4 border-b border-border/40 sticky top-0 bg-background z-10",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"ç®¡ç†æ¨¡æ¿"}),(0,t.jsx)("button",{onClick:()=>n(!1),className:"w-8 h-8 rounded-full bg-muted/50 flex items-center justify-center active:scale-95 transition-transform",children:(0,t.jsx)(p.default,{className:"h-4 w-4"})})]})}),(0,t.jsxs)("div",{className:"px-5 py-5 space-y-3",children:[h.map(e=>(0,t.jsx)("div",{className:"rounded-xl border border-border/40 bg-muted/20 overflow-hidden",children:(0,t.jsx)("div",{className:"p-4",children:b===e.id?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("input",{type:"text",value:k,onChange:e=>C(e.target.value),placeholder:"å›¾æ ‡ (emoji)",className:"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm"}),(0,t.jsx)("input",{type:"text",value:v,onChange:e=>j(e.target.value),placeholder:"æ¨¡æ¿åç§°",className:"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm"}),(0,t.jsx)("button",{onClick:()=>F(e.id),disabled:P||!v.trim(),className:"w-full py-2 rounded-lg bg-foreground text-background text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:P?"ä¿å­˜ä¸­...":"ä¿å­˜"})]}):I===e.id?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)("div",{className:"text-2xl",children:e.icon}),(0,t.jsx)("div",{className:"flex-1 font-medium",children:e.name}),(0,t.jsx)("button",{onClick:_,disabled:P,className:"px-3 py-1.5 rounded-lg bg-foreground text-background text-xs font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:P?"ä¿å­˜ä¸­...":"ä¿å­˜ä¿®æ”¹"})]}),(0,t.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:D.map((e,r)=>(0,t.jsx)("div",{className:"p-3 rounded-lg bg-background/50 border border-border/30 space-y-2",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,t.jsx)("input",{type:"text",value:e.title,onChange:e=>V(r,"title",e.target.value),placeholder:"ä»»åŠ¡åç§°",className:"w-full px-2 py-1.5 rounded border border-border/40 bg-background text-sm"}),(0,t.jsx)("input",{type:"time",value:e.time,onChange:e=>V(r,"time",e.target.value),className:"w-full px-2 py-1.5 rounded border border-border/40 bg-background text-sm"}),(0,t.jsxs)("select",{value:s.find(t=>t.name===e.category)?.id||"",onChange:e=>V(r,"category",e.target.value),className:"w-full px-2 py-1.5 rounded border border-border/40 bg-background text-sm",children:[(0,t.jsx)("option",{value:"",children:"æ— åˆ†ç±»"}),s.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.icon," ",e.name]},e.id))]})]}),(0,t.jsx)("button",{onClick:()=>{T(e=>e.filter((e,t)=>t!==r))},className:"w-7 h-7 rounded-lg bg-red-500/10 text-red-500 flex items-center justify-center active:scale-95 transition-transform",children:(0,t.jsx)(M,{className:"h-3.5 w-3.5"})})]})},r))}),(0,t.jsxs)("button",{onClick:H,className:"w-full py-2.5 rounded-lg border border-dashed border-border/40 bg-muted/20 text-sm text-muted-foreground active:scale-95 transition-transform flex items-center justify-center gap-2",children:[(0,t.jsx)(w,{className:"h-4 w-4"}),"æ·»åŠ ä»»åŠ¡é¡¹"]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("button",{onClick:()=>R(E===e.id?null:e.id),className:"mt-1 active:scale-95 transition-transform",children:E===e.id?(0,t.jsx)(N,{className:"h-4 w-4 text-muted-foreground"}):(0,t.jsx)(c,{className:"h-4 w-4 text-muted-foreground"})}),(0,t.jsx)("div",{className:"text-2xl",children:e.icon}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-medium",children:e.name}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:[e.tasks.length," é¡¹ä»»åŠ¡"]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>{A(e.id),T(e.tasks.map(e=>({id:e.id,title:e.title,time:e.time,category:e.category,categoryIcon:e.categoryIcon,categoryId:e.categoryId})))},className:"w-8 h-8 rounded-lg bg-blue-500/10 text-blue-500 flex items-center justify-center active:scale-95 transition-transform",title:"ç¼–è¾‘ä»»åŠ¡",children:(0,t.jsx)(S,{className:"h-4 w-4"})}),(0,t.jsx)("button",{onClick:()=>{y(e.id),j(e.name),C(e.icon)},className:"w-8 h-8 rounded-lg bg-muted/50 flex items-center justify-center active:scale-95 transition-transform",title:"ç¼–è¾‘åç§°",children:(0,t.jsx)(S,{className:"h-4 w-4"})}),(0,t.jsx)("button",{onClick:()=>$(e.id),disabled:P,className:"w-8 h-8 rounded-lg bg-red-500/10 text-red-500 flex items-center justify-center active:scale-95 transition-transform disabled:opacity-50 disabled:cursor-not-allowed",title:"åˆ é™¤æ¨¡æ¿",children:(0,t.jsx)(M,{className:"h-4 w-4"})})]})]}),E===e.id&&e.tasks.length>0&&(0,t.jsx)("div",{className:"mt-4 pt-4 border-t border-border/30 space-y-2",children:e.tasks.map((e,r)=>(0,t.jsxs)("div",{className:"flex items-start gap-2 text-sm bg-background/50 rounded-lg p-2.5",children:[(0,t.jsx)("div",{className:"w-5 h-5 rounded-full bg-muted/50 flex items-center justify-center text-xs text-muted-foreground flex-shrink-0 mt-0.5",children:r+1}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[e.categoryIcon&&(0,t.jsx)("span",{className:"text-sm",children:e.categoryIcon}),(0,t.jsx)("span",{className:"font-medium",children:e.title})]}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground mt-0.5 flex items-center gap-2",children:[(0,t.jsx)("span",{children:e.time}),e.category&&(0,t.jsxs)("span",{children:["Â· ",e.category]})]})]})]},r))})]})})},e.id)),(0,t.jsxs)("button",{onClick:L,disabled:P,className:"w-full py-3 rounded-xl border border-dashed border-border/40 bg-muted/20 text-sm font-medium text-muted-foreground active:scale-[0.98] transition-transform flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,t.jsx)(w,{className:"h-4 w-4"}),P?"åˆ›å»ºä¸­...":"æ·»åŠ æ–°æ¨¡æ¿"]})]}),(0,t.jsx)("div",{className:"px-5 pb-5",children:(0,t.jsx)("button",{onClick:q,disabled:P,className:"w-full py-3.5 rounded-xl bg-foreground text-background font-medium active:scale-[0.98] transition-transform disabled:opacity-50 disabled:cursor-not-allowed",children:"å®Œæˆ"})})]})]}):null}var p=p;let q=["ğŸ’ª","â­","â–¶ï¸","âœ…","ğŸ¯","ğŸ“š","ğŸƒ","ğŸ","ğŸ’¼","ğŸ¨","ğŸµ","ğŸ“±","âœˆï¸","ğŸ ","ğŸ›’","ğŸ’°","ğŸ“","ğŸ§˜","ğŸ‹ï¸","ğŸš´","ğŸ“","ğŸ’¡","ğŸ¬","ğŸ®"];function K({open:e,onOpenChange:n,categories:a,onCreateCategory:s,onDeleteCategory:o,onSave:l}){let[i,d]=(0,r.useState)(""),[c,u]=(0,r.useState)("â­"),[m,f]=(0,r.useState)(!1),[x,h]=(0,r.useState)(new Set);(0,r.useEffect)(()=>{e&&(d(""),u("â­"))},[e]);let g=async()=>{if(i.trim()&&!m){f(!0);try{await s({name:i.trim(),icon:c}),d(""),u("â­")}catch(e){}finally{f(!1)}}},b=async e=>{if(!x.has(e)){h(t=>new Set(t).add(e));try{await o(e)}catch(e){}finally{h(t=>{let r=new Set(t);return r.delete(e),r})}}};return e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-40 bg-black/40 backdrop-blur-sm",onClick:()=>n(!1)}),(0,t.jsxs)("div",{className:"fixed inset-x-0 bottom-0 z-50 bg-background rounded-t-3xl shadow-2xl animate-slide-up pb-safe max-h-[85vh] overflow-y-auto",children:[(0,t.jsx)("div",{className:"px-5 py-4 border-b border-border/40 sticky top-0 bg-background z-10",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"ç®¡ç†åˆ†ç±»"}),(0,t.jsx)("button",{onClick:()=>n(!1),className:"w-8 h-8 rounded-full bg-muted/50 flex items-center justify-center active:scale-95 transition-transform",children:(0,t.jsx)(p.default,{className:"h-4 w-4"})})]})}),(0,t.jsxs)("div",{className:"px-5 py-5 space-y-5",children:[(0,t.jsxs)("div",{className:"space-y-3 p-4 rounded-xl bg-muted/20 border border-border/40",children:[(0,t.jsx)("h3",{className:"text-sm font-medium",children:"æ·»åŠ æ–°åˆ†ç±»"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium mb-2",children:"é€‰æ‹©å›¾æ ‡"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:q.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>u(e),className:`w-10 h-10 rounded-lg flex items-center justify-center text-xl transition-all active:scale-95 ${c===e?"bg-foreground text-background ring-2 ring-foreground ring-offset-2":"bg-background border border-border/40"}`,children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium mb-2",children:"åˆ†ç±»åç§°"}),(0,t.jsx)("input",{type:"text",value:i,onChange:e=>d(e.target.value),onKeyDown:e=>{"Enter"===e.key&&i.trim()&&!m&&(e.preventDefault(),g())},placeholder:"ä¾‹å¦‚ï¼šè¿åŠ¨ã€å­¦ä¹ ã€å·¥ä½œ",className:"w-full px-3 py-2 rounded-lg border border-border/40 bg-background text-sm focus:outline-none focus:ring-2 focus:ring-foreground/20"})]}),(0,t.jsxs)("button",{onClick:g,disabled:!i.trim()||m,className:"w-full py-2 rounded-lg bg-foreground text-background text-sm font-medium active:scale-[0.98] transition-transform disabled:opacity-40 flex items-center justify-center gap-2",children:[(0,t.jsx)(w,{className:"h-4 w-4"}),m?"æ·»åŠ ä¸­...":"æ·»åŠ åˆ†ç±»"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-medium mb-3",children:"å·²æœ‰åˆ†ç±»"}),(0,t.jsxs)("div",{className:"space-y-2",children:[a.map(e=>{let r=x.has(e.id);return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-xl bg-muted/20 border border-border/40",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-2xl",children:e.icon}),(0,t.jsx)("span",{className:"text-sm font-medium",children:e.name})]}),(0,t.jsx)("button",{onClick:()=>b(e.id),disabled:r,className:"w-8 h-8 rounded-lg bg-red-500/10 text-red-500 flex items-center justify-center active:scale-95 transition-transform disabled:opacity-50",children:(0,t.jsx)(M,{className:"h-4 w-4"})})]},e.id)}),0===a.length&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"æš‚æ— åˆ†ç±»ï¼Œæ·»åŠ ä¸€ä¸ªè¯•è¯•å§"})]})]}),(0,t.jsx)("button",{onClick:()=>{l&&l(),n(!1)},className:"w-full py-3.5 rounded-xl bg-foreground text-background font-medium active:scale-[0.98] transition-transform",children:"å®Œæˆ"})]})]})]}):null}var p=p;let W=(0,a.default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),U=(0,a.default)("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),B=(0,a.default)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Y=(0,a.default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);function G({open:e,onOpenChange:n}){let{monthStats:a,typeStats:s,loading:o}=function(e,t={}){let{autoLoad:n=!0}=t,[a,s]=(0,r.useState)(null),[o,l]=(0,r.useState)([]),[i,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(null),m=(0,r.useCallback)(async()=>{d(!0),u(null);try{let[t,r]=await Promise.all([E.apiClient.getMonthStatistics(e),E.apiClient.getTypeStatistics(e)]);s(t.data),l(r.data)}catch(t){let e=t instanceof Error?t:Error("åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥");u(e),H({title:"åŠ è½½å¤±è´¥",description:e.message,variant:"destructive"})}finally{d(!1)}},[e]);return(0,r.useEffect)(()=>{n&&e&&m()},[n,e,m]),{monthStats:a,typeStats:o,loading:i,error:c,refresh:m}}((0,r.useMemo)(()=>{let e=new Date,t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0");return`${t}-${r}`},[e]),{autoLoad:e});return e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-40 bg-black/40 backdrop-blur-sm",onClick:()=>n(!1)}),(0,t.jsxs)("div",{className:"fixed inset-x-0 bottom-0 z-50 bg-background rounded-t-3xl shadow-2xl animate-slide-up pb-safe max-h-[85vh] overflow-y-auto",children:[(0,t.jsx)("div",{className:"px-5 py-4 border-b border-border/40 sticky top-0 bg-background z-10",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"æœ¬æœˆç»Ÿè®¡"}),(0,t.jsx)("button",{onClick:()=>n(!1),className:"w-8 h-8 rounded-full bg-muted/50 flex items-center justify-center active:scale-95 transition-transform",children:(0,t.jsx)(p.default,{className:"h-4 w-4"})})]})}),(0,t.jsx)("div",{className:"px-5 py-5 space-y-5",children:o?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)(Y,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"p-5 rounded-2xl bg-gradient-to-br from-purple-500/10 to-pink-500/10 border border-purple-500/20",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)(U,{className:"h-5 w-5 text-purple-500"}),(0,t.jsx)("h3",{className:"text-base font-semibold",children:"æ€»ä½“å®Œæˆæƒ…å†µ"})]}),(0,t.jsxs)("div",{className:"flex items-end gap-2 mb-2",children:[(0,t.jsxs)("span",{className:"text-4xl font-bold",children:[a?Math.round(100*a.completionRate):0,"%"]}),(0,t.jsx)("span",{className:"text-muted-foreground mb-1",children:"å®Œæˆç‡"})]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["å·²å®Œæˆ ",a?.completedCount??0," / ",a?.totalCount??0," é¡¹ä»»åŠ¡"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)(B,{className:"h-4 w-4"}),(0,t.jsx)("h3",{className:"text-sm font-semibold",children:"åˆ†ç±»ç»Ÿè®¡"})]}),s&&s.length>0?(0,t.jsx)("div",{className:"space-y-3",children:s.map(e=>{let r;return(0,t.jsxs)("div",{className:"p-4 rounded-xl bg-muted/20 border border-border/40",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-2xl",children:e.typeIcon}),(0,t.jsx)("span",{className:"font-medium",children:e.typeName})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-lg font-bold",children:e.completedCount}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:"å·²å®Œæˆ"})]})]}),(0,t.jsx)("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-gradient-to-r from-purple-500 to-pink-500 transition-all duration-500",style:{width:`${0===(r=e.completedCount+(e.pendingCount||0))?0:Math.round(e.completedCount/r*100)}%`}})})]},e.typeId)})}):(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,t.jsx)(W,{className:"h-12 w-12 mx-auto mb-3 opacity-40"}),(0,t.jsx)("p",{className:"text-sm",children:"æœ¬æœˆè¿˜æ²¡æœ‰å®Œæˆçš„ä»»åŠ¡"}),(0,t.jsx)("p",{className:"text-xs mt-1",children:"å¼€å§‹æ·»åŠ å¹¶å®Œæˆä»»åŠ¡æ¥æŸ¥çœ‹ç»Ÿè®¡å§"})]})]}),a&&Math.round(100*a.completionRate)>=80&&(0,t.jsx)("div",{className:"p-4 rounded-xl bg-gradient-to-r from-amber-500/10 to-orange-500/10 border border-amber-500/20",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-amber-600 dark:text-amber-400",children:[(0,t.jsx)(U,{className:"h-5 w-5"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-semibold",children:"å¤ªæ£’äº†ï¼"}),(0,t.jsx)("div",{className:"text-xs",children:"æœ¬æœˆå®Œæˆç‡è¶…è¿‡80%ï¼Œç»§ç»­ä¿æŒï¼"})]})]})})]})})]})]}):null}var p=p;let X=(0,a.default)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),Z=(0,a.default)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);function J({open:e,onOpenChange:n}){let[a,s]=(0,r.useState)([{id:"1",role:"assistant",content:"ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„ AI åŠ©æ‰‹ï¼Œå¯ä»¥å¸®ä½ ç®¡ç†å¾…åŠäº‹é¡¹ã€æä¾›å»ºè®®å’Œå›ç­”é—®é¢˜ã€‚æœ‰ä»€ä¹ˆå¯ä»¥å¸®ä½ çš„å—ï¼Ÿ"}]),[o,l]=(0,r.useState)(""),[i,d]=(0,r.useState)(!1),c=(0,r.useRef)(null);(0,r.useEffect)(()=>{c.current?.scrollIntoView({behavior:"smooth"})},[a]);let u=async e=>{if(e.preventDefault(),!o.trim())return;let t={id:Date.now().toString(),role:"user",content:o};s(e=>[...e,t]),l(""),d(!0),setTimeout(()=>{let e={id:(Date.now()+1).toString(),role:"assistant",content:"è¿™æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿçš„ AI å›å¤ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šè°ƒç”¨çœŸå®çš„ AI API æ¥ç”Ÿæˆå›å¤ã€‚"};s(t=>[...t,e]),d(!1)},1500)};return e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-40 bg-black/40 backdrop-blur-sm",onClick:()=>n(!1)}),(0,t.jsxs)("div",{className:"fixed inset-x-0 bottom-0 z-50 bg-background rounded-t-3xl shadow-2xl animate-slide-up pb-safe h-[85vh] flex flex-col",children:[(0,t.jsxs)("div",{className:"px-5 py-4 border-b border-border/40 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center",children:(0,t.jsx)(Z,{className:"h-4 w-4 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"AI åŠ©æ‰‹"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"éšæ—¶ä¸ºä½ è§£ç­”"})]})]}),(0,t.jsx)("button",{onClick:()=>n(!1),className:"w-8 h-8 rounded-full bg-muted/50 flex items-center justify-center active:scale-95 transition-transform",children:(0,t.jsx)(p.default,{className:"h-4 w-4"})})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto px-5 py-4 space-y-4",children:[a.map(e=>(0,t.jsx)("div",{className:`flex ${"user"===e.role?"justify-end":"justify-start"}`,children:(0,t.jsx)("div",{className:`max-w-[80%] px-4 py-3 rounded-2xl ${"user"===e.role?"bg-foreground text-background":"bg-muted/40 text-foreground"}`,children:(0,t.jsx)("p",{className:"text-sm leading-relaxed",children:e.content})})},e.id)),i&&(0,t.jsx)("div",{className:"flex justify-start",children:(0,t.jsx)("div",{className:"bg-muted/40 px-4 py-3 rounded-2xl",children:(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)("span",{className:"w-2 h-2 rounded-full bg-muted-foreground/50 animate-bounce",style:{animationDelay:"0ms"}}),(0,t.jsx)("span",{className:"w-2 h-2 rounded-full bg-muted-foreground/50 animate-bounce",style:{animationDelay:"150ms"}}),(0,t.jsx)("span",{className:"w-2 h-2 rounded-full bg-muted-foreground/50 animate-bounce",style:{animationDelay:"300ms"}})]})})}),(0,t.jsx)("div",{ref:c})]}),(0,t.jsx)("form",{onSubmit:u,className:"px-5 py-4 border-t border-border/40",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:o,onChange:e=>l(e.target.value),placeholder:"è¾“å…¥ä½ çš„é—®é¢˜...",className:"flex-1 px-4 py-3 rounded-xl border border-border/40 bg-background text-sm focus:outline-none focus:ring-2 focus:ring-foreground/20"}),(0,t.jsx)("button",{type:"submit",disabled:!o.trim(),className:"w-12 h-12 rounded-xl bg-foreground text-background flex items-center justify-center active:scale-95 transition-transform disabled:opacity-40 disabled:active:scale-100",children:(0,t.jsx)(X,{className:"h-5 w-5"})})]})})]})]}):null}var Q=e.i(95185);let ee=(0,a.default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),et=(0,a.default)("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),er=(0,a.default)("CalendarRange",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]]);var en=e.i(56205);let ea=(0,a.default)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var es=e.i(88896),eo=e.i(78815),el=e.i(25758),ei=e.i(69591),ed="Avatar",[ec,eu]=(0,es.createContextScope)(ed),[em,ef]=ec(ed),ep=r.forwardRef((e,n)=>{let{__scopeAvatar:a,...s}=e,[o,l]=r.useState("idle");return(0,t.jsx)(em,{scope:a,imageLoadingStatus:o,onImageLoadingStatusChange:l,children:(0,t.jsx)(ei.Primitive.span,{...s,ref:n})})});ep.displayName=ed;var ex="AvatarImage";r.forwardRef((e,n)=>{let{__scopeAvatar:a,src:s,onLoadingStatusChange:o=()=>{},...l}=e,i=ef(ex,a),d=function(e,t){let[n,a]=r.useState("idle");return(0,el.useLayoutEffect)(()=>{if(!e)return void a("error");let r=!0,n=new window.Image,s=e=>()=>{r&&a(e)};return a("loading"),n.onload=s("loaded"),n.onerror=s("error"),n.src=e,t&&(n.referrerPolicy=t),()=>{r=!1}},[e,t]),n}(s,l.referrerPolicy),c=(0,eo.useCallbackRef)(e=>{o(e),i.onImageLoadingStatusChange(e)});return(0,el.useLayoutEffect)(()=>{"idle"!==d&&c(d)},[d,c]),"loaded"===d?(0,t.jsx)(ei.Primitive.img,{...l,ref:n,src:s}):null}).displayName=ex;var eh="AvatarFallback",eg=r.forwardRef((e,n)=>{let{__scopeAvatar:a,delayMs:s,...o}=e,l=ef(eh,a),[i,d]=r.useState(void 0===s);return r.useEffect(()=>{if(void 0!==s){let e=window.setTimeout(()=>d(!0),s);return()=>window.clearTimeout(e)}},[s]),i&&"loaded"!==l.imageLoadingStatus?(0,t.jsx)(ei.Primitive.span,{...o,ref:n}):null});eg.displayName=eh;var eb=e.i(11344);function ey({className:e,...r}){return(0,t.jsx)(ep,{"data-slot":"avatar",className:(0,eb.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",e),...r})}function ev({className:e,...r}){return(0,t.jsx)(eg,{"data-slot":"avatar-fallback",className:(0,eb.cn)("bg-muted flex size-full items-center justify-center rounded-full",e),...r})}var ew=e.i(75275),ej=e.i(3351),eN=e.i(73140),ek=e.i(80749);function eC(e){let n=e+"CollectionProvider",[a,s]=(0,es.createContextScope)(n),[o,l]=a(n,{collectionRef:{current:null},itemMap:new Map}),i=e=>{let{scope:n,children:a}=e,s=r.default.useRef(null),l=r.default.useRef(new Map).current;return(0,t.jsx)(o,{scope:n,itemMap:l,collectionRef:s,children:a})};i.displayName=n;let d=e+"CollectionSlot",c=r.default.forwardRef((e,r)=>{let{scope:n,children:a}=e,s=l(d,n),o=(0,ej.useComposedRefs)(r,s.collectionRef);return(0,t.jsx)(ek.Slot,{ref:o,children:a})});c.displayName=d;let u=e+"CollectionItemSlot",m="data-radix-collection-item",f=r.default.forwardRef((e,n)=>{let{scope:a,children:s,...o}=e,i=r.default.useRef(null),d=(0,ej.useComposedRefs)(n,i),c=l(u,a);return r.default.useEffect(()=>(c.itemMap.set(i,{ref:i,...o}),()=>void c.itemMap.delete(i))),(0,t.jsx)(ek.Slot,{...{[m]:""},ref:d,children:s})});return f.displayName=u,[{Provider:i,Slot:c,ItemSlot:f},function(t){let n=l(e+"CollectionConsumer",t);return r.default.useCallback(()=>{let e=n.collectionRef.current;if(!e)return[];let t=Array.from(e.querySelectorAll(`[${m}]`));return Array.from(n.itemMap.values()).sort((e,r)=>t.indexOf(e.ref.current)-t.indexOf(r.ref.current))},[n.collectionRef,n.itemMap])},s]}var eS=r.createContext(void 0);function eM(e){let t=r.useContext(eS);return e||t||"ltr"}var eE=e.i(16758),eR=e.i(58530),eD=e.i(35131),eT=e.i(52419);let eI=["top","right","bottom","left"],eA=Math.min,eP=Math.max,eO=Math.round,eL=Math.floor,eF=e=>({x:e,y:e}),e$={left:"right",right:"left",bottom:"top",top:"bottom"},e_={start:"end",end:"start"};function eH(e,t){return"function"==typeof e?e(t):e}function ez(e){return e.split("-")[0]}function eV(e){return e.split("-")[1]}function eq(e){return"x"===e?"y":"x"}function eK(e){return"y"===e?"height":"width"}let eW=new Set(["top","bottom"]);function eU(e){return eW.has(ez(e))?"y":"x"}function eB(e){return e.replace(/start|end/g,e=>e_[e])}let eY=["left","right"],eG=["right","left"],eX=["top","bottom"],eZ=["bottom","top"];function eJ(e){return e.replace(/left|right|bottom|top/g,e=>e$[e])}function eQ(e){return"number"!=typeof e?{top:0,right:0,bottom:0,left:0,...e}:{top:e,right:e,bottom:e,left:e}}function e0(e){let{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function e1(e,t,r){let n,{reference:a,floating:s}=e,o=eU(t),l=eq(eU(t)),i=eK(l),d=ez(t),c="y"===o,u=a.x+a.width/2-s.width/2,m=a.y+a.height/2-s.height/2,f=a[i]/2-s[i]/2;switch(d){case"top":n={x:u,y:a.y-s.height};break;case"bottom":n={x:u,y:a.y+a.height};break;case"right":n={x:a.x+a.width,y:m};break;case"left":n={x:a.x-s.width,y:m};break;default:n={x:a.x,y:a.y}}switch(eV(t)){case"start":n[l]-=f*(r&&c?-1:1);break;case"end":n[l]+=f*(r&&c?-1:1)}return n}let e2=async(e,t,r)=>{let{placement:n="bottom",strategy:a="absolute",middleware:s=[],platform:o}=r,l=s.filter(Boolean),i=await (null==o.isRTL?void 0:o.isRTL(t)),d=await o.getElementRects({reference:e,floating:t,strategy:a}),{x:c,y:u}=e1(d,n,i),m=n,f={},p=0;for(let r=0;r<l.length;r++){let{name:s,fn:x}=l[r],{x:h,y:g,data:b,reset:y}=await x({x:c,y:u,initialPlacement:n,placement:m,strategy:a,middlewareData:f,rects:d,platform:o,elements:{reference:e,floating:t}});c=null!=h?h:c,u=null!=g?g:u,f={...f,[s]:{...f[s],...b}},y&&p<=50&&(p++,"object"==typeof y&&(y.placement&&(m=y.placement),y.rects&&(d=!0===y.rects?await o.getElementRects({reference:e,floating:t,strategy:a}):y.rects),{x:c,y:u}=e1(d,m,i)),r=-1)}return{x:c,y:u,placement:m,strategy:a,middlewareData:f}};async function e5(e,t){var r;void 0===t&&(t={});let{x:n,y:a,platform:s,rects:o,elements:l,strategy:i}=e,{boundary:d="clippingAncestors",rootBoundary:c="viewport",elementContext:u="floating",altBoundary:m=!1,padding:f=0}=eH(t,e),p=eQ(f),x=l[m?"floating"===u?"reference":"floating":u],h=e0(await s.getClippingRect({element:null==(r=await (null==s.isElement?void 0:s.isElement(x)))||r?x:x.contextElement||await (null==s.getDocumentElement?void 0:s.getDocumentElement(l.floating)),boundary:d,rootBoundary:c,strategy:i})),g="floating"===u?{x:n,y:a,width:o.floating.width,height:o.floating.height}:o.reference,b=await (null==s.getOffsetParent?void 0:s.getOffsetParent(l.floating)),y=await (null==s.isElement?void 0:s.isElement(b))&&await (null==s.getScale?void 0:s.getScale(b))||{x:1,y:1},v=e0(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:g,offsetParent:b,strategy:i}):g);return{top:(h.top-v.top+p.top)/y.y,bottom:(v.bottom-h.bottom+p.bottom)/y.y,left:(h.left-v.left+p.left)/y.x,right:(v.right-h.right+p.right)/y.x}}function e4(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function e3(e){return eI.some(t=>e[t]>=0)}let e8=new Set(["left","top"]);async function e6(e,t){let{placement:r,platform:n,elements:a}=e,s=await (null==n.isRTL?void 0:n.isRTL(a.floating)),o=ez(r),l=eV(r),i="y"===eU(r),d=e8.has(o)?-1:1,c=s&&i?-1:1,u=eH(t,e),{mainAxis:m,crossAxis:f,alignmentAxis:p}="number"==typeof u?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return l&&"number"==typeof p&&(f="end"===l?-1*p:p),i?{x:f*c,y:m*d}:{x:m*d,y:f*c}}function e9(){return"undefined"!=typeof window}function e7(e){return tr(e)?(e.nodeName||"").toLowerCase():"#document"}function te(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function tt(e){var t;return null==(t=(tr(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function tr(e){return!!e9()&&(e instanceof Node||e instanceof te(e).Node)}function tn(e){return!!e9()&&(e instanceof Element||e instanceof te(e).Element)}function ta(e){return!!e9()&&(e instanceof HTMLElement||e instanceof te(e).HTMLElement)}function ts(e){return!!e9()&&"undefined"!=typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof te(e).ShadowRoot)}let to=new Set(["inline","contents"]);function tl(e){let{overflow:t,overflowX:r,overflowY:n,display:a}=tb(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!to.has(a)}let ti=new Set(["table","td","th"]),td=[":popover-open",":modal"];function tc(e){return td.some(t=>{try{return e.matches(t)}catch(e){return!1}})}let tu=["transform","translate","scale","rotate","perspective"],tm=["transform","translate","scale","rotate","perspective","filter"],tf=["paint","layout","strict","content"];function tp(e){let t=tx(),r=tn(e)?tb(e):e;return tu.some(e=>!!r[e]&&"none"!==r[e])||!!r.containerType&&"normal"!==r.containerType||!t&&!!r.backdropFilter&&"none"!==r.backdropFilter||!t&&!!r.filter&&"none"!==r.filter||tm.some(e=>(r.willChange||"").includes(e))||tf.some(e=>(r.contain||"").includes(e))}function tx(){return"undefined"!=typeof CSS&&!!CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")}let th=new Set(["html","body","#document"]);function tg(e){return th.has(e7(e))}function tb(e){return te(e).getComputedStyle(e)}function ty(e){return tn(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function tv(e){if("html"===e7(e))return e;let t=e.assignedSlot||e.parentNode||ts(e)&&e.host||tt(e);return ts(t)?t.host:t}function tw(e,t,r){var n;void 0===t&&(t=[]),void 0===r&&(r=!0);let a=function e(t){let r=tv(t);return tg(r)?t.ownerDocument?t.ownerDocument.body:t.body:ta(r)&&tl(r)?r:e(r)}(e),s=a===(null==(n=e.ownerDocument)?void 0:n.body),o=te(a);if(s){let e=tj(o);return t.concat(o,o.visualViewport||[],tl(a)?a:[],e&&r?tw(e):[])}return t.concat(a,tw(a,[],r))}function tj(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function tN(e){let t=tb(e),r=parseFloat(t.width)||0,n=parseFloat(t.height)||0,a=ta(e),s=a?e.offsetWidth:r,o=a?e.offsetHeight:n,l=eO(r)!==s||eO(n)!==o;return l&&(r=s,n=o),{width:r,height:n,$:l}}function tk(e){return tn(e)?e:e.contextElement}function tC(e){let t=tk(e);if(!ta(t))return eF(1);let r=t.getBoundingClientRect(),{width:n,height:a,$:s}=tN(t),o=(s?eO(r.width):r.width)/n,l=(s?eO(r.height):r.height)/a;return o&&Number.isFinite(o)||(o=1),l&&Number.isFinite(l)||(l=1),{x:o,y:l}}let tS=eF(0);function tM(e){let t=te(e);return tx()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:tS}function tE(e,t,r,n){var a;void 0===t&&(t=!1),void 0===r&&(r=!1);let s=e.getBoundingClientRect(),o=tk(e),l=eF(1);t&&(n?tn(n)&&(l=tC(n)):l=tC(e));let i=(void 0===(a=r)&&(a=!1),n&&(!a||n===te(o))&&a)?tM(o):eF(0),d=(s.left+i.x)/l.x,c=(s.top+i.y)/l.y,u=s.width/l.x,m=s.height/l.y;if(o){let e=te(o),t=n&&tn(n)?te(n):n,r=e,a=tj(r);for(;a&&n&&t!==r;){let e=tC(a),t=a.getBoundingClientRect(),n=tb(a),s=t.left+(a.clientLeft+parseFloat(n.paddingLeft))*e.x,o=t.top+(a.clientTop+parseFloat(n.paddingTop))*e.y;d*=e.x,c*=e.y,u*=e.x,m*=e.y,d+=s,c+=o,a=tj(r=te(a))}}return e0({width:u,height:m,x:d,y:c})}function tR(e,t){let r=ty(e).scrollLeft;return t?t.left+r:tE(tt(e)).left+r}function tD(e,t){let r=e.getBoundingClientRect();return{x:r.left+t.scrollLeft-tR(e,r),y:r.top+t.scrollTop}}let tT=new Set(["absolute","fixed"]);function tI(e,t,r){var n;let a;if("viewport"===t)a=function(e,t){let r=te(e),n=tt(e),a=r.visualViewport,s=n.clientWidth,o=n.clientHeight,l=0,i=0;if(a){s=a.width,o=a.height;let e=tx();(!e||e&&"fixed"===t)&&(l=a.offsetLeft,i=a.offsetTop)}let d=tR(n);if(d<=0){let e=n.ownerDocument,t=e.body,r=getComputedStyle(t),a="CSS1Compat"===e.compatMode&&parseFloat(r.marginLeft)+parseFloat(r.marginRight)||0,o=Math.abs(n.clientWidth-t.clientWidth-a);o<=25&&(s-=o)}else d<=25&&(s+=d);return{width:s,height:o,x:l,y:i}}(e,r);else if("document"===t){let t,r,s,o,l,i,d;n=tt(e),t=tt(n),r=ty(n),s=n.ownerDocument.body,o=eP(t.scrollWidth,t.clientWidth,s.scrollWidth,s.clientWidth),l=eP(t.scrollHeight,t.clientHeight,s.scrollHeight,s.clientHeight),i=-r.scrollLeft+tR(n),d=-r.scrollTop,"rtl"===tb(s).direction&&(i+=eP(t.clientWidth,s.clientWidth)-o),a={width:o,height:l,x:i,y:d}}else if(tn(t)){let e,n,s,o,l,i;n=(e=tE(t,!0,"fixed"===r)).top+t.clientTop,s=e.left+t.clientLeft,o=ta(t)?tC(t):eF(1),l=t.clientWidth*o.x,i=t.clientHeight*o.y,a={width:l,height:i,x:s*o.x,y:n*o.y}}else{let r=tM(e);a={x:t.x-r.x,y:t.y-r.y,width:t.width,height:t.height}}return e0(a)}function tA(e){return"static"===tb(e).position}function tP(e,t){if(!ta(e)||"fixed"===tb(e).position)return null;if(t)return t(e);let r=e.offsetParent;return tt(e)===r&&(r=r.ownerDocument.body),r}function tO(e,t){var r;let n=te(e);if(tc(e))return n;if(!ta(e)){let t=tv(e);for(;t&&!tg(t);){if(tn(t)&&!tA(t))return t;t=tv(t)}return n}let a=tP(e,t);for(;a&&(r=a,ti.has(e7(r)))&&tA(a);)a=tP(a,t);return a&&tg(a)&&tA(a)&&!tp(a)?n:a||function(e){let t=tv(e);for(;ta(t)&&!tg(t);){if(tp(t))return t;if(tc(t))break;t=tv(t)}return null}(e)||n}let tL=async function(e){let t=this.getOffsetParent||tO,r=this.getDimensions,n=await r(e.floating);return{reference:function(e,t,r){let n=ta(t),a=tt(t),s="fixed"===r,o=tE(e,!0,s,t),l={scrollLeft:0,scrollTop:0},i=eF(0);if(n||!n&&!s)if(("body"!==e7(t)||tl(a))&&(l=ty(t)),n){let e=tE(t,!0,s,t);i.x=e.x+t.clientLeft,i.y=e.y+t.clientTop}else a&&(i.x=tR(a));s&&!n&&a&&(i.x=tR(a));let d=!a||n||s?eF(0):tD(a,l);return{x:o.left+l.scrollLeft-i.x-d.x,y:o.top+l.scrollTop-i.y-d.y,width:o.width,height:o.height}}(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}},tF={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e,s="fixed"===a,o=tt(n),l=!!t&&tc(t.floating);if(n===o||l&&s)return r;let i={scrollLeft:0,scrollTop:0},d=eF(1),c=eF(0),u=ta(n);if((u||!u&&!s)&&(("body"!==e7(n)||tl(o))&&(i=ty(n)),ta(n))){let e=tE(n);d=tC(n),c.x=e.x+n.clientLeft,c.y=e.y+n.clientTop}let m=!o||u||s?eF(0):tD(o,i);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-i.scrollLeft*d.x+c.x+m.x,y:r.y*d.y-i.scrollTop*d.y+c.y+m.y}},getDocumentElement:tt,getClippingRect:function(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e,s=[..."clippingAncestors"===r?tc(t)?[]:function(e,t){let r=t.get(e);if(r)return r;let n=tw(e,[],!1).filter(e=>tn(e)&&"body"!==e7(e)),a=null,s="fixed"===tb(e).position,o=s?tv(e):e;for(;tn(o)&&!tg(o);){let t=tb(o),r=tp(o);r||"fixed"!==t.position||(a=null),(s?!r&&!a:!r&&"static"===t.position&&!!a&&tT.has(a.position)||tl(o)&&!r&&function e(t,r){let n=tv(t);return!(n===r||!tn(n)||tg(n))&&("fixed"===tb(n).position||e(n,r))}(e,o))?n=n.filter(e=>e!==o):a=t,o=tv(o)}return t.set(e,n),n}(t,this._c):[].concat(r),n],o=s[0],l=s.reduce((e,r)=>{let n=tI(t,r,a);return e.top=eP(n.top,e.top),e.right=eA(n.right,e.right),e.bottom=eA(n.bottom,e.bottom),e.left=eP(n.left,e.left),e},tI(t,o,a));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},getOffsetParent:tO,getElementRects:tL,getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){let{width:t,height:r}=tN(e);return{width:t,height:r}},getScale:tC,isElement:tn,isRTL:function(e){return"rtl"===tb(e).direction}};function t$(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}let t_=e=>({name:"arrow",options:e,async fn(t){let{x:r,y:n,placement:a,rects:s,platform:o,elements:l,middlewareData:i}=t,{element:d,padding:c=0}=eH(e,t)||{};if(null==d)return{};let u=eQ(c),m={x:r,y:n},f=eq(eU(a)),p=eK(f),x=await o.getDimensions(d),h="y"===f,g=h?"clientHeight":"clientWidth",b=s.reference[p]+s.reference[f]-m[f]-s.floating[p],y=m[f]-s.reference[f],v=await (null==o.getOffsetParent?void 0:o.getOffsetParent(d)),w=v?v[g]:0;w&&await (null==o.isElement?void 0:o.isElement(v))||(w=l.floating[g]||s.floating[p]);let j=w/2-x[p]/2-1,N=eA(u[h?"top":"left"],j),k=eA(u[h?"bottom":"right"],j),C=w-x[p]-k,S=w/2-x[p]/2+(b/2-y/2),M=eP(N,eA(S,C)),E=!i.arrow&&null!=eV(a)&&S!==M&&s.reference[p]/2-(S<N?N:k)-x[p]/2<0,R=E?S<N?S-N:S-C:0;return{[f]:m[f]+R,data:{[f]:M,centerOffset:S-M-R,...E&&{alignmentOffset:R}},reset:E}}});var tH=e.i(16657),tz="undefined"!=typeof document?r.useLayoutEffect:function(){};function tV(e,t){let r,n,a;if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if((r=e.length)!==t.length)return!1;for(n=r;0!=n--;)if(!tV(e[n],t[n]))return!1;return!0}if((r=(a=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(n=r;0!=n--;)if(!({}).hasOwnProperty.call(t,a[n]))return!1;for(n=r;0!=n--;){let r=a[n];if(("_owner"!==r||!e.$$typeof)&&!tV(e[r],t[r]))return!1}return!0}return e!=e&&t!=t}function tq(e){return"undefined"==typeof window?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function tK(e,t){let r=tq(e);return Math.round(t*r)/r}function tW(e){let t=r.useRef(e);return tz(()=>{t.current=e}),t}var tU=r.forwardRef((e,r)=>{let{children:n,width:a=10,height:s=5,...o}=e;return(0,t.jsx)(ei.Primitive.svg,{...o,ref:r,width:a,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:(0,t.jsx)("polygon",{points:"0,0 30,0 15,10"})})});tU.displayName="Arrow";var tB="Popper",[tY,tG]=(0,es.createContextScope)(tB),[tX,tZ]=tY(tB),tJ=e=>{let{__scopePopper:n,children:a}=e,[s,o]=r.useState(null);return(0,t.jsx)(tX,{scope:n,anchor:s,onAnchorChange:o,children:a})};tJ.displayName=tB;var tQ="PopperAnchor",t0=r.forwardRef((e,n)=>{let{__scopePopper:a,virtualRef:s,...o}=e,l=tZ(tQ,a),i=r.useRef(null),d=(0,ej.useComposedRefs)(n,i);return r.useEffect(()=>{l.onAnchorChange(s?.current||i.current)}),s?null:(0,t.jsx)(ei.Primitive.div,{...o,ref:d})});t0.displayName=tQ;var t1="PopperContent",[t2,t5]=tY(t1),t4=r.forwardRef((e,n)=>{var a,s,o,l,i,d,c,u,m,f,p,x,h;let{__scopePopper:g,side:b="bottom",sideOffset:y=0,align:v="center",alignOffset:w=0,arrowPadding:j=0,avoidCollisions:N=!0,collisionBoundary:k=[],collisionPadding:C=0,sticky:S="partial",hideWhenDetached:M=!1,updatePositionStrategy:E="optimized",onPlaced:R,...D}=e,T=tZ(t1,g),[I,A]=r.useState(null),P=(0,ej.useComposedRefs)(n,e=>A(e)),[O,L]=r.useState(null),F=function(e){let[t,n]=r.useState(void 0);return(0,el.useLayoutEffect)(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let r,a;if(!Array.isArray(t)||!t.length)return;let s=t[0];if("borderBoxSize"in s){let e=s.borderBoxSize,t=Array.isArray(e)?e[0]:e;r=t.inlineSize,a=t.blockSize}else r=e.offsetWidth,a=e.offsetHeight;n({width:r,height:a})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}n(void 0)},[e]),t}(O),$=F?.width??0,_=F?.height??0,H="number"==typeof C?C:{top:0,right:0,bottom:0,left:0,...C},z=Array.isArray(k)?k:[k],V=z.length>0,q={padding:H,boundary:z.filter(t9),altBoundary:V},{refs:K,floatingStyles:W,placement:U,isPositioned:B,middlewareData:Y}=function(e){void 0===e&&(e={});let{placement:t="bottom",strategy:n="absolute",middleware:a=[],platform:s,elements:{reference:o,floating:l}={},transform:i=!0,whileElementsMounted:d,open:c}=e,[u,m]=r.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,p]=r.useState(a);tV(f,a)||p(a);let[x,h]=r.useState(null),[g,b]=r.useState(null),y=r.useCallback(e=>{e!==N.current&&(N.current=e,h(e))},[]),v=r.useCallback(e=>{e!==k.current&&(k.current=e,b(e))},[]),w=o||x,j=l||g,N=r.useRef(null),k=r.useRef(null),C=r.useRef(u),S=null!=d,M=tW(d),E=tW(s),R=tW(c),D=r.useCallback(()=>{var e,r;let a,s,o;if(!N.current||!k.current)return;let l={placement:t,strategy:n,middleware:f};E.current&&(l.platform=E.current),(e=N.current,r=k.current,a=new Map,o={...(s={platform:tF,...l}).platform,_c:a},e2(e,r,{...s,platform:o})).then(e=>{let t={...e,isPositioned:!1!==R.current};T.current&&!tV(C.current,t)&&(C.current=t,tH.flushSync(()=>{m(t)}))})},[f,t,n,E,R]);tz(()=>{!1===c&&C.current.isPositioned&&(C.current.isPositioned=!1,m(e=>({...e,isPositioned:!1})))},[c]);let T=r.useRef(!1);tz(()=>(T.current=!0,()=>{T.current=!1}),[]),tz(()=>{if(w&&(N.current=w),j&&(k.current=j),w&&j){if(M.current)return M.current(w,j,D);D()}},[w,j,D,M,S]);let I=r.useMemo(()=>({reference:N,floating:k,setReference:y,setFloating:v}),[y,v]),A=r.useMemo(()=>({reference:w,floating:j}),[w,j]),P=r.useMemo(()=>{let e={position:n,left:0,top:0};if(!A.floating)return e;let t=tK(A.floating,u.x),r=tK(A.floating,u.y);return i?{...e,transform:"translate("+t+"px, "+r+"px)",...tq(A.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:t,top:r}},[n,i,A.floating,u.x,u.y]);return r.useMemo(()=>({...u,update:D,refs:I,elements:A,floatingStyles:P}),[u,D,I,A,P])}({strategy:"fixed",placement:b+("center"!==v?"-"+v:""),whileElementsMounted:(...e)=>(function(e,t,r,n){let a;void 0===n&&(n={});let{ancestorScroll:s=!0,ancestorResize:o=!0,elementResize:l="function"==typeof ResizeObserver,layoutShift:i="function"==typeof IntersectionObserver,animationFrame:d=!1}=n,c=tk(e),u=s||o?[...c?tw(c):[],...tw(t)]:[];u.forEach(e=>{s&&e.addEventListener("scroll",r,{passive:!0}),o&&e.addEventListener("resize",r)});let m=c&&i?function(e,t){let r,n=null,a=tt(e);function s(){var e;clearTimeout(r),null==(e=n)||e.disconnect(),n=null}return!function o(l,i){void 0===l&&(l=!1),void 0===i&&(i=1),s();let d=e.getBoundingClientRect(),{left:c,top:u,width:m,height:f}=d;if(l||t(),!m||!f)return;let p={rootMargin:-eL(u)+"px "+-eL(a.clientWidth-(c+m))+"px "+-eL(a.clientHeight-(u+f))+"px "+-eL(c)+"px",threshold:eP(0,eA(1,i))||1},x=!0;function h(t){let n=t[0].intersectionRatio;if(n!==i){if(!x)return o();n?o(!1,n):r=setTimeout(()=>{o(!1,1e-7)},1e3)}1!==n||t$(d,e.getBoundingClientRect())||o(),x=!1}try{n=new IntersectionObserver(h,{...p,root:a.ownerDocument})}catch(e){n=new IntersectionObserver(h,p)}n.observe(e)}(!0),s}(c,r):null,f=-1,p=null;l&&(p=new ResizeObserver(e=>{let[n]=e;n&&n.target===c&&p&&(p.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var e;null==(e=p)||e.observe(t)})),r()}),c&&!d&&p.observe(c),p.observe(t));let x=d?tE(e):null;return d&&function t(){let n=tE(e);x&&!t$(x,n)&&r(),x=n,a=requestAnimationFrame(t)}(),r(),()=>{var e;u.forEach(e=>{s&&e.removeEventListener("scroll",r),o&&e.removeEventListener("resize",r)}),null==m||m(),null==(e=p)||e.disconnect(),p=null,d&&cancelAnimationFrame(a)}})(...e,{animationFrame:"always"===E}),elements:{reference:T.anchor},middleware:[{...{name:"offset",options:s=a={mainAxis:y+_,alignmentAxis:w},async fn(e){var t,r;let{x:n,y:a,placement:o,middlewareData:l}=e,i=await e6(e,s);return o===(null==(t=l.offset)?void 0:t.placement)&&null!=(r=l.arrow)&&r.alignmentOffset?{}:{x:n+i.x,y:a+i.y,data:{...i,placement:o}}}},options:[a,void 0]},N&&{...{name:"shift",options:i=l={mainAxis:!0,crossAxis:!1,limiter:"partial"===S?{...(o=void 0,{options:o={},fn(e){let{x:t,y:r,placement:n,rects:a,middlewareData:s}=e,{offset:l=0,mainAxis:i=!0,crossAxis:d=!0}=eH(o,e),c={x:t,y:r},u=eU(n),m=eq(u),f=c[m],p=c[u],x=eH(l,e),h="number"==typeof x?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(i){let e="y"===m?"height":"width",t=a.reference[m]-a.floating[e]+h.mainAxis,r=a.reference[m]+a.reference[e]-h.mainAxis;f<t?f=t:f>r&&(f=r)}if(d){var g,b;let e="y"===m?"width":"height",t=e8.has(ez(n)),r=a.reference[u]-a.floating[e]+(t&&(null==(g=s.offset)?void 0:g[u])||0)+(t?0:h.crossAxis),o=a.reference[u]+a.reference[e]+(t?0:(null==(b=s.offset)?void 0:b[u])||0)-(t?h.crossAxis:0);p<r?p=r:p>o&&(p=o)}return{[m]:f,[u]:p}}}),options:[void 0,void 0]}:void 0,...q},async fn(e){let{x:t,y:r,placement:n}=e,{mainAxis:a=!0,crossAxis:s=!1,limiter:o={fn:e=>{let{x:t,y:r}=e;return{x:t,y:r}}},...l}=eH(i,e),d={x:t,y:r},c=await e5(e,l),u=eU(ez(n)),m=eq(u),f=d[m],p=d[u];if(a){let e="y"===m?"top":"left",t="y"===m?"bottom":"right",r=f+c[e],n=f-c[t];f=eP(r,eA(f,n))}if(s){let e="y"===u?"top":"left",t="y"===u?"bottom":"right",r=p+c[e],n=p-c[t];p=eP(r,eA(p,n))}let x=o.fn({...e,[m]:f,[u]:p});return{...x,data:{x:x.x-t,y:x.y-r,enabled:{[m]:a,[u]:s}}}}},options:[l,void 0]},N&&{...{name:"flip",options:c=d={...q},async fn(e){var t,r,n,a,s,o,l,i;let d,u,m,{placement:f,middlewareData:p,rects:x,initialPlacement:h,platform:g,elements:b}=e,{mainAxis:y=!0,crossAxis:v=!0,fallbackPlacements:w,fallbackStrategy:j="bestFit",fallbackAxisSideDirection:N="none",flipAlignment:k=!0,...C}=eH(c,e);if(null!=(t=p.arrow)&&t.alignmentOffset)return{};let S=ez(f),M=eU(h),E=ez(h)===h,R=await (null==g.isRTL?void 0:g.isRTL(b.floating)),D=w||(E||!k?[eJ(h)]:(d=eJ(h),[eB(h),d,eB(d)])),T="none"!==N;!w&&T&&D.push(...(u=eV(h),m=function(e,t,r){switch(e){case"top":case"bottom":if(r)return t?eG:eY;return t?eY:eG;case"left":case"right":return t?eX:eZ;default:return[]}}(ez(h),"start"===N,R),u&&(m=m.map(e=>e+"-"+u),k&&(m=m.concat(m.map(eB)))),m));let I=[h,...D],A=await e5(e,C),P=[],O=(null==(r=p.flip)?void 0:r.overflows)||[];if(y&&P.push(A[S]),v){let e,t,r,n,a=(o=f,l=x,void 0===(i=R)&&(i=!1),e=eV(o),r=eK(t=eq(eU(o))),n="x"===t?e===(i?"end":"start")?"right":"left":"start"===e?"bottom":"top",l.reference[r]>l.floating[r]&&(n=eJ(n)),[n,eJ(n)]);P.push(A[a[0]],A[a[1]])}if(O=[...O,{placement:f,overflows:P}],!P.every(e=>e<=0)){let e=((null==(n=p.flip)?void 0:n.index)||0)+1,t=I[e];if(t&&("alignment"!==v||M===eU(t)||O.every(e=>eU(e.placement)!==M||e.overflows[0]>0)))return{data:{index:e,overflows:O},reset:{placement:t}};let r=null==(a=O.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:a.placement;if(!r)switch(j){case"bestFit":{let e=null==(s=O.filter(e=>{if(T){let t=eU(e.placement);return t===M||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:s[0];e&&(r=e);break}case"initialPlacement":r=h}if(f!==r)return{reset:{placement:r}}}return{}}},options:[d,void 0]},{...{name:"size",options:m=u={...q,apply:({elements:e,rects:t,availableWidth:r,availableHeight:n})=>{let{width:a,height:s}=t.reference,o=e.floating.style;o.setProperty("--radix-popper-available-width",`${r}px`),o.setProperty("--radix-popper-available-height",`${n}px`),o.setProperty("--radix-popper-anchor-width",`${a}px`),o.setProperty("--radix-popper-anchor-height",`${s}px`)}},async fn(e){var t,r;let n,a,{placement:s,rects:o,platform:l,elements:i}=e,{apply:d=()=>{},...c}=eH(m,e),u=await e5(e,c),f=ez(s),p=eV(s),x="y"===eU(s),{width:h,height:g}=o.floating;"top"===f||"bottom"===f?(n=f,a=p===(await (null==l.isRTL?void 0:l.isRTL(i.floating))?"start":"end")?"left":"right"):(a=f,n="end"===p?"top":"bottom");let b=g-u.top-u.bottom,y=h-u.left-u.right,v=eA(g-u[n],b),w=eA(h-u[a],y),j=!e.middlewareData.shift,N=v,k=w;if(null!=(t=e.middlewareData.shift)&&t.enabled.x&&(k=y),null!=(r=e.middlewareData.shift)&&r.enabled.y&&(N=b),j&&!p){let e=eP(u.left,0),t=eP(u.right,0),r=eP(u.top,0),n=eP(u.bottom,0);x?k=h-2*(0!==e||0!==t?e+t:eP(u.left,u.right)):N=g-2*(0!==r||0!==n?r+n:eP(u.top,u.bottom))}await d({...e,availableWidth:k,availableHeight:N});let C=await l.getDimensions(i.floating);return h!==C.width||g!==C.height?{reset:{rects:!0}}:{}}},options:[u,void 0]},O&&{...{name:"arrow",options:p=f={element:O,padding:j},fn(e){let{element:t,padding:r}="function"==typeof p?p(e):p;return t&&({}).hasOwnProperty.call(t,"current")?null!=t.current?t_({element:t.current,padding:r}).fn(e):{}:t?t_({element:t,padding:r}).fn(e):{}}},options:[f,void 0]},t7({arrowWidth:$,arrowHeight:_}),M&&{...{name:"hide",options:h=x={strategy:"referenceHidden",...q},async fn(e){let{rects:t}=e,{strategy:r="referenceHidden",...n}=eH(h,e);switch(r){case"referenceHidden":{let r=e4(await e5(e,{...n,elementContext:"reference"}),t.reference);return{data:{referenceHiddenOffsets:r,referenceHidden:e3(r)}}}case"escaped":{let r=e4(await e5(e,{...n,altBoundary:!0}),t.floating);return{data:{escapedOffsets:r,escaped:e3(r)}}}default:return{}}}},options:[x,void 0]}]}),[G,X]=re(U),Z=(0,eo.useCallbackRef)(R);(0,el.useLayoutEffect)(()=>{B&&Z?.()},[B,Z]);let J=Y.arrow?.x,Q=Y.arrow?.y,ee=Y.arrow?.centerOffset!==0,[et,er]=r.useState();return(0,el.useLayoutEffect)(()=>{I&&er(window.getComputedStyle(I).zIndex)},[I]),(0,t.jsx)("div",{ref:K.setFloating,"data-radix-popper-content-wrapper":"",style:{...W,transform:B?W.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:et,"--radix-popper-transform-origin":[Y.transformOrigin?.x,Y.transformOrigin?.y].join(" "),...Y.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:(0,t.jsx)(t2,{scope:g,placedSide:G,onArrowChange:L,arrowX:J,arrowY:Q,shouldHideArrow:ee,children:(0,t.jsx)(ei.Primitive.div,{"data-side":G,"data-align":X,...D,ref:P,style:{...D.style,animation:B?void 0:"none"}})})})});t4.displayName=t1;var t3="PopperArrow",t8={top:"bottom",right:"left",bottom:"top",left:"right"},t6=r.forwardRef(function(e,r){let{__scopePopper:n,...a}=e,s=t5(t3,n),o=t8[s.placedSide];return(0,t.jsx)("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:(0,t.jsx)(tU,{...a,ref:r,style:{...a.style,display:"block"}})})});function t9(e){return null!==e}t6.displayName=t3;var t7=e=>({name:"transformOrigin",options:e,fn(t){let{placement:r,rects:n,middlewareData:a}=t,s=a.arrow?.centerOffset!==0,o=s?0:e.arrowWidth,l=s?0:e.arrowHeight,[i,d]=re(r),c={start:"0%",center:"50%",end:"100%"}[d],u=(a.arrow?.x??0)+o/2,m=(a.arrow?.y??0)+l/2,f="",p="";return"bottom"===i?(f=s?c:`${u}px`,p=`${-l}px`):"top"===i?(f=s?c:`${u}px`,p=`${n.floating.height+l}px`):"right"===i?(f=`${-l}px`,p=s?c:`${m}px`):"left"===i&&(f=`${n.floating.width+l}px`,p=s?c:`${m}px`),{data:{x:f,y:p}}}});function re(e){let[t,r="center"]=e.split("-");return[t,r]}var rt=e.i(1091),rr=e.i(24041),rn="rovingFocusGroup.onEntryFocus",ra={bubbles:!1,cancelable:!0},rs="RovingFocusGroup",[ro,rl,ri]=eC(rs),[rd,rc]=(0,es.createContextScope)(rs,[ri]),[ru,rm]=rd(rs),rf=r.forwardRef((e,r)=>(0,t.jsx)(ro.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,t.jsx)(ro.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,t.jsx)(rp,{...e,ref:r})})}));rf.displayName=rs;var rp=r.forwardRef((e,n)=>{let{__scopeRovingFocusGroup:a,orientation:s,loop:o=!1,dir:l,currentTabStopId:i,defaultCurrentTabStopId:d,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:m=!1,...f}=e,p=r.useRef(null),x=(0,ej.useComposedRefs)(n,p),h=eM(l),[g=null,b]=(0,eN.useControllableState)({prop:i,defaultProp:d,onChange:c}),[y,v]=r.useState(!1),w=(0,eo.useCallbackRef)(u),j=rl(a),N=r.useRef(!1),[k,C]=r.useState(0);return r.useEffect(()=>{let e=p.current;if(e)return e.addEventListener(rn,w),()=>e.removeEventListener(rn,w)},[w]),(0,t.jsx)(ru,{scope:a,orientation:s,dir:h,loop:o,currentTabStopId:g,onItemFocus:r.useCallback(e=>b(e),[b]),onItemShiftTab:r.useCallback(()=>v(!0),[]),onFocusableItemAdd:r.useCallback(()=>C(e=>e+1),[]),onFocusableItemRemove:r.useCallback(()=>C(e=>e-1),[]),children:(0,t.jsx)(ei.Primitive.div,{tabIndex:y||0===k?-1:0,"data-orientation":s,...f,ref:x,style:{outline:"none",...e.style},onMouseDown:(0,ew.composeEventHandlers)(e.onMouseDown,()=>{N.current=!0}),onFocus:(0,ew.composeEventHandlers)(e.onFocus,e=>{let t=!N.current;if(e.target===e.currentTarget&&t&&!y){let t=new CustomEvent(rn,ra);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){let e=j().filter(e=>e.focusable);rb([e.find(e=>e.active),e.find(e=>e.id===g),...e].filter(Boolean).map(e=>e.ref.current),m)}}N.current=!1}),onBlur:(0,ew.composeEventHandlers)(e.onBlur,()=>v(!1))})})}),rx="RovingFocusGroupItem",rh=r.forwardRef((e,n)=>{let{__scopeRovingFocusGroup:a,focusable:s=!0,active:o=!1,tabStopId:l,...i}=e,d=(0,eT.useId)(),c=l||d,u=rm(rx,a),m=u.currentTabStopId===c,f=rl(a),{onFocusableItemAdd:p,onFocusableItemRemove:x}=u;return r.useEffect(()=>{if(s)return p(),()=>x()},[s,p,x]),(0,t.jsx)(ro.ItemSlot,{scope:a,id:c,focusable:s,active:o,children:(0,t.jsx)(ei.Primitive.span,{tabIndex:m?0:-1,"data-orientation":u.orientation,...i,ref:n,onMouseDown:(0,ew.composeEventHandlers)(e.onMouseDown,e=>{s?u.onItemFocus(c):e.preventDefault()}),onFocus:(0,ew.composeEventHandlers)(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:(0,ew.composeEventHandlers)(e.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey)return void u.onItemShiftTab();if(e.target!==e.currentTarget)return;let t=function(e,t,r){var n;let a=(n=e.key,"rtl"!==r?n:"ArrowLeft"===n?"ArrowRight":"ArrowRight"===n?"ArrowLeft":n);if(!("vertical"===t&&["ArrowLeft","ArrowRight"].includes(a))&&!("horizontal"===t&&["ArrowUp","ArrowDown"].includes(a)))return rg[a]}(e,u.orientation,u.dir);if(void 0!==t){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let a=f().filter(e=>e.focusable).map(e=>e.ref.current);if("last"===t)a.reverse();else if("prev"===t||"next"===t){var r,n;"prev"===t&&a.reverse();let s=a.indexOf(e.currentTarget);a=u.loop?(r=a,n=s+1,r.map((e,t)=>r[(n+t)%r.length])):a.slice(s+1)}setTimeout(()=>rb(a))}})})})});rh.displayName=rx;var rg={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function rb(e,t=!1){let r=document.activeElement;for(let n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}var ry=e.i(25857),rv=e.i(43134),rw=["Enter"," "],rj=["ArrowUp","PageDown","End"],rN=["ArrowDown","PageUp","Home",...rj],rk={ltr:[...rw,"ArrowRight"],rtl:[...rw,"ArrowLeft"]},rC={ltr:["ArrowLeft"],rtl:["ArrowRight"]},rS="Menu",[rM,rE,rR]=eC(rS),[rD,rT]=(0,es.createContextScope)(rS,[rR,tG,rc]),rI=tG(),rA=rc(),[rP,rO]=rD(rS),[rL,rF]=rD(rS),r$=e=>{let{__scopeMenu:n,open:a=!1,children:s,dir:o,onOpenChange:l,modal:i=!0}=e,d=rI(n),[c,u]=r.useState(null),m=r.useRef(!1),f=(0,eo.useCallbackRef)(l),p=eM(o);return r.useEffect(()=>{let e=()=>{m.current=!0,document.addEventListener("pointerdown",t,{capture:!0,once:!0}),document.addEventListener("pointermove",t,{capture:!0,once:!0})},t=()=>m.current=!1;return document.addEventListener("keydown",e,{capture:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0}),document.removeEventListener("pointerdown",t,{capture:!0}),document.removeEventListener("pointermove",t,{capture:!0})}},[]),(0,t.jsx)(tJ,{...d,children:(0,t.jsx)(rP,{scope:n,open:a,onOpenChange:f,content:c,onContentChange:u,children:(0,t.jsx)(rL,{scope:n,onClose:r.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:m,dir:p,modal:i,children:s})})})};r$.displayName=rS;var r_=r.forwardRef((e,r)=>{let{__scopeMenu:n,...a}=e,s=rI(n);return(0,t.jsx)(t0,{...s,...a,ref:r})});r_.displayName="MenuAnchor";var rH="MenuPortal",[rz,rV]=rD(rH,{forceMount:void 0}),rq=e=>{let{__scopeMenu:r,forceMount:n,children:a,container:s}=e,o=rO(rH,r);return(0,t.jsx)(rz,{scope:r,forceMount:n,children:(0,t.jsx)(rr.Presence,{present:n||o.open,children:(0,t.jsx)(rt.Portal,{asChild:!0,container:s,children:a})})})};rq.displayName=rH;var rK="MenuContent",[rW,rU]=rD(rK),rB=r.forwardRef((e,r)=>{let n=rV(rK,e.__scopeMenu),{forceMount:a=n.forceMount,...s}=e,o=rO(rK,e.__scopeMenu),l=rF(rK,e.__scopeMenu);return(0,t.jsx)(rM.Provider,{scope:e.__scopeMenu,children:(0,t.jsx)(rr.Presence,{present:a||o.open,children:(0,t.jsx)(rM.Slot,{scope:e.__scopeMenu,children:l.modal?(0,t.jsx)(rY,{...s,ref:r}):(0,t.jsx)(rG,{...s,ref:r})})})})}),rY=r.forwardRef((e,n)=>{let a=rO(rK,e.__scopeMenu),s=r.useRef(null),o=(0,ej.useComposedRefs)(n,s);return r.useEffect(()=>{let e=s.current;if(e)return(0,ry.hideOthers)(e)},[]),(0,t.jsx)(rX,{...e,ref:o,trapFocus:a.open,disableOutsidePointerEvents:a.open,disableOutsideScroll:!0,onFocusOutside:(0,ew.composeEventHandlers)(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>a.onOpenChange(!1)})}),rG=r.forwardRef((e,r)=>{let n=rO(rK,e.__scopeMenu);return(0,t.jsx)(rX,{...e,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),rX=r.forwardRef((e,n)=>{let{__scopeMenu:a,loop:s=!1,trapFocus:o,onOpenAutoFocus:l,onCloseAutoFocus:i,disableOutsidePointerEvents:d,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:m,onFocusOutside:f,onInteractOutside:p,onDismiss:x,disableOutsideScroll:h,...g}=e,b=rO(rK,a),y=rF(rK,a),v=rI(a),w=rA(a),j=rE(a),[N,k]=r.useState(null),C=r.useRef(null),S=(0,ej.useComposedRefs)(n,C,b.onContentChange),M=r.useRef(0),E=r.useRef(""),R=r.useRef(0),D=r.useRef(null),T=r.useRef("right"),I=r.useRef(0),A=h?rv.RemoveScroll:r.Fragment,P=h?{as:ek.Slot,allowPinchZoom:!0}:void 0;r.useEffect(()=>()=>window.clearTimeout(M.current),[]),(0,eR.useFocusGuards)();let O=r.useCallback(e=>{var t,r;return T.current===D.current?.side&&(t=e,!!(r=D.current?.area)&&function(e,t){let{x:r,y:n}=e,a=!1;for(let e=0,s=t.length-1;e<t.length;s=e++){let o=t[e].x,l=t[e].y,i=t[s].x,d=t[s].y;l>n!=d>n&&r<(i-o)*(n-l)/(d-l)+o&&(a=!a)}return a}({x:t.clientX,y:t.clientY},r))},[]);return(0,t.jsx)(rW,{scope:a,searchRef:E,onItemEnter:r.useCallback(e=>{O(e)&&e.preventDefault()},[O]),onItemLeave:r.useCallback(e=>{O(e)||(C.current?.focus(),k(null))},[O]),onTriggerLeave:r.useCallback(e=>{O(e)&&e.preventDefault()},[O]),pointerGraceTimerRef:R,onPointerGraceIntentChange:r.useCallback(e=>{D.current=e},[]),children:(0,t.jsx)(A,{...P,children:(0,t.jsx)(eD.FocusScope,{asChild:!0,trapped:o,onMountAutoFocus:(0,ew.composeEventHandlers)(l,e=>{e.preventDefault(),C.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:(0,t.jsx)(eE.DismissableLayer,{asChild:!0,disableOutsidePointerEvents:d,onEscapeKeyDown:u,onPointerDownOutside:m,onFocusOutside:f,onInteractOutside:p,onDismiss:x,children:(0,t.jsx)(rf,{asChild:!0,...w,dir:y.dir,orientation:"vertical",loop:s,currentTabStopId:N,onCurrentTabStopIdChange:k,onEntryFocus:(0,ew.composeEventHandlers)(c,e=>{y.isUsingKeyboardRef.current||e.preventDefault()}),preventScrollOnEntryFocus:!0,children:(0,t.jsx)(t4,{role:"menu","aria-orientation":"vertical","data-state":nm(b.open),"data-radix-menu-content":"",dir:y.dir,...v,...g,ref:S,style:{outline:"none",...g.style},onKeyDown:(0,ew.composeEventHandlers)(g.onKeyDown,e=>{let t=e.target.closest("[data-radix-menu-content]")===e.currentTarget,r=e.ctrlKey||e.altKey||e.metaKey,n=1===e.key.length;if(t){var a;let t,s,o,l,i,d;"Tab"===e.key&&e.preventDefault(),!r&&n&&(a=e.key,t=E.current+a,s=j().filter(e=>!e.disabled),o=document.activeElement,l=s.find(e=>e.ref.current===o)?.textValue,i=function(e,t,r){var n;let a=t.length>1&&Array.from(t).every(e=>e===t[0])?t[0]:t,s=r?e.indexOf(r):-1,o=(n=Math.max(s,0),e.map((t,r)=>e[(n+r)%e.length]));1===a.length&&(o=o.filter(e=>e!==r));let l=o.find(e=>e.toLowerCase().startsWith(a.toLowerCase()));return l!==r?l:void 0}(s.map(e=>e.textValue),t,l),d=s.find(e=>e.textValue===i)?.ref.current,function e(t){E.current=t,window.clearTimeout(M.current),""!==t&&(M.current=window.setTimeout(()=>e(""),1e3))}(t),d&&setTimeout(()=>d.focus()))}let s=C.current;if(e.target!==s||!rN.includes(e.key))return;e.preventDefault();let o=j().filter(e=>!e.disabled).map(e=>e.ref.current);rj.includes(e.key)&&o.reverse(),function(e){let t=document.activeElement;for(let r of e)if(r===t||(r.focus(),document.activeElement!==t))return}(o)}),onBlur:(0,ew.composeEventHandlers)(e.onBlur,e=>{e.currentTarget.contains(e.target)||(window.clearTimeout(M.current),E.current="")}),onPointerMove:(0,ew.composeEventHandlers)(e.onPointerMove,nx(e=>{let t=e.target,r=I.current!==e.clientX;e.currentTarget.contains(t)&&r&&(T.current=e.clientX>I.current?"right":"left",I.current=e.clientX)}))})})})})})})});rB.displayName=rK;var rZ=r.forwardRef((e,r)=>{let{__scopeMenu:n,...a}=e;return(0,t.jsx)(ei.Primitive.div,{role:"group",...a,ref:r})});rZ.displayName="MenuGroup";var rJ=r.forwardRef((e,r)=>{let{__scopeMenu:n,...a}=e;return(0,t.jsx)(ei.Primitive.div,{...a,ref:r})});rJ.displayName="MenuLabel";var rQ="MenuItem",r0="menu.itemSelect",r1=r.forwardRef((e,n)=>{let{disabled:a=!1,onSelect:s,...o}=e,l=r.useRef(null),i=rF(rQ,e.__scopeMenu),d=rU(rQ,e.__scopeMenu),c=(0,ej.useComposedRefs)(n,l),u=r.useRef(!1);return(0,t.jsx)(r2,{...o,ref:c,disabled:a,onClick:(0,ew.composeEventHandlers)(e.onClick,()=>{let e=l.current;if(!a&&e){let t=new CustomEvent(r0,{bubbles:!0,cancelable:!0});e.addEventListener(r0,e=>s?.(e),{once:!0}),(0,ei.dispatchDiscreteCustomEvent)(e,t),t.defaultPrevented?u.current=!1:i.onClose()}}),onPointerDown:t=>{e.onPointerDown?.(t),u.current=!0},onPointerUp:(0,ew.composeEventHandlers)(e.onPointerUp,e=>{u.current||e.currentTarget?.click()}),onKeyDown:(0,ew.composeEventHandlers)(e.onKeyDown,e=>{let t=""!==d.searchRef.current;a||t&&" "===e.key||rw.includes(e.key)&&(e.currentTarget.click(),e.preventDefault())})})});r1.displayName=rQ;var r2=r.forwardRef((e,n)=>{let{__scopeMenu:a,disabled:s=!1,textValue:o,...l}=e,i=rU(rQ,a),d=rA(a),c=r.useRef(null),u=(0,ej.useComposedRefs)(n,c),[m,f]=r.useState(!1),[p,x]=r.useState("");return r.useEffect(()=>{let e=c.current;e&&x((e.textContent??"").trim())},[l.children]),(0,t.jsx)(rM.ItemSlot,{scope:a,disabled:s,textValue:o??p,children:(0,t.jsx)(rh,{asChild:!0,...d,focusable:!s,children:(0,t.jsx)(ei.Primitive.div,{role:"menuitem","data-highlighted":m?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...l,ref:u,onPointerMove:(0,ew.composeEventHandlers)(e.onPointerMove,nx(e=>{s?i.onItemLeave(e):(i.onItemEnter(e),e.defaultPrevented||e.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:(0,ew.composeEventHandlers)(e.onPointerLeave,nx(e=>i.onItemLeave(e))),onFocus:(0,ew.composeEventHandlers)(e.onFocus,()=>f(!0)),onBlur:(0,ew.composeEventHandlers)(e.onBlur,()=>f(!1))})})})}),r5=r.forwardRef((e,r)=>{let{checked:n=!1,onCheckedChange:a,...s}=e;return(0,t.jsx)(nt,{scope:e.__scopeMenu,checked:n,children:(0,t.jsx)(r1,{role:"menuitemcheckbox","aria-checked":nf(n)?"mixed":n,...s,ref:r,"data-state":np(n),onSelect:(0,ew.composeEventHandlers)(s.onSelect,()=>a?.(!!nf(n)||!n),{checkForDefaultPrevented:!1})})})});r5.displayName="MenuCheckboxItem";var r4="MenuRadioGroup",[r3,r8]=rD(r4,{value:void 0,onValueChange:()=>{}}),r6=r.forwardRef((e,r)=>{let{value:n,onValueChange:a,...s}=e,o=(0,eo.useCallbackRef)(a);return(0,t.jsx)(r3,{scope:e.__scopeMenu,value:n,onValueChange:o,children:(0,t.jsx)(rZ,{...s,ref:r})})});r6.displayName=r4;var r9="MenuRadioItem",r7=r.forwardRef((e,r)=>{let{value:n,...a}=e,s=r8(r9,e.__scopeMenu),o=n===s.value;return(0,t.jsx)(nt,{scope:e.__scopeMenu,checked:o,children:(0,t.jsx)(r1,{role:"menuitemradio","aria-checked":o,...a,ref:r,"data-state":np(o),onSelect:(0,ew.composeEventHandlers)(a.onSelect,()=>s.onValueChange?.(n),{checkForDefaultPrevented:!1})})})});r7.displayName=r9;var ne="MenuItemIndicator",[nt,nr]=rD(ne,{checked:!1}),nn=r.forwardRef((e,r)=>{let{__scopeMenu:n,forceMount:a,...s}=e,o=nr(ne,n);return(0,t.jsx)(rr.Presence,{present:a||nf(o.checked)||!0===o.checked,children:(0,t.jsx)(ei.Primitive.span,{...s,ref:r,"data-state":np(o.checked)})})});nn.displayName=ne;var na=r.forwardRef((e,r)=>{let{__scopeMenu:n,...a}=e;return(0,t.jsx)(ei.Primitive.div,{role:"separator","aria-orientation":"horizontal",...a,ref:r})});na.displayName="MenuSeparator";var ns=r.forwardRef((e,r)=>{let{__scopeMenu:n,...a}=e,s=rI(n);return(0,t.jsx)(t6,{...s,...a,ref:r})});ns.displayName="MenuArrow";var[no,nl]=rD("MenuSub"),ni="MenuSubTrigger",nd=r.forwardRef((e,n)=>{let a=rO(ni,e.__scopeMenu),s=rF(ni,e.__scopeMenu),o=nl(ni,e.__scopeMenu),l=rU(ni,e.__scopeMenu),i=r.useRef(null),{pointerGraceTimerRef:d,onPointerGraceIntentChange:c}=l,u={__scopeMenu:e.__scopeMenu},m=r.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return r.useEffect(()=>m,[m]),r.useEffect(()=>{let e=d.current;return()=>{window.clearTimeout(e),c(null)}},[d,c]),(0,t.jsx)(r_,{asChild:!0,...u,children:(0,t.jsx)(r2,{id:o.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":o.contentId,"data-state":nm(a.open),...e,ref:(0,ej.composeRefs)(n,o.onTriggerChange),onClick:t=>{e.onClick?.(t),e.disabled||t.defaultPrevented||(t.currentTarget.focus(),a.open||a.onOpenChange(!0))},onPointerMove:(0,ew.composeEventHandlers)(e.onPointerMove,nx(t=>{l.onItemEnter(t),!t.defaultPrevented&&(e.disabled||a.open||i.current||(l.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{a.onOpenChange(!0),m()},100)))})),onPointerLeave:(0,ew.composeEventHandlers)(e.onPointerLeave,nx(e=>{m();let t=a.content?.getBoundingClientRect();if(t){let r=a.content?.dataset.side,n="right"===r,s=t[n?"left":"right"],o=t[n?"right":"left"];l.onPointerGraceIntentChange({area:[{x:e.clientX+(n?-5:5),y:e.clientY},{x:s,y:t.top},{x:o,y:t.top},{x:o,y:t.bottom},{x:s,y:t.bottom}],side:r}),window.clearTimeout(d.current),d.current=window.setTimeout(()=>l.onPointerGraceIntentChange(null),300)}else{if(l.onTriggerLeave(e),e.defaultPrevented)return;l.onPointerGraceIntentChange(null)}})),onKeyDown:(0,ew.composeEventHandlers)(e.onKeyDown,t=>{let r=""!==l.searchRef.current;e.disabled||r&&" "===t.key||rk[s.dir].includes(t.key)&&(a.onOpenChange(!0),a.content?.focus(),t.preventDefault())})})})});nd.displayName=ni;var nc="MenuSubContent",nu=r.forwardRef((e,n)=>{let a=rV(rK,e.__scopeMenu),{forceMount:s=a.forceMount,...o}=e,l=rO(rK,e.__scopeMenu),i=rF(rK,e.__scopeMenu),d=nl(nc,e.__scopeMenu),c=r.useRef(null),u=(0,ej.useComposedRefs)(n,c);return(0,t.jsx)(rM.Provider,{scope:e.__scopeMenu,children:(0,t.jsx)(rr.Presence,{present:s||l.open,children:(0,t.jsx)(rM.Slot,{scope:e.__scopeMenu,children:(0,t.jsx)(rX,{id:d.contentId,"aria-labelledby":d.triggerId,...o,ref:u,align:"start",side:"rtl"===i.dir?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:e=>{i.isUsingKeyboardRef.current&&c.current?.focus(),e.preventDefault()},onCloseAutoFocus:e=>e.preventDefault(),onFocusOutside:(0,ew.composeEventHandlers)(e.onFocusOutside,e=>{e.target!==d.trigger&&l.onOpenChange(!1)}),onEscapeKeyDown:(0,ew.composeEventHandlers)(e.onEscapeKeyDown,e=>{i.onClose(),e.preventDefault()}),onKeyDown:(0,ew.composeEventHandlers)(e.onKeyDown,e=>{let t=e.currentTarget.contains(e.target),r=rC[i.dir].includes(e.key);t&&r&&(l.onOpenChange(!1),d.trigger?.focus(),e.preventDefault())})})})})})});function nm(e){return e?"open":"closed"}function nf(e){return"indeterminate"===e}function np(e){return nf(e)?"indeterminate":e?"checked":"unchecked"}function nx(e){return t=>"mouse"===t.pointerType?e(t):void 0}nu.displayName=nc;var nh="DropdownMenu",[ng,nb]=(0,es.createContextScope)(nh,[rT]),ny=rT(),[nv,nw]=ng(nh),nj=e=>{let{__scopeDropdownMenu:n,children:a,dir:s,open:o,defaultOpen:l,onOpenChange:i,modal:d=!0}=e,c=ny(n),u=r.useRef(null),[m=!1,f]=(0,eN.useControllableState)({prop:o,defaultProp:l,onChange:i});return(0,t.jsx)(nv,{scope:n,triggerId:(0,eT.useId)(),triggerRef:u,contentId:(0,eT.useId)(),open:m,onOpenChange:f,onOpenToggle:r.useCallback(()=>f(e=>!e),[f]),modal:d,children:(0,t.jsx)(r$,{...c,open:m,onOpenChange:f,dir:s,modal:d,children:a})})};nj.displayName=nh;var nN="DropdownMenuTrigger",nk=r.forwardRef((e,r)=>{let{__scopeDropdownMenu:n,disabled:a=!1,...s}=e,o=nw(nN,n),l=ny(n);return(0,t.jsx)(r_,{asChild:!0,...l,children:(0,t.jsx)(ei.Primitive.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":a?"":void 0,disabled:a,...s,ref:(0,ej.composeRefs)(r,o.triggerRef),onPointerDown:(0,ew.composeEventHandlers)(e.onPointerDown,e=>{!a&&0===e.button&&!1===e.ctrlKey&&(o.onOpenToggle(),o.open||e.preventDefault())}),onKeyDown:(0,ew.composeEventHandlers)(e.onKeyDown,e=>{!a&&(["Enter"," "].includes(e.key)&&o.onOpenToggle(),"ArrowDown"===e.key&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(e.key)&&e.preventDefault())})})})});nk.displayName=nN;var nC=e=>{let{__scopeDropdownMenu:r,...n}=e,a=ny(r);return(0,t.jsx)(rq,{...a,...n})};nC.displayName="DropdownMenuPortal";var nS="DropdownMenuContent",nM=r.forwardRef((e,n)=>{let{__scopeDropdownMenu:a,...s}=e,o=nw(nS,a),l=ny(a),i=r.useRef(!1);return(0,t.jsx)(rB,{id:o.contentId,"aria-labelledby":o.triggerId,...l,...s,ref:n,onCloseAutoFocus:(0,ew.composeEventHandlers)(e.onCloseAutoFocus,e=>{i.current||o.triggerRef.current?.focus(),i.current=!1,e.preventDefault()}),onInteractOutside:(0,ew.composeEventHandlers)(e.onInteractOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey,n=2===t.button||r;(!o.modal||n)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});nM.displayName=nS,r.forwardRef((e,r)=>{let{__scopeDropdownMenu:n,...a}=e,s=ny(n);return(0,t.jsx)(rZ,{...s,...a,ref:r})}).displayName="DropdownMenuGroup";var nE=r.forwardRef((e,r)=>{let{__scopeDropdownMenu:n,...a}=e,s=ny(n);return(0,t.jsx)(rJ,{...s,...a,ref:r})});nE.displayName="DropdownMenuLabel";var nR=r.forwardRef((e,r)=>{let{__scopeDropdownMenu:n,...a}=e,s=ny(n);return(0,t.jsx)(r1,{...s,...a,ref:r})});nR.displayName="DropdownMenuItem",r.forwardRef((e,r)=>{let{__scopeDropdownMenu:n,...a}=e,s=ny(n);return(0,t.jsx)(r5,{...s,...a,ref:r})}).displayName="DropdownMenuCheckboxItem",r.forwardRef((e,r)=>{let{__scopeDropdownMenu:n,...a}=e,s=ny(n);return(0,t.jsx)(r6,{...s,...a,ref:r})}).displayName="DropdownMenuRadioGroup",r.forwardRef((e,r)=>{let{__scopeDropdownMenu:n,...a}=e,s=ny(n);return(0,t.jsx)(r7,{...s,...a,ref:r})}).displayName="DropdownMenuRadioItem",r.forwardRef((e,r)=>{let{__scopeDropdownMenu:n,...a}=e,s=ny(n);return(0,t.jsx)(nn,{...s,...a,ref:r})}).displayName="DropdownMenuItemIndicator";var nD=r.forwardRef((e,r)=>{let{__scopeDropdownMenu:n,...a}=e,s=ny(n);return(0,t.jsx)(na,{...s,...a,ref:r})});function nT({...e}){return(0,t.jsx)(nj,{"data-slot":"dropdown-menu",...e})}function nI({...e}){return(0,t.jsx)(nk,{"data-slot":"dropdown-menu-trigger",...e})}function nA({className:e,sideOffset:r=4,...n}){return(0,t.jsx)(nC,{children:(0,t.jsx)(nM,{"data-slot":"dropdown-menu-content",sideOffset:r,className:(0,eb.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...n})})}function nP({className:e,inset:r,variant:n="default",...a}){return(0,t.jsx)(nR,{"data-slot":"dropdown-menu-item","data-inset":r,"data-variant":n,className:(0,eb.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...a})}function nO({className:e,inset:r,...n}){return(0,t.jsx)(nE,{"data-slot":"dropdown-menu-label","data-inset":r,className:(0,eb.cn)("px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",e),...n})}function nL({className:e,...r}){return(0,t.jsx)(nD,{"data-slot":"dropdown-menu-separator",className:(0,eb.cn)("bg-border -mx-1 my-1 h-px",e),...r})}function nF({view:e,selectedDate:r,onViewChange:a,onLogout:s}){let o=(0,n.useRouter)(),{user:l,isAuthenticated:i}=(0,Q.useAuth)();return(0,t.jsx)("header",{className:"sticky top-0 z-30 border-b border-border/40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/80",children:(0,t.jsxs)("div",{className:"px-4 py-4 flex items-center justify-between gap-3",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("h1",{className:"text-lg font-bold tracking-tight text-foreground leading-tight",children:["day"===e&&r.toLocaleDateString("zh-CN",{month:"long",day:"numeric"}),"week"===e&&"æœ¬å‘¨","month"===e&&r.toLocaleDateString("zh-CN",{year:"numeric",month:"long"})]}),"day"===e&&(0,t.jsx)("span",{className:"text-base",children:"â˜€ï¸"})]}),"day"===e&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-0.5 font-handwriting",children:r.toLocaleDateString("zh-CN",{weekday:"long"})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[i?(0,t.jsxs)(nT,{children:[(0,t.jsx)(nI,{asChild:!0,children:(0,t.jsx)("button",{className:"flex items-center gap-2 rounded-full focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",children:(0,t.jsx)(ey,{className:"h-8 w-8",children:(0,t.jsx)(ev,{className:"bg-primary/10 text-primary text-sm",children:l?.username?.charAt(0).toUpperCase()||"U"})})})}),(0,t.jsxs)(nA,{align:"end",className:"w-48",children:[(0,t.jsx)(nO,{children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-medium",children:l?.username}),l?.email&&(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:l.email})]})}),(0,t.jsx)(nL,{}),(0,t.jsxs)(nP,{onClick:()=>o.push("/profile"),children:[(0,t.jsx)(en.User,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"ä¸ªäººä¿¡æ¯"})]}),(0,t.jsx)(nL,{}),(0,t.jsxs)(nP,{onClick:s,variant:"destructive",children:[(0,t.jsx)(ea,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"ç™»å‡º"})]})]})]}):(0,t.jsx)("button",{onClick:()=>o.push("/login"),className:"text-sm text-muted-foreground hover:text-foreground px-3 py-1.5 rounded-md hover:bg-muted/50 transition-colors",children:"ç™»å½•"}),(0,t.jsxs)("div",{className:"flex gap-1 bg-muted/40 rounded-lg p-1",children:[(0,t.jsx)("button",{onClick:()=>a("day"),className:`flex items-center justify-center px-3 py-2 rounded-md text-xs font-medium transition-all active:scale-95 ${"day"===e?"bg-background text-foreground shadow-sm":"text-muted-foreground"}`,children:(0,t.jsx)(ee,{className:"h-4 w-4"})}),(0,t.jsx)("button",{onClick:()=>a("week"),className:`flex items-center justify-center px-3 py-2 rounded-md text-xs font-medium transition-all active:scale-95 ${"week"===e?"bg-background text-foreground shadow-sm":"text-muted-foreground"}`,children:(0,t.jsx)(et,{className:"h-4 w-4"})}),(0,t.jsx)("button",{onClick:()=>a("month"),className:`flex items-center justify-center px-3 py-2 rounded-md text-xs font-medium transition-all active:scale-95 ${"month"===e?"bg-background text-foreground shadow-sm":"text-muted-foreground"}`,children:(0,t.jsx)(er,{className:"h-4 w-4"})})]})]})]})})}nD.displayName="DropdownMenuSeparator",r.forwardRef((e,r)=>{let{__scopeDropdownMenu:n,...a}=e,s=ny(n);return(0,t.jsx)(ns,{...s,...a,ref:r})}).displayName="DropdownMenuArrow",r.forwardRef((e,r)=>{let{__scopeDropdownMenu:n,...a}=e,s=ny(n);return(0,t.jsx)(nd,{...s,...a,ref:r})}).displayName="DropdownMenuSubTrigger",r.forwardRef((e,r)=>{let{__scopeDropdownMenu:n,...a}=e,s=ny(n);return(0,t.jsx)(nu,{...s,...a,ref:r,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})}).displayName="DropdownMenuSubContent",(0,a.default)("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);let n$=(0,a.default)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);function n_({onAddTask:e,onShowStatistics:r,onShowAIChat:n}){return(0,t.jsxs)("div",{className:"fixed bottom-6 right-6 z-20 flex flex-col gap-3",children:[(0,t.jsx)("button",{onClick:r,className:"w-12 h-12 rounded-full bg-gradient-to-br from-amber-500 to-orange-500 text-white shadow-lg flex items-center justify-center active:scale-95 transition-transform hover:shadow-xl",children:(0,t.jsx)(n$,{className:"h-5 w-5"})}),(0,t.jsx)("button",{onClick:n,className:"w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 text-white shadow-lg flex items-center justify-center active:scale-95 transition-transform hover:shadow-xl",children:(0,t.jsx)(Z,{className:"h-5 w-5"})}),(0,t.jsx)("button",{onClick:e,className:"w-14 h-14 rounded-full bg-foreground text-background shadow-lg flex items-center justify-center active:scale-95 transition-transform hover:shadow-xl",children:(0,t.jsx)(w,{className:"h-6 w-6"})})]})}function nH(e){let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`}function nz(){let{logout:e}=(0,Q.useAuth)(),a=(0,n.useSearchParams)(),[s,l]=(0,r.useState)("day"),d=(0,r.useMemo)(()=>{let e=a.get("date");if(e){let t=new Date(e);if(!isNaN(t.getTime()))return t}return new Date},[a]),[c,u]=(0,r.useState)(d);(0,r.useEffect)(()=>{let e=a.get("date");if(e){let t=new Date(e);isNaN(t.getTime())||u(t)}},[a]);let[m,p]=(0,r.useState)(null),[x,h]=(0,r.useState)(!1),[b,y]=(0,r.useState)(!1),[v,w]=(0,r.useState)(!1),[j,N]=(0,r.useState)(!1),[k,S]=(0,r.useState)(!1),[M,I]=(0,r.useState)(!1),[A,P]=(0,r.useState)(0),{templates:O,refresh:L}=z(),{categories:F,createCategory:$,deleteCategory:_,refresh:q}=function(){let[e,t]=(0,r.useState)([]),[n,a]=(0,r.useState)(!1),[s,o]=(0,r.useState)(null),l=(0,r.useCallback)(async()=>{a(!0),o(null);try{let e=(await E.apiClient.getTypes()).data.map(T);t(e)}catch(t){let e=t instanceof Error?t:Error("åŠ è½½åˆ†ç±»å¤±è´¥");o(e),H({title:"åŠ è½½å¤±è´¥",description:e.message,variant:"destructive"})}finally{a(!1)}},[]);(0,r.useEffect)(()=>{l()},[l]);let i=(0,r.useCallback)(async e=>{try{let r=await E.apiClient.createType({typeName:e.name,icon:e.icon,color:e.color}),n=T(r.data);return t(e=>[...e,n]),H({title:"åˆ›å»ºæˆåŠŸ",description:`åˆ†ç±»ã€Œ${n.name}ã€å·²åˆ›å»º`}),n}catch(t){let e=t instanceof Error?t:Error("åˆ›å»ºåˆ†ç±»å¤±è´¥");throw H({title:"åˆ›å»ºå¤±è´¥",description:e.message,variant:"destructive"}),e}},[]);return{categories:e,loading:n,error:s,createCategory:i,updateCategory:(0,r.useCallback)(async(e,r)=>{try{let n=await E.apiClient.updateType(e,{typeName:r.name||"",icon:r.icon||"",color:r.color}),a=T(n.data);return t(t=>t.map(t=>t.id===e?a:t)),H({title:"æ›´æ–°æˆåŠŸ",description:`åˆ†ç±»ã€Œ${a.name}ã€å·²æ›´æ–°`}),a}catch(t){let e=t instanceof Error?t:Error("æ›´æ–°åˆ†ç±»å¤±è´¥");throw H({title:"æ›´æ–°å¤±è´¥",description:e.message,variant:"destructive"}),e}},[]),deleteCategory:(0,r.useCallback)(async e=>{try{await E.apiClient.deleteType(e),t(t=>t.filter(t=>t.id!==e)),H({title:"åˆ é™¤æˆåŠŸ",description:"åˆ†ç±»å·²åˆ é™¤"})}catch(t){let e=t instanceof Error?t:Error("åˆ é™¤åˆ†ç±»å¤±è´¥");throw H({title:"åˆ é™¤å¤±è´¥",description:e.message,variant:"destructive"}),e}},[]),refresh:l}}(),W=function(e,t,n={}){let{autoLoad:a=!0}=n,[s,o]=(0,r.useState)({}),[l,i]=(0,r.useState)(!1),[d,c]=(0,r.useState)(null),u=(0,r.useCallback)(async()=>{i(!0),c(null);try{if("day"===e){let e=nH(t),r=(await E.apiClient.getDayView(e)).data.map(R);o({tasks:r})}else if("week"===e){let e=t.getDay(),r=new Date(t);r.setDate(t.getDate()-(0===e?6:e-1));let n=nH(r),a=(await E.apiClient.getWeekView(n)).data.map(R);o({tasks:a})}else if("month"===e){let e=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`,r=await E.apiClient.getMonthView(e);o({monthData:r.data})}}catch(t){let e=t instanceof Error?t:Error("åŠ è½½æ—¥å†æ•°æ®å¤±è´¥");c(e),H({title:"åŠ è½½å¤±è´¥",description:e.message,variant:"destructive"})}finally{i(!1)}},[e,t]);return(0,r.useEffect)(()=>{a&&u()},[a,u]),{data:s,loading:l,error:d,refresh:u}}(s,c),{createTodo:U,completeTodo:B}=function(e={}){let{autoLoad:t=!1,startDate:n,endDate:a,status:s}=e,[o,l]=(0,r.useState)([]),[i,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(null),m=(0,r.useCallback)(async()=>{d(!0),u(null);try{let e=(await E.apiClient.getTodos({startDate:n,endDate:a,status:s})).data.map(R);l(e)}catch(t){let e=t instanceof Error?t:Error("åŠ è½½ä»»åŠ¡å¤±è´¥");u(e),H({title:"åŠ è½½å¤±è´¥",description:e.message,variant:"destructive"})}finally{d(!1)}},[n,a,s]);(0,r.useEffect)(()=>{t&&m()},[t,m]);let f=(0,r.useCallback)(async e=>{try{let t=D(e),r=await E.apiClient.createTodo(t),n=R(r.data);return l(e=>[...e,n]),H({title:"åˆ›å»ºæˆåŠŸ",description:`ä»»åŠ¡ã€Œ${n.title}ã€å·²åˆ›å»º`}),n}catch(t){let e=t instanceof Error?t:Error("åˆ›å»ºä»»åŠ¡å¤±è´¥");throw H({title:"åˆ›å»ºå¤±è´¥",description:e.message,variant:"destructive"}),e}},[]),p=(0,r.useCallback)(async(e,t)=>{try{let r=D(t),n=await E.apiClient.updateTodo(e,r),a=R(n.data);return l(t=>t.map(t=>t.id===e?a:t)),H({title:"æ›´æ–°æˆåŠŸ",description:`ä»»åŠ¡ã€Œ${a.title}ã€å·²æ›´æ–°`}),a}catch(t){let e=t instanceof Error?t:Error("æ›´æ–°ä»»åŠ¡å¤±è´¥");throw H({title:"æ›´æ–°å¤±è´¥",description:e.message,variant:"destructive"}),e}},[]);return{todos:o,loading:i,error:c,createTodo:f,updateTodo:p,deleteTodo:(0,r.useCallback)(async e=>{try{await E.apiClient.deleteTodo(e),l(t=>t.filter(t=>t.id!==e)),H({title:"åˆ é™¤æˆåŠŸ",description:"ä»»åŠ¡å·²åˆ é™¤"})}catch(t){let e=t instanceof Error?t:Error("åˆ é™¤ä»»åŠ¡å¤±è´¥");throw H({title:"åˆ é™¤å¤±è´¥",description:e.message,variant:"destructive"}),e}},[]),completeTodo:(0,r.useCallback)(async e=>{try{let t=await E.apiClient.completeTodo(e),r=R(t.data);return l(t=>t.map(t=>t.id===e?r:t)),H({title:"å®Œæˆ",description:`ä»»åŠ¡ã€Œ${r.title}ã€å·²å®Œæˆ`}),r}catch(t){let e=t instanceof Error?t:Error("æ ‡è®°å®Œæˆå¤±è´¥");throw H({title:"æ“ä½œå¤±è´¥",description:e.message,variant:"destructive"}),e}},[]),refresh:m}}({autoLoad:!1}),Y=(0,r.useMemo)(()=>("day"===s||"week"===s)&&W.data.tasks||[],[s,W.data]),X=async()=>{await e()},Z=e=>{p(e),h(!0)},ee=async e=>{try{let t=Y.find(t=>t.id===e);if(t&&!t.completed){await B(e);let t=A+1;P(t),3===t&&setTimeout(()=>{let e=new CustomEvent("show-toast",{detail:{message:"ä¸‰è¿å®Œæˆï¼æ•ˆç‡æ»¡åˆ†ï¼",type:"achievement"}});window.dispatchEvent(e),P(0)},500)}else P(0);W.refresh(),h(!1)}catch(e){console.error("å®Œæˆä»»åŠ¡å¤±è´¥:",e)}},et=async e=>{try{await U(e),W.refresh(),y(!1)}catch(e){console.error("æ·»åŠ ä»»åŠ¡å¤±è´¥:",e)}};return(0,r.useEffect)(()=>{W.refresh()},[s,c]),(0,r.useEffect)(()=>{b&&(q(),L())},[b,q,L]),(0,t.jsxs)("div",{className:"min-h-screen bg-background pb-safe",children:[(0,t.jsx)(nF,{view:s,selectedDate:c,onViewChange:l,onLogout:X}),(0,t.jsx)("main",{className:"px-4 py-5",children:W.loading?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)("div",{className:"text-muted-foreground",children:"åŠ è½½ä¸­..."})}):(0,t.jsxs)(t.Fragment,{children:["day"===s&&(0,t.jsx)(o,{tasks:Y,selectedDate:c,onTaskClick:Z}),"week"===s&&(0,t.jsx)(i,{tasks:Y,selectedDate:c,onTaskClick:Z}),"month"===s&&(0,t.jsx)(f,{tasks:Y,monthData:W.data.monthData,selectedDate:c,onDateClick:e=>{u(e),l("day")},onMonthChange:e=>{u(e)},categories:F})]})}),(0,t.jsx)(n_,{onAddTask:()=>y(!0),onShowStatistics:()=>S(!0),onShowAIChat:()=>I(!0)}),(0,t.jsx)(g,{task:m,open:x,onOpenChange:h,onComplete:ee}),(0,t.jsx)(C,{open:b,onOpenChange:y,onAdd:et,selectedDate:c,currentView:s,templates:O,categories:F,onManageTemplates:()=>{y(!1),w(!0)},onManageCategories:()=>{y(!1),N(!0)}}),(0,t.jsx)(V,{open:v,onOpenChange:w,templates:O,categories:F,onSave:L}),(0,t.jsx)(K,{open:j,onOpenChange:N,categories:F,onCreateCategory:$,onDeleteCategory:_,onSave:q}),(0,t.jsx)(G,{open:k,onOpenChange:S}),(0,t.jsx)(J,{open:M,onOpenChange:I})]})}function nV(){return(0,t.jsx)(r.Suspense,{fallback:(0,t.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-muted-foreground",children:"åŠ è½½ä¸­..."})}),children:(0,t.jsx)(nz,{})})}e.s(["default",()=>nV],60207)}]);